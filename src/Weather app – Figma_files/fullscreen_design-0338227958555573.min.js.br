
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="6ef19c49-20b3-5918-bd85-deea7910e8f1")}catch(e){}}();
(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[1085],{847855:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});var a=n(198868);async function r(e){let t=(0,a.D)(),n=new Map,r=RegExp("url\\(['\"]?(.+?)['\"]?\\)","g");for(let a of e.matchAll(r)){let e;let r=a[1];if(!r)continue;try{e=new URL(r)}catch(e){continue}let o=new URLSearchParams(e.hash.slice(1)).get("filename");if(!o||!o.endsWith(".png"))continue;let l=o.slice(0,-4),i=t.getImageByHash(l);if(!i)continue;let s=await i.getBytesAsync();if(!s)continue;let c=new Blob([s],{type:"image/png"}),d=await function(e){return new Promise((t,n)=>{let a=new FileReader;a.onloadend=()=>{let e=a.result;if("string"==typeof e){t(e);return}n(Error("Failed to convert blob to base64"))},a.onerror=n,a.readAsDataURL(e)})}(c);n.set(a.index,d)}return e.replace(r,(e,t,a)=>e.replace(t,n.get(a)??t))??e}},444576:(e,t,n)=>{"use strict";n.d(t,{A7:()=>i,i4:()=>l,nt:()=>o});var a=n(302245),r=n(333370);let o=e=>e.library.localStyleSelection,l=(0,a.Mz)([o,(e,t)=>t],(e,t)=>e?.type===t?e:null),i=(0,a.Mz)([l,(e,t,n)=>n],(e,t)=>{if(!e)return null;let n=new Set,a=new Set;return e.folderNames.forEach(e=>{let o=t.find(t=>"STYLE_FOLDER"===t.type&&t.name===e);o&&((0,r.KU)(o).forEach(e=>{n.add(e.name)}),(0,r.dm)(o).forEach(e=>{a.add(e.node_id)}))}),{type:e.type,folderNames:n,styleIds:a}})},636050:(e,t,n)=>{"use strict";let a;n.r(t),n.d(t,{DesignView:()=>gN});var r=n(411855),o=n(188507),l=n(786013),i=n(922827),s=n(966712),c=n(192437),d=n(939863),p=n(392592),m=n(475708),u=n(818194),E=n(686046),g=n(862350),y=n(951792),_=n(288006),h=n(222903),f=n(181912),v=n(418956),b=n(915440),S=n(860601),T=n(154254),N=n(393812),I=n(461837),P=n(256975),C=n(891869),k=n(380308),A=n(21584),w=n(88918),O=n(750293),x=n(349410),R=n(101505),M=n(672517),L=n(251960),D=n(456104),K=n(683694),F=n(723239),V=n(29680),U=n(335682),B=n(161325),G=n(279453),z=n(601607),H=n(397065),W=n(147829),Y=n(699857),$=n(463546),X=n(618247);let j=(0,M.tf)(E.N);function Q(){let e=(0,x.Ps)(),t=(0,x.o9)(),n=(0,U.tS)(),a=(0,N.BI)(),o=function(){let e;let t=(0,z.hr)(e=>e).getRoot(),n=t=>{for(let a of t.childrenNodes)(a.isTopLevelFrame()||"CANVAS"===a.type)&&(a.hasReadyStatus?e?e.getStatusInfo().lastUpdateUnixTimestamp<a.getStatusInfo().lastUpdateUnixTimestamp&&(e=a):e=a:("SECTION"===a.type||"CANVAS"===a.type)&&n(a))};return n(t),e?.getStatusInfo()}(),l=(0,B.wW)(o?.userId??null),i=!!o&&f.A.unix(o.lastUpdateUnixTimestamp).isAfter((0,f.A)().subtract(60,"day")),c=(0,Y.U)("upsell"),p=b.Rs(G.HdA,{key:n??""},{enabled:!!n})?.data?.file?.hasPermission,m=(0,v.md)(K.LZ),E=(0,V.aV)(),Q=(0,P._I)(),J=(0,P.U4)(),q=(0,v.md)(F.NT),Z=(0,A.J)(),{show:ee,complete:et,isShowing:en,uniqueId:ea}=(0,D.e)({overlay:$.koo,priority:H.N.OVERRIDING_MODAL,experiment:{check:e,predicate:e=>e,postCheck:()=>!0}},[q]);(0,r.useEffect)(()=>{ee({canShow:n=>Z&&m&&!Q&&"loaded"===a.status&&!a.hasPendingRequest&&i&&J&&!E&&("developer"===n||"software-development"===n||e()&&t(n))})},[ee,Q,J,m,E,q,Z,a,i,t,e]),(0,L.E)(ea,"Enter Inspect Mode",()=>{en&&et()});let er=(0,w.BC)({dismissModal:et,onRequestAccess:()=>{p&&c("handoff")}}),eo=r.useCallback(()=>{et(),er.hidden||er.onClick(O.i$.Upsell)},[et,er]),el=r.createElement(j,{newTab:!0,trusted:!0,trackingProperties:{trackingDescriptor:R.c.READ_THE_GUIDE},href:u.z},(0,d.tx)("dev_mode.onboarding_callout.read_the_guide")),ei=r.createElement(r.Fragment,null,r.createElement("span",{className:X.XQ},r.createElement(h.O,null)),r.createElement("span",{className:T.cx.textBodyMediumStrong.$},(0,d.tx)("dev_handoff.status.mark_status_sentence_part.ready_for_dev"))),es=r.createElement(r.Fragment,null,r.createElement("div",{className:X.DD},(0,d.tx)("dev_handoff.paywall.blocking_modal.title.dev_onboarding")),r.createElement("ul",null,r.createElement("li",{className:X.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.copy_code")),r.createElement("li",{className:X.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.track_design_changes")),r.createElement("li",{className:X.N$},(0,d.tx)("dev_handoff.paywall.blocking_modal.content.customize_plugins"))),r.createElement("div",{className:X.jg},p?(0,d.tx)("dev_handoff.paywall.blocking_modal.content.explore_for_free_with_link",{learnMoreLink:el}):(0,d.tx)("dev_handoff.paywall.blocking_modal.content.curious_to_learn_more",{learnMoreLink:el}))),ec=(0,C.W)(),ed=g.hS({open:!0,onClose:S.lQ,preventUserClose:!0,recordingKey:"dev-mode-paywall-modal"});return r.createElement(W.M,{testId:"rfd-upsell-upsell",isShowing:en},r.createElement("div",{"data-editor-theme":"dev-handoff"},r.createElement(I.OM,null),r.createElement(M.fu,{name:"RFD Upsell Modal",properties:ec,enabled:ec?.gracePeriod!==void 0},r.createElement(y.bL,{width:392,manager:ed},r.createElement(_.Wk,null,r.createElement("div",{className:X.XV},l.loading?"":(0,d.tx)("dev_handoff.upsell.user_marked_a design",{userName:l.user?.name||l.user?.handle,status:ei})),r.createElement("div",{className:T.cx.py8.px16.$},r.createElement(k.E,{imgSrc:(0,s.ck)("6d5e9cb0e9ec7fd5dd58425c5527dc8a78143a19"),content:es,modalType:"RFD Upsell Modal",primaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.request_access"),primaryButtonType:"request_access",primaryButtonOnClick:er.hidden?void 0:eo,secondaryButtonLabel:(0,d.tx)("dev_handoff.paywall.blocking_modal.button.not_now"),secondaryButtonType:"not_now",secondaryButtonOnClick:et})))))))}var J=n(964881),q=n(632430),Z=n(285381),ee=n(843495),et=n(441088),en=n(737499),ea=n(698993),er=n(170960),eo=n(100197),el=n(338400),ei=n(713318),es=n(219101),ec=n(6532),ed=n(402609),ep=n(720750),em=n(931828),eu=n(226055),eE=n(129318),eg=n(582947),ey=n(106757),e_=n(860178),eh=n(309798),ef=n(820642),ev=n(788256),eb=n(601538),eS=n(343887),eT=n(139689),eN=n(629019),eI=n.n(eN),eP=n(776250),eC=n(320063),ek=n(659302),eA=n(752553),ew=n(864089),eO=n(135876),ex=n(47506),eR=n(340159),eM=n(777078),eL=n(373119),eD=n(106112),eK=n(187882),eF=n(545317),eV=n(239177),eU=n(666456);let eB="starting_points_templates_modal--templateOption--qYXkm",eG="starting_points_templates_modal--templateOptionTitle--DmVPR",ez="starting_points_templates_modal--verticalTemplateImage--kAzQz";var eH=(e=>(e.DESKTOP="desktop",e.MOBILE="mobile",e.WEBSITE="website",e))(eH||{});let eW={x:0,y:0},eY={website:{x:0,y:1600},mobile:{x:0,y:300},desktop:{x:0,y:300}},e$={website:.1,mobile:.225,desktop:.1},eX=e=>{let t=(0,s.Ay)().starting_points;switch(e){case"basics":return t?.figma_basics_hub_file_id;case"desktop":return t?.desktop_templates_hub_file_id;case"mobile":return t?.mobile_templates_hub_file_id;case"website":return t?.website_templates_hub_file_id}};function ej({onClose:e}){let t=(0,o.wA)(),n=r.useRef(null),[a,l]=r.useState(!1),[c,p]=r.useState(!1),[m,u]=r.useState(!1),[E,g]=r.useState(!1),[y,_]=r.useState(window.innerWidth),h=(0,eL.q)(),f=(0,U.tS)(),b=(0,o.d4)(e=>e.fileVersion),S=(0,o.d4)(e=>e.mirror.sceneGraph),T=h&&(0,ev.Qf)(S),N=!!T&&0===T.childrenGuids.length,[I]=(0,eA.IT)((0,eR.tH)({})),P=!!(0,s.kc)().starting_points_ghost_previews,{insertTemplate:C}=(0,eM.Fz)(),k=(0,eV.g)(),A=(0,ek.Xr)(eU.Yq),w=(0,ek.Xr)(eU.bj),[O,x]=r.useState(!1),L=(0,eK.GQ)(),D=(0,eF.P)();(0,eC.h)(()=>{let e=()=>{_(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),r.useEffect(()=>{g(L+50>y/2-257||y-D-50<y/2+257),u(L+50>y/2-365||y-D-50<y/2+365)},[L,D,y]);let K=r.useCallback(()=>{if(!P||"loaded"!==I.status||!I.data)return;let e=[];for(let t of Object.values(eH)){let n=eX(t);if(!n)return;let a=I.data[n];if(!a)return;let r={type:eD.n.HubFile,template:a};e.push(r)}Promise.all(e.map(e=>v.zl.get((0,eU.Re)({fileKey:f,fileVersion:b,template:e})))).then(()=>{x(!0)}).catch(e=>{console.error("Failed to load template buffers",e),x(!0)})},[f,b,I,P]);if(r.useEffect(()=>{"loaded"!==I.status||O||K()},[I,O,K]),r.useEffect(()=>{h&&T&&!N&&!c&&e()},[h,T,N,c,e]),!(0,s.kc)().starting_points_modal)return null;let F=async n=>{if("loaded"!==I.status)return;l(!0);let a=eX(n);if(!a)return;let r=I.data[a];r&&(P&&"basics"!==n?await (0,eM.Zg)({insert:()=>w({selectTemplateAfterCommit:!1,moveViewportAfterCommit:!1,priority:"user-visible",editScopeType:i.zkO.USER}),template:{template:r,type:eD.n.HubFile},fileKey:f,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1}):await C({template:{template:r,type:eD.n.HubFile},userTriggered:!1,editScopeType:i.zkO.ONBOARDING,triggeredFrom:"starting-points",templateInsertionDirection:i.hKj.RIGHT}),"basics"===n?(0,ex.YQ)({id:"starting_points_basics_template_inserted"}):(0,ex.YQ)({id:"starting_points_template_inserted"}),e(),l(!1))},V=r.createElement(M.$z,{onClick:()=>F("basics"),trackingProperties:{trackingDescriptor:R.c.LEARN_THE_BASICS}},(0,d.tx)("starting_points.learn_the_basics")),B=e=>{if((0,eP.sx)("Starting Points Template Option Hover",{template:e}),!P)return;let n=eX(e);if(!n||!I.data)return;let a=I.data[n];if(!a)return;let r={type:eD.n.HubFile,template:a},o=e$[e];window.innerWidth>1700&&(o*=1.5),(0,eM.Zg)({insert:()=>k(r,{moveViewportAfterPreview:!0,priority:"user-visible",previewManager:{nodeType:i.Z6A.CANVAS},position:eW,viewportOptions:{position:eY[e],scale:o,duration:0}}),template:r,fileKey:f,dispatch:t,triggeredFrom:"starting-points",userTriggered:!1,isPreview:!0})},G=()=>{P&&A()};return r.createElement(M.fu,{name:"Starting Points Modal"},r.createElement("div",{className:"starting_points_templates_modal--startingPointsTemplatesModalPositioner--R8g3u"},r.createElement(eO.x,{isLoading:a,className:"starting_points_templates_modal--loadingSpinner--UOrjg"},()=>r.createElement("div",{className:eI()({"starting_points_templates_modal--startingPointsTemplatesModal--dUQte":!0,"starting_points_templates_modal--isHidden--jVN1L":E,"starting_points_templates_modal--isCondensedView--3tVz6":m}),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),ref:n},r.createElement("div",{className:"starting_points_templates_modal--modalInstructions--ZtdTL"},r.createElement("div",{className:"starting_points_templates_modal--modalTitle--HT3eZ"},(0,d.t)("starting_points.what_do_you_want_to_make_today")),r.createElement("div",{className:"starting_points_templates_modal--modalLearnMore--g-GWo"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:V}))),r.createElement("div",{className:"starting_points_templates_modal--optionContainer--mYEsG"},r.createElement(M.$z,{className:eB,onClick:()=>F("website"),onMouseEnter:()=>B("website"),onMouseLeave:G,trackingProperties:{trackingDescriptor:R.c.WEBSITE_TEMPLATES}},r.createElement("div",{className:eG},(0,d.t)("starting_points.website")),r.createElement(ew.oW,{className:ez,src:(0,s.ck)("9b8475fdab7c1ed3cd1c0d16b957d65a80840b74"),alt:"Website template"})),r.createElement(M.$z,{className:eB,onClick:()=>F("mobile"),onMouseEnter:()=>B("mobile"),onMouseLeave:G,trackingProperties:{trackingDescriptor:R.c.MOBILE_APP_TEMPLATES}},r.createElement("div",{className:eG},(0,d.t)("starting_points.mobile_app")),r.createElement(ew.oW,{className:ez,src:(0,s.ck)("b262e57bed515b9f0da45ae54fa43824d9704c14"),alt:"Mobile app template"})),r.createElement(M.$z,{className:eB,onClick:()=>F("desktop"),onMouseEnter:()=>B("desktop"),onMouseLeave:G,trackingProperties:{trackingDescriptor:R.c.DESKTOP_APP_TEMPLATES}},r.createElement("div",{className:eG},(0,d.t)("starting_points.desktop_app")),r.createElement(ew.oW,{className:"starting_points_templates_modal--desktopTemplateImage--3kplg",src:(0,s.ck)("cb2f715253dacb4e7d3fb211ff2792fc28a38832"),alt:"Desktop app template"}))),r.createElement("div",{className:"starting_points_templates_modal--modalLearnMoreFooter--pSvfX"},(0,d.tx)("starting_points.or_learn_the_basics",{learnTheBasicsLink:V})),r.createElement("div",{className:"starting_points_templates_modal--closeButton--io-14"},r.createElement(eS.K,{onClick:e,"aria-label":(0,d.t)("general.close"),htmlAttributes:{"data-testid":"close-button"}},r.createElement(eT.A,null)))))))}let eQ=(0,eg.r1)("dismissed_starting_points_templates_modal");function eJ(){let e=(0,o.wA)(),t=!!(0,s.kc)().starting_points_modal,n=(0,x.GM)(),a=(0,eE.QL)(eb.E_.key)===eb.E_.value,l=(0,V.aV)(),i=(0,o.d4)(e=>e.mirror.sceneGraph),c=!ev.Qf(i)?.childrenNodes?.length,d=(0,eE.QL)(ef.pt.KEY)===ef.pt.VALUE,p=(0,U.q5)(),m=(0,e_.TA)(),u=p?.creatorId===m,E=(0,v.md)(F.Fy),g=(0,v.md)(ey.UQ),y=!(0,eh.f)("not_gen_0"),_=(0,eu.GS)(),h=(0,v.md)(eQ),f=(0,s.Ay)().starting_points,{show:b,isShowing:S,complete:T}=(0,D.e)({overlay:$.EYw,priority:H.N.OVERRIDING_MODAL+1,experiment:{check:n,predicate:e=>e,postCheck:(e,t)=>!t}},[E,h]);return(r.useEffect(()=>{t&&u&&!d&&!l&&c&&!S&&(a?b():y&&g&&_&&f&&b({canShow:e=>!e}))},[t,u,l,c,S,a,y,g,_,d,f,b]),S)?r.createElement(ej,{onClose:()=>{h.data||e(em.b({dismissed_starting_points_templates_modal:!0})),T()}}):null}var eq=n(612776),eZ=n(293017),e0=n(835691),e1=n(833629),e2=n(740280),e4=n(864114),e8=n(756159),e3=n(276868),e5=n(791730),e7=n(268223);let e6=(0,e7.Op)({initial:"ready_to_show",states:[{id:"ready_to_show",transitions:[(0,e7.nr)("curator_content_shown","ui3_onboarding_was_shown_in_current_session",{condition:({event:e})=>e.properties.shown===$.S$7.id})]},{id:"ui3_onboarding_was_shown_in_current_session",terminal:!0}]}),e9=(0,e7.rn)("track_ui3_onboarding_shown",e6);var te=n(276377);function tt(){let{isShowing:e,complete:t,show:n,uniqueId:a}=(0,D.e)({overlay:$.l_p,priority:H.N.SECONDARY_MODAL}),l=(0,o.wA)(),s=(0,V.aV)(),c=(0,U.q5)(),p=(0,e_.iZ)(),m=(0,eq.te)(),u=!!(0,eh.f)(e3.bo),E="ui3_onboarding_was_shown_in_current_session"===(0,e0.zl)(e9).currentState,g="no_figma_basics_onboarding_was_shown_in_current_session"===(0,e0.zl)(e5.j).currentState,y=(0,v.md)(e8.Cl),_=(0,e1.jO)(),h=c?.canEdit,f=(0,o.d4)(e=>e.leftPanel.activeTab===i.xae.LAYERS);if((0,L.E)(a,["Reset Visual Assets Tooltips",e3.io],()=>{p&&c&&l(em.b(te.g))}),(0,r.useEffect)(()=>{!m()||!h||y||u||E||g||!_||s||!f||e||n()},[n,m,h,u,_,s,E,g,e,y,f]),(0,r.useEffect)(()=>{!f&&e&&t()},[f,e,t]),!e)return null;let b=r.createElement("strong",{style:{display:"contents"}},(0,d.tx)("design_systems.assets_panel.assets"));return r.createElement(e2.X,{isShowing:e,title:(0,d.tx)("rcs.visual_assets.elevate_your_designs"),description:(0,d.tx)("rcs.visual_assets.grab_visual_assets",{strongAssets:b}),primaryCta:{label:(0,d.tx)("rcs.presets_baseline.try_it"),type:"button",onClick:()=>{l(eZ.FP({tab:i.xae.ASSETS})),t()},ctaTrackingDescriptor:R.c.PRESETS_TRY_IT},trackingContextName:"Visual Assets Intro Tooltip",userFlagOnShow:e3.bo,position:e4.Q.UI3_EDITOR_TOP_LEFT,onClose:t})}var tn=n(298455),ta=n(394828),tr=n(340514),to=n(373762),tl=n(433195);let ti=(0,eg.r1)(tl.WX),ts=(0,eg.r1)(tl.b6),tc=!1;function td(){let e=(0,o.wA)(),t=(0,v.md)(K.wg),n=(0,V.aV)(),a=(0,v.md)(F.mp),l=(0,P._I)(),i=(0,eu.GS)(),c=(0,v.md)(ts),p=(0,v.md)(ti),{uniqueId:m,show:u,complete:E,isShowing:g}=(0,D.e)({overlay:$.kc4,priority:H.N.SECONDARY_MODAL},[p,c,a]),y=(0,Y.U)("modal"),_=r.useCallback(()=>{!n&&!tc&&t&&l&&(0!==(tn.UN().getCurrentPage()?.childrenGuids.length||0)&&u({canShow:(e,t,n)=>!e&&!t&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tc=!0)},[u,l,t,n]);function h(){e(em.b({[tl.WX]:!0})),E()}r.useEffect(()=>{i||_()},[_,i]),(0,L.E)(m,(0,to.w)("design"),()=>{_()}),r.useEffect(()=>{"loaded"===p.status&&p.data&&E()},[p,E]),(0,L.E)(m,"Enter Inspect Mode",()=>{g&&h()});let f=(0,eu.GS)()?eb.ON:eb.JN;return r.createElement(tr.rq,{isShowing:g,trackingContextName:tl.WX,onClose:h,targetKey:f,title:(0,d.tx)("dev_handoff.annotations_introduction_overlay.title"),media:r.createElement(ta.y,{src:(0,s.ck)("5b9addc96424c11577a1ec91e1bbadcd786fe343"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_introduction_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_introduction_overlay.primary_cta"),type:"button",onClick:function(){y("handoff")},ctaTrackingDescriptor:R.c.SHOW_ME}})}var tp=n(502665);let tm=(0,eg.r1)(tl.b6),tu=(0,eg.r1)(tl.WX),tE=!1,tg=!1;function ty(){let e=(0,o.wA)(),t=(0,V.aV)(),n=(0,v.md)(F.mp),a=(0,v.md)(tp.N),l=(0,eo.J2)(i.Ez5.annotationObserver().annotationInfoByTlf),c=v.md(U.yV)?.creatorId,p=(0,v.md)(tm),m=(0,v.md)(tu),{uniqueId:u,show:E,complete:g,isShowing:y}=(0,D.e)({overlay:$.kc4,priority:H.N.SECONDARY_MODAL},[p,m,n,a]),_=(0,Y.U)("modal"),h=l.size>0;function f(){e(em.b({[tl.b6]:!0})),g()}r.useEffect(()=>{t&&(tg=!0),!t&&!tE&&tg&&h&&(E({canShow:(e,t,n,a)=>!e&&!t&&c!==a&&function(e){let t=Date.now();return e.getTime()<=t-12096e5}(n)}),tE=!0)},[h,t,c,E]),r.useEffect(()=>{"loaded"===p.status&&p.data&&g()},[p,g]),(0,L.E)(u,"Enter Inspect Mode",()=>{y&&f()});let b=(0,eu.GS)()?eb.ON:eb.JN;return r.createElement(tr.rq,{isShowing:y,trackingContextName:tl.b6,onClose:f,targetKey:b,title:(0,d.tx)("dev_handoff.annotations_upsell_overlay.title"),media:r.createElement(ta.y,{src:(0,s.ck)("e84a2faeb510847abd7bfb9c15a74ef974bb4c13"),alt:(0,d.t)("dev_handoff.annotations_introduction_overlay.image_alt"),aspectRatio:1280/720}),description:(0,d.tx)("dev_handoff.annotations_upsell_overlay.description"),primaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.primary_cta"),type:"button",onClick:function(){_("handoff")},ctaTrackingDescriptor:R.c.OPEN_DEV_MODE},secondaryCta:{label:(0,d.tx)("dev_handoff.annotations_upsell_overlay.secondary_cta"),type:"button",onClick:g,ctaTrackingDescriptor:R.c.NOT_NOW}})}var t_=n(57860),th=n(859905),tf=n(572206),tv=n(723325),tb=n(259927),tS=(e=>(e.START="start",e.SKIP_LOW_VOLUME_NODE="skip_low_volume_node",e.SKIP_NO_SUBSCRIBED_LIBRARIES="skip_no_subscribed_libraries",e.INITIATING_FRAGMENT_SEARCH="initiating_fragment_search",e.NO_RESULTS="no_results",e.RESULTS_SHOWN="results_shown",e.RESULT_INSERTED="result_inserted",e.RESULT_DISMISSED="result_dismissed",e.ABORTED="aborted",e.PANEL_OPENED="panel_opened",e.PANEL_CLOSED="panel_closed",e))(tS||{}),tT=(e=>(e.SOURCE_FRAGMENT="source_fragment",e.TL_NODE_RESULTS="tl_node_results",e.SELECTION_RESULTS="selection_results",e))(tT||{}),tN=(e=>(e.TOTAL="total",e.FRAGMENT_SEARCH="fragment_search",e.EXTRACT_CONTEXT="extract_context",e.SUMMARIZE_CONTEXT="summarize_context",e.FILTERING_RANKING="filtering_ranking",e.ASSET_LOOKUP="asset_lookup",e))(tN||{});let tI={fileKey:"",sessionId:"",selectionId:""};function tP(e,t){eP.az.trackDefinedEvent("auto_suggest.funnel",{...e,funnelEvent:t})}var tC=n(743282),tk=n(514816),tA=n(32067),tw=n(974880),tO=n(3794),tx=n.n(tO),tR=n(553716),tM=n(27087),tL=n(743905);async function tD(e){let{node:t,file_key:n}=e,a={session_id:null,search_id:(0,tC.g)(),node_id:e.node.guid};try{let e=(0,tL.T1)(t);if(!e)throw Error("Failed to export thumbnail");return{fragments:(await tM.Ay.post("/api/auto_suggest/asset_suggestions",{input:{type:"image",value:e},file_key:n,tracking_metadata:a})).data.meta.results.map(e=>({...e,type:"fig-file-fragment"}))}}catch(e){return}}var tK=n(15913);let tF=Error("Scene is not available");class tV{constructor(){this.validateFullScreenAvailable();let e=i.glU.resetAutoSuggestScene();if(!e)throw Error("Failed to reset auto suggest scene");this.sceneSessionId=e,this.scene=new tn.qo(i.juq.AUTO_SUGGEST),this.pageMap=new Map}destroy(){this.validation(),i.glU.clearAutoSuggestScene(this.sceneSessionId)}loadBufferToPage(e,t){let n=i.glU.loadBufferToAutoSuggestScenePage(this.sceneSessionId,t);if(!n)throw Error("Failed to load buffer to auto suggest scene");let a=this.scene.get(n);if(!a)throw Error("Unable to find page in auto suggest scene");return this.pageMap.set(e,a),a}getPageByKey(e){return this.pageMap.get(e)}async getFragmentNode(e){this.validation();let t=this.getPageByKey(e);if(t)return t;let n=new Uint8Array(await (0,tK.g)(e,e.file_key));if(!n||0===n.length)throw Error("Failed to get copy buffer for fragment");return this.loadBufferToPage(e,n)}unloadPage(e){let t=this.pageMap.get(e);if(!t)throw Error("Fragment has not been loaded");i.glU.unloadAutoSuggestScenePage(this.sceneSessionId,t.guid),this.pageMap.delete(e)}unloadFragment(e){this.validation(),this.unloadPage(e)}validation(){this.validateFullScreenAvailable(),this.validateSceneAvailable()}validateFullScreenAvailable(){if(!i.glU)throw Error("Fullscreen is not initialized")}validateSceneAvailable(){let e=i.glU.getAutoSuggestSceneSessionId();if(!e||e!==this.sceneSessionId)throw tF}}var tU=n(173454);let tB=[tU.PW.COMPONENT,tU.PW.STATE_GROUP],tG={searchByNodeType:"all",selectedNodeConfig:{skipLowVolumeNodes:3,numFragments:15,rankingConfig:{count:1,fragmentCount:0,avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:0},filteringConfig:{libraryKeyFilterType:"file",fragmentsBelowScore:.85,proximityScoreThreshold:0},minRequiredResults:2},topLevelNodeConfig:{skipLowVolumeNodes:3,numFragments:15,rankingConfig:{count:1,fragmentCount:0,avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:1},filteringConfig:{libraryKeyFilterType:"file",fragmentsBelowScore:.85,proximityScoreThreshold:0},minRequiredResults:1},componentExtractionConfig:{nestedComponents:"all",detachedComponentChildren:!1},numResults:5},tz=["GROUP","FRAME","SECTION","RECTANGLE","ROUNDED_RECTANGLE"];var tH=n(83783),tW=n(774886),tY=n.n(tW),t$=n(130097),tX=n(623746);function tj(e,t){let n=e.absoluteBoundingBox,a=t.absoluteBoundingBox;return{size:{width:n.w,height:n.h},fragmentSize:{width:a.w,height:a.h},relativePosition:{x:n.x-a.x,y:n.y-a.y}}}function tQ({scene:e,root:t,componentExtractionConfig:n,fragment:a,selectedNodePositionInfo:r,filteringConfig:o,subscribedLibraryKeys:l}){let i=[],s="all"===n.nestedComponents?"skip":void 0,c=!!r;return(o?.libraryKeyFilterType!=="file"||l)&&(0,tH.hV)(t,t=>{if(!t||t.isInternalOnlyNode||t.opacity<=0||!t.visible)return"skip";if("INSTANCE"===t.type){var d;let p,m={fragment:a};if(t.isPrimaryInstance?p=t.symbolId:n.nestedComponents?"notInstanceSwapped"===n.nestedComponents&&t.isSwappedNestedInstance&&(p=t.symbolId):p=t.symbolId,!p)return s;if(c){let n=tj(t,e.get(t.findContainingTopLevelFrameOrSelf())),a=r?function(e,t){let n={x:e.relativePosition.x+e.size.width/2,y:e.relativePosition.y+e.size.height/2},a={x:n.x/e.fragmentSize.width,y:n.y/e.fragmentSize.height},r={x:t.relativePosition.x+t.size.width/2,y:t.relativePosition.y+t.size.height/2},o={x:r.x/t.fragmentSize.width,y:r.y/t.fragmentSize.height},l={x:1-Math.abs(a.x-o.x),y:1-Math.abs(a.y-o.y)};return Math.sqrt(Math.pow(l.x,2)+Math.pow(l.y,2))}(n,r):0;if((o?.proximityScoreThreshold||0)>a)return s;m.positionInfo={...n,proximityScore:a}}let u=e.get(p);if(!u)return s;if(u.isState){let t=e.get(u.containingStateGroupId);if(!t)return s;m={...m,type:tU.PW.STATE_GROUP,key:t.stateGroupKey,stateComponentKey:u.componentKey,libraryKey:t.sourceLibraryKey,name:t.name,description:t.description}}else m={...m,type:tU.PW.COMPONENT,key:u.componentKey,libraryKey:u.sourceLibraryKey,name:u.name,description:u.description};return m.key&&m.libraryKey&&m.libraryKey.length&&u.publishID&&u.isSubscribedAsset&&(o?.libraryKeyFilterType!=="file"||m.libraryKey&&l?.has(m.libraryKey))&&(!m.name||(d=m.name).startsWith(".")||d.startsWith("_")||d.includes("/.")||d.includes("/_")||i.push(m)),s}if(t.detachedInfo&&n.detachedComponentChildren)return"skip"}),i}function tJ(e){let t={};return e.forEach(e=>{let{key:n,type:a,name:r,description:o,libraryKey:l,fragment:i,positionInfo:s}=e;t[n]||(t[n]={type:a,key:n,libraryKey:l,name:r,description:o,count:0,fragmentCount:0,countPerFragment:{},scorePerFragment:{},stateCounts:{},proximityScores:[],avgCountPerFragment:0,avgScorePerFragment:0,avgProximityScore:0});let c=t[n];c.count++,s&&c.proximityScores.push(s.proximityScore);let d=i?`${i.file_key}.${i.node_id}`:null;if(i&&d&&(!c.countPerFragment[d]&&(c.countPerFragment[d]=0,c.scorePerFragment[d]=i.score,c.fragmentCount++),c.countPerFragment[d]++),a===tU.PW.STATE_GROUP){let{stateComponentKey:t}=e;c.stateCounts[t]||(c.stateCounts[t]=0),c.stateCounts[t]++}}),Object.values(t).forEach(e=>{let t=Object.values(e.countPerFragment);e.avgCountPerFragment=t.length>0?tY()(t):0;let n=Object.values(e.scorePerFragment);e.avgScorePerFragment=n.length>0?tY()(n):0,e.avgProximityScore=e.proximityScores.length>0?tY()(e.proximityScores):0}),t}async function tq(e,t){switch(e){case tU.PW.COMPONENT:{let e=(await (0,t$.Ek)(G.aAC,{key:t})).component,n=e?.file,a=e?.userFacingVersion;if(!e||!n||!a)return null;return(0,tX.Qp)(e,{type:"team",file:n})}case tU.PW.STATE_GROUP:{let e=(await (0,t$.Ek)(G.jY8,{key:t})).stateGroup,n=e?.file,a=e?.minNodeWidth,r=e?.minNodeHeight,o=e?.defaultStateKey;if(!e||!n||!a||!r||!o)return null;return(0,tX.SS)(e,{type:"team",file:n})}default:return null}}async function tZ({selectedNode:e,openFileKey:t,analyticsData:n,subscribedLibraryKeys:a}){(0,s.Ay)().anticipation_config||((0,s.Ay)().anticipation_config=tG);let r=(0,s.Ay)().anticipation_config;if(!i.glU)return Promise.resolve([]);let o=(0,tn.UN)(),l=e.findContainingTopLevelFrameOrSelf(),c=o.get(l),d=c?.guid===e.guid,p=[],m=[Date.now()],u={},E=(e,t,a)=>{let r=Date.now();m.length>0&&function(e,t,n,a){let r=`${t}.${n}`;eP.az.trackDefinedEvent("auto_suggest.timer",{...e,stepName:r,duration:a})}(n,e,t,r-m[(0,tw.Et)(a)?a:m.length-1]),m.push(r)},g=(e,t)=>{u[e]=t};tP(n,tS.START);let y=tJ(tQ({scene:o,root:c,componentExtractionConfig:{nestedComponents:null,detachedComponentChildren:!1}})),_=tj(e,c);E(tT.SOURCE_FRAGMENT,tN.EXTRACT_CONTEXT),g("contextComponentUsage",y);try{["selected","all"].includes(r.searchByNodeType)&&p.push(...await t0({node:e,openFileKey:t,config:r,configForNodeType:r.selectedNodeConfig,contextComponentUsage:y,selectedNodePositionInfo:_,analyticsData:n,subscribedLibraryKeys:a,updateTimersAndLog:e=>{E(tT.SELECTION_RESULTS,e)},addDebugInfo:(e,t)=>{g(`${tT.SELECTION_RESULTS}.${e}`,t)}})),("topLevel"===r.searchByNodeType||"all"===r.searchByNodeType&&!d)&&c&&p.length<r.numResults&&p.push(...await t0({node:c,openFileKey:t,config:r,configForNodeType:r.topLevelNodeConfig,contextComponentUsage:y,selectedNodePositionInfo:_,analyticsData:n,subscribedLibraryKeys:a,updateTimersAndLog:e=>{E(tT.TL_NODE_RESULTS,e)},addDebugInfo:(e,t)=>{g(`${tT.TL_NODE_RESULTS}.${e}`,t)}}))}catch(e){e!==tF&&(0,tR.x1)("auto_suggest","Error getting suggestions",{error:e})}return E(tT.SOURCE_FRAGMENT,tN.TOTAL,0),(0,tR.Lo)("auto_suggest","Auto Suggest Results",{suggestions:p||"no_results",debugInfo:u}),p}async function t0({node:e,openFileKey:t,config:n,configForNodeType:a,contextComponentUsage:r,selectedNodePositionInfo:o,analyticsData:l,subscribedLibraryKeys:i,updateTimersAndLog:s,addDebugInfo:c}){let d;if(d=0,(0,tH.hV)(e,e=>!e||e.isInternalOnlyNode||e.opacity<=0||!e.visible?"skip":(d+=1,"INSTANCE"===e.type)?"skip":void 0),d<a.skipLowVolumeNodes)return tP(l,tS.SKIP_LOW_VOLUME_NODE),Promise.resolve([]);if("file"===a.filteringConfig.libraryKeyFilterType&&0===i.size)return tP(l,tS.SKIP_NO_SUBSCRIBED_LIBRARIES),Promise.resolve([]);let p=a.filteringConfig,m=e.findContainingTopLevelFrameOrSelf();tP(l,tS.INITIATING_FRAGMENT_SEARCH);let u=await tD({type:"input-selection",node:e,file_key:t,name:e.name});if(s(tN.FRAGMENT_SEARCH),!u||0===u.fragments.length)return tP(l,tS.NO_RESULTS),Promise.resolve([]);let E=Array.from(new Map(u.fragments.map(e=>[`${e.file_key}_${e.node_id}`,e])).values()).filter(n=>!(n.score<p.fragmentsBelowScore)&&(n.file_key!==t||n.node_id!==e.guid&&(!m||n.node_id!==m))).slice(0,10);if(0===E.length)return tP(l,tS.NO_RESULTS),Promise.resolve([]);c("fragments",E);let g=new tV,y=tx()(await Promise.all(E.map(async e=>{try{let t=await g.getFragmentNode(e),a=tQ({scene:g.scene,root:t,componentExtractionConfig:n.componentExtractionConfig,fragment:e,selectedNodePositionInfo:o,filteringConfig:p,subscribedLibraryKeys:i});return g.unloadFragment(e),a}catch(t){if(t===tF)throw tF;return(0,tR.x1)("auto_suggest","Error loading fragment",{error:t,fragment:e}),null}}))).flat();g.destroy(),s(tN.EXTRACT_CONTEXT),c("fragmentComponentInfo",y);let _=tJ(y);s(tN.SUMMARIZE_CONTEXT),c("componentUsage",_),function({componentUsage:e,contextComponentUsage:t}){Object.values(e).forEach(({key:n,countPerFragment:a})=>{let r=t[n];if(!r)return;let o=Object.values(a).reduce((e,t)=>e+t,0)/Object.values(a).length;r.count<o||delete e[n]})}({componentUsage:_,contextComponentUsage:r});let h=function({componentUsage:e,rankingConfig:t}){let n=Object.values(e),a={count:Math.max(...n.map(e=>e.count)),fragmentCount:Math.max(...n.map(e=>e.fragmentCount)),avgCountPerFragment:Math.max(...n.map(e=>e.avgCountPerFragment)),avgScorePerFragment:Math.max(...n.map(e=>e.avgScorePerFragment)),avgProximityScore:Math.max(...n.map(e=>e.avgProximityScore))},r={count:Math.min(...n.map(e=>e.count)),fragmentCount:Math.min(...n.map(e=>e.fragmentCount)),avgCountPerFragment:Math.min(...n.map(e=>e.avgCountPerFragment)),avgScorePerFragment:Math.min(...n.map(e=>e.avgScorePerFragment)),avgProximityScore:Math.min(...n.map(e=>e.avgProximityScore))};return n.map(e=>{let n=(e,t,n)=>n===t?0:(e-t)/(n-t),o=n(e.count,r.count,a.count)*t.count,l=n(e.fragmentCount,r.fragmentCount,a.fragmentCount)*t.fragmentCount,i=n(e.avgCountPerFragment,r.avgCountPerFragment,a.avgCountPerFragment)*t.avgCountPerFragment,s=n(e.avgScorePerFragment,r.avgScorePerFragment,a.avgScorePerFragment)*t.avgScorePerFragment,c=n(e.avgProximityScore,r.avgProximityScore,a.avgProximityScore)*t.avgProximityScore;return{...e,key:e.key,score:o+l+i+s+c}}).sort((e,t)=>t.score-e.score)}({componentUsage:_,rankingConfig:a.rankingConfig});s(tN.FILTERING_RANKING);let f=[],v=0;for(;v<h.length&&f.length<n.numResults;){let e=h[v];if(!e){v++;continue}let{key:t}=e,n=_[t];if(!n){v++;continue}let a=await tq(n.type,t);a&&f.push(a),v++}return s(tN.ASSET_LOOKUP),c("results",f),0===f.length&&tP(l,tS.NO_RESULTS),f}var t1=n(38329),t2=n(284321),t4=(e=>(e.BLACK_BLANK="40002168:784",e.BLACK_WHERE_TO="40000039:913",e.BROWN_REVISE_PROMPT="40000039:918",e.BROWN_TAB_TOGGLER="40000039:921",e))(t4||{}),t8=(e=>(e.MOBILE_DAY_PICKER="474:4773",e.MOBILE_PILL_TIME="474:4831",e.MOBILE_FLIGHT_CARD="469:2787",e.MOBILE_NOTIFICATION="475:6605",e.MOBILE_NOTIFICATION_BOOKS="2440:5914",e.MOBILE_TAB_TOGGLER="380:4294",e.MOBILE_ROME="213:2453",e.MOBILE_HILO="527:7273",e.MOBILE_DAY_VIEW="474:5088",e.MOBILE_SEARCH_INPUT_BLACK="449:9470",e.MOBILE_SEARCH_INPUT_GREEN="281:604",e.MOBILE_MEMORY_TILE_PURPLE="475:6981",e.MOBILE_LABEL_BLACK="475:6504",e.MOBILE_LABEL_GRAY="475:6503",e.MOBILE_BOTTOM_NAV_WHITE="452:10133",e))(t8||{});let t3=["449:9470","474:4773","474:4831","469:2787","475:6605","2440:5914"],t5={"40002168:784":["449:9470","380:4294","527:7273","469:2787"],"40000039:913":["380:4294","527:7273","469:2787","474:5088","475:6504"],"40000039:918":["281:604","213:2453","475:6981","475:6503"],"40000039:921":["452:10133","213:2453","469:2787"]};async function t7(e){let t=t1.D.getState(),n=(0,t2.MH)(t);if(!n)return[];let a=t5[e]||t3,r=[];return(a.forEach(e=>{let t=n[e];t&&tB.includes(t.type)&&r.push(t)}),r.length>0)?(await new Promise(e=>setTimeout(e,1e3)),r):[]}async function t6(e){return(0,s.kc)().anticipation_uxr?await t7(e.selectedNode.guid):await tZ(e)}var t9=n(448406),ne=n(811529),nt=n(155565),nn=n(75395),na=n(740788),nr=n(522739),no=n(141123),nl=n(232205),ni=n(186380);function ns({asset:e,defaultDropPosition:t,onDismiss:n,onInsert:a}){let[o,l]=r.useState(!1);return o?null:r.createElement("div",{className:"asset_shelf_suggestion--container--18Rt5"},r.createElement("div",{className:"asset_shelf_suggestion--suggestionContainer--rY1cW"},r.createElement(nc,{asset:e,defaultDropPosition:t,onInsert:a},r.createElement("div",{className:"asset_shelf_suggestion--suggestion--WCutP"},r.createElement(ni.M,{className:"asset_shelf_suggestion--image--R4c1I",item:e,shouldGenerateLocalThumbnail:!0,draggable:!1})))),r.createElement(nn.E,{className:"asset_shelf_suggestion--closeIcon--1S4i2",onClick:()=>{l(!0),n()}},r.createElement(na.p,null)))}function nc(e){let{asset:t,defaultDropPosition:n,onInsert:a}=e,{onInsertableResourcePointerDown:o,dragState:l,insertAction:i}=(0,nl.j)({resource:t,isList:!0,sourceForTracking:"SuggestionsShelf",clickToInsert_DEPRECATED:!1,draggingThumbMaxDimensions:void 0,insertionCallback:a}),s=new tf.Mi(.5,.5);return r.createElement(r.Fragment,null,r.createElement(nr.GG,{onPointerDown:e=>{o(e)},onClick:e=>{i({e:new PointerEvent(e.type,{...e,view:window}),isClick:!0,pointerPercentageOffset:s,dropPosition:n})}},e.children),r.createElement(no.q,{dragState:l,isList:!0}))}let nd="suggestions_shelf--emptyStateText--T0I8P";function np({setIsOpen:e}){let{suggestions:t,isLoading:n,selectedNode:a,analyticsData:o}=function(){let[e,t]=r.useState(!1),n=(0,tA.VW)();return r.useEffect(()=>{let e=()=>t(!0),n=()=>t(!1);return window.addEventListener("mousedown",e),window.addEventListener("mouseup",n),()=>{window.removeEventListener("mousedown",e),window.removeEventListener("mouseup",n)}},[]),{...function({selectedNode:e,disabled:t=!1}){let n=t||!(0,s.kc)().anticipation&&!(0,s.kc)().anticipation_uxr,[a,o]=r.useState([]),[l,i]=r.useState(tI),[c,d]=r.useState(!1),p=r.useRef(void 0),m=(0,U.tS)(),u=(0,tk.He)();return r.useEffect(()=>{if(n||e?.guid===p.current)return;let t=new AbortController;if(e&&m){if(e&&tz.includes(e.type)){d(!0),o([]),p.current=e.guid;let n={fileKey:m,sessionId:(0,tC.g)(),selectionId:e?.guid};i(n);let{signal:a}=t;t6({selectedNode:e,openFileKey:m,signal:a,analyticsData:n,subscribedLibraryKeys:u}).then(e=>{a.aborted||o(e)}).catch(e=>{if("AbortError"===e.name)return}).finally(()=>{a.aborted||d(!1)})}else e&&(d(!1),o([]),p.current=e.guid)}else o([]),d(!1),p.current=void 0,i(tI);return()=>{t&&t.abort()}},[e,n,m,u]),{suggestions:a,isLoading:c,analyticsData:l}}({selectedNode:n,disabled:e}),selectedNode:n}}(),l=r.useMemo(()=>{let e=a?a.absoluteBoundingBox.x+a.absoluteBoundingBox.w/2:0,t=a?a.absoluteBoundingBox.y+a.absoluteBoundingBox.h/2:0;return new tf.Mi(e,t)},[a]),i=r.createElement(th.k,{className:"suggestions_shelf--upChevron--oUF5v suggestions_shelf--downChevron--ZbvaY"}),c=r.useMemo(()=>t.slice(0,5).map((e,t)=>r.createElement(ns,{key:`suggestion:${t}`,asset:e,fileName:"mock",thumbLayout:t9.rp.SMALL,thumbHeight:35,thumbWidth:40,sectionPosition:t,displayType:"list",sourceForTracking:"suggestionsShelf",viewMode:ne.Bk.Grid,defaultDropPosition:l,onDismiss:()=>{tP(o,tS.RESULT_DISMISSED)},onInsert:()=>{tP(o,tS.RESULT_INSERTED)}})),[t,l,o]);return r.createElement("div",{className:"suggestions_shelf--shelf--401Ia"},n&&r.createElement(t_.k,null),!n&&!a&&r.createElement("div",{className:nd},(0,d.t)("asset_suggestions.suggestion_shelf_empty_state")),!n&&a&&(t.length>0?r.createElement("div",{className:"suggestions_shelf--suggestions--aZ-e9"},c):r.createElement("div",{className:nd},(0,d.t)("asset_suggestions.suggestion_shelf_no_suggestions"))),r.createElement("button",{className:"suggestions_shelf--upChevronContainer---RjEh",onClick:()=>{tP(o,tS.PANEL_CLOSED),e(!1)}},i))}function nm(){let e=(0,eo.ut)(i.Ez5?.editorPreferences().showAssetAutoSuggest,!0),t=r.useCallback(e=>{i.Ez5?.editorPreferences().showAssetAutoSuggest.set(e)},[]),[n,a]=(0,nt.d)(),o=r.createElement(th.k,{className:"suggestions_shelf--downChevron--ZbvaY"}),l=r.createElement("button",{className:"suggestions_shelf--downChevronContainer--9AOKn",onClick:()=>{tP(tI,tS.PANEL_OPENED),t(!e)}},o);return r.createElement(tv.dP,null,r.createElement("div",{className:eI()("suggestions_shelf--wrapper--seged",tb.Dm)},r.createElement("div",{className:e?"suggestions_shelf--shelfContainerOpen--qh1UB suggestions_shelf--shelfContainer--EXG5K":"suggestions_shelf--shelfContainerClosed--jUxyH suggestions_shelf--shelfContainer--EXG5K",style:{marginLeft:n,marginRight:a}},!e&&l,e&&r.createElement(np,{setIsOpen:t}))))}function nu(){return(0,s.kc)().anticipation_uxr||(0,s.kc)().anticipation?r.createElement(nm,null):null}var nE=n(152811),ng=n(821910),ny=n(602628),n_=n(269568),nh=n(395096),nf=n(91408),nv=n(189430),nb=n(187134),nS=n(263159);let nT=(0,r.memo)(function(e){return(0,nS.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nS.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M10.003 7.375A5.5 5.5 0 0 1 16.61 9.5H14a.5.5 0 0 0 0 1h3.5a.5.5 0 0 0 .5-.5V6.5a.5.5 0 0 0-1 0v1.847a6.5 6.5 0 1 0-.128 8.456.5.5 0 1 0-.75-.662 5.5 5.5 0 1 1-6.119-8.766",clipRule:"evenodd"})})});var nN=n(755020),nI=n(631437),nP=n(73950),nC=n(163023),nk=n(371591),nA=n(539321),nw=n(694598),nO=n(934533),nx=n(452246),nR=n(869156),nM=n(215932);function nL(e,t,n){t1.D.dispatch(p.F.enqueue({message:e,type:n,icon:t,timeoutOverride:3e3}))}var nD=n(828650);function nK(){let e=(0,v.md)(nM.m7);return(0,r.useMemo)(()=>(function(e){let t=(0,nP.r8)();if(!t)return{};let n={};for(let r of e.values())for(let e of r.values()){var a;let r=t.getRuleById(e.ruleId);if(!r)continue;let o=(a=e.detectionContext)?r.id===nw.C.REQUIRE_COLOR_TOKENS&&"color"in a?`${r.id}-${(0,nA.colorToHex)(a.color)}-${a.opacity}`:JSON.stringify(a,Object.keys(a).sort()):r.id,l=n[o];l?l.push(e):n[o]=[e]}return n})(e),[e])}function nF(){let e=(0,v.md)(nM.m7);return(0,r.useMemo)(()=>Array.from(e.values()).reduce((e,t)=>e+t.size,0),[e])}function nV(){let e=(0,ek.Xr)(nM.Bc);return{selectGroup:(0,r.useCallback)(t=>{e({view:nD.N.VIOLATIONS,selectedViolationGroup:t})},[e]),returnToGroupList:(0,r.useCallback)(()=>{e({view:nD.N.GROUPS,selectedViolationGroup:null})},[e])}}function nU(){let e=nK(),{selectedViolationGroup:t}=(0,v.md)(nM.Bc);return t?e[t]??[]:[]}let nB="design_linter_view--chit--bjexe paint_panels--chit--twQEy",nG="design_linter_view--rotateNegative90--oRXtL";var nz=n(370903),nH=n(995382);function nW({shouldDisplay:e}){return e?r.createElement("div",{className:T.cx.p12.flex.justifyCenter.$},(0,d.tx)("design_linter.penalty_box.no_violations")):null}function nY(){let e=(0,nP.r8)();return r.createElement(nb.o,{eventListeners:["onClick"]},r.createElement(eS.K,{onClick:()=>{e?.runDetectionOnMaybeSelectionOrPage()},"aria-label":(0,d.t)("design_linter.penalty_box.refresh_button_aria"),recordingKey:"designLinter.refresh"},r.createElement(nT,null)))}function n$(){let e=nF();return r.createElement("div",{className:T.cx.p8.pl16.cursorDefault.selectNone.pr0.wFull.pl8.$},r.createElement("div",{className:T.cx.flex.flexRow.justifyBetween.itemsCenter.$},r.createElement("div",{className:T.cx.flex.textBodyMediumStrong.$},r.createElement("span",{className:T.cx.mr2.$},(0,d.tx)("design_linter.penalty_box.title")),r.createElement("span",null,e?`(${e})`:"")),r.createElement("div",{className:T.cx.flex.gap4.$},r.createElement(nY,null))))}function nX(){let e=(0,v.md)(nM.fY),t=(0,tn.UN)(),n=e[0]??"",a=1===e.length?t.get(n)?.name??"":(0,d.tx)("design_linter.penalty_box.multiple_targets");return r.createElement("div",{className:T.cx.flex.mt8.gap4.itemsCenter.bb1.colorBorder.bSolid.p8.pl16.pt4.$},r.createElement(nk.Bf,{guid:n}),r.createElement("div",{className:T.cx.textBodyMedium.colorTextSecondary.truncate.$,"data-tooltip":a,"data-tooltip-type":"text"},a))}function nj({onNavigateBack:e,title:t}){return r.createElement(nn.E,{className:T.cx.bb1.colorBorder.bSolid.wFull.$,onClick:e},r.createElement("div",{className:T.cx.p8.pl0.flex.itemsCenter.justifyBetween.$},r.createElement("div",{className:T.cx.flex.itemsCenter.gap6.$},r.createElement(nN.C,null),r.createElement("span",{className:T.cx.textBodyMediumStrong.$},t))))}function nQ({onNext:e,onPrev:t,title:n,disabled:a,currentIndex:o}){return r.createElement("div",{className:T.cx.flex.flexRow.itemsCenter.p8.justifyEnd.gap8.$},r.createElement("div",{className:T.cx.flex.gap8.itemsCenter.$},r.createElement(nJ,{currentIndex:o}),r.createElement("div",{className:"design_linter_view--tabularNumbers--Xn7aT"},n)),r.createElement("div",{className:T.cx.flex.flexRow.gap2.$},r.createElement(eS.K,{onClick:e=>{e.currentTarget.blur(),t()},disabled:a,"aria-label":(0,d.t)("general.previous"),recordingKey:"designLinter.previousViolation"},r.createElement(nC.B,{svg:nH.A,className:nG})),r.createElement(eS.K,{onClick:t=>{t.currentTarget.blur(),e()},disabled:a,"aria-label":(0,d.t)("general.next"),recordingKey:"designLinter.nextViolation"},r.createElement(nC.B,{svg:nz.A,className:nG}))))}function nJ({currentIndex:e}){let t=nU(),n=(0,r.useCallback)(()=>{if(!i.Egt)return;let n=t[e]?.guid;n&&i.Egt.replaceSelection([n],!0)},[t,e]);return r.createElement(eS.K,{onClick:n,"aria-label":(0,d.t)("design_linter.penalty_box.select_current_violation_button_aria"),recordingKey:"designLinter.selectCurrentViolation"},r.createElement(nI.A,null))}var nq=n(342691),nZ=n(568214),n0=n(153234),n1=n(886133),n2=n(356390),n4=n(603634);function n8(){let e=(0,U.q5)(),t=nF(),n=Object.entries(function(){let e=(0,v.md)(nM.m7);return(0,r.useMemo)(()=>{let t={};for(let n of e.values())for(let e of n.values()){let n=t[e.ruleId];n?n.push(e):t[e.ruleId]=[e]}return t},[e])}()).map(([e,t])=>({rule:e,count:t.length})),[a,o]=(0,r.useState)(0),l=(0,v.md)(nP.vo),i=(0,tn.UN)().getCurrentPage();if((0,eC.h)(()=>{if(!i)return;let e=0;(0,tH.hV)(i,()=>{e++}),o(e)}),!i||!e)return null;let s=e._name??"File",c=i.name;return r.createElement("div",{className:T.cx.px16.mt4.$},r.createElement("span",{className:T.cx.textHeadingMedium.block.$},"Debug view"," "),r.createElement("span",{className:T.cx.textBodyMedium.block.$},`Linter status: ${l}`," "),r.createElement("span",{className:T.cx.textBodyMedium.block.$},`${s} - ${c}`," "),r.createElement("span",{className:T.cx.textBodyMedium.block.$},`Total layers: ${a}`," "),r.createElement("span",{className:T.cx.textBodyMedium.block.$},`Total violations: ${t}`," "),r.createElement("span",{className:T.cx.textHeadingSmall.block.pt8.$},"Violations per rule"),r.createElement("ol",null,n.map(({rule:e,count:t})=>r.createElement("span",{key:e,className:T.cx.textBodyMedium.block.$},`${e}: ${t}`))))}var n3=n(463033),n5=n(73150),n7=n(45623),n6=n(775664),n9=n(973149);function ae({violation:e,onGetFix:t,selectAllNodes:n,onFix:a,onFixAllSelected:o,multipleViolationsSelected:l,showSelectAllButton:i}){let[s,c]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{(async()=>{try{if(e){c(void 0);let n=await t(e);c(n)}}catch(e){console.error("Error fetching fix: ",e)}})()},[e,t]);let p=(0,r.useCallback)(()=>{s&&(l?o(s):a(e))},[a,e,s,l,o]);return r.createElement("div",{className:T.cx.bb1.colorBorder.bSolid.$},r.createElement("div",{className:T.cx.py16.relative.mx16.flex.flexColumn.$},s&&r.createElement(r.Fragment,null,r.createElement("div",{className:eI()(T.cx.absolute.w14.colorBg.h4.$,"design_linter_view--fixArrowBackgroundPosition---Zemo")}),r.createElement("div",{className:eI()(T.cx.absolute.$,"design_linter_view--fixArrowDownPosition--hFL3f")},r.createElement(n5.Q,{className:"design_linter_view--iconTertiary--f-k-n"}))),r.createElement(ar,{violation:e}),r.createElement(at,{fix:s}),r.createElement("div",{className:T.cx.flex.justifyEnd.gap8.maxW300.$},i?r.createElement(n3.$n,{variant:"secondary",onClick:n,recordingKey:"designLinter.selectAll"},(0,d.tx)("design_linter.penalty_box.select_all")):null,r.createElement(n3.$n,{variant:"primary",disabled:!s?.valid,onClick:p,recordingKey:"designLinter.fix"},l?(0,d.tx)("design_linter.penalty_box.apply_all"):(0,d.tx)("design_linter.penalty_box.fix")))))}function at({fix:e}){return r.createElement("div",{className:T.cx.flex.itemsCenter.h24.radiusMedium.colorBorder.b1.mt8.mb16.maxW300.$},r.createElement(an,{fix:e}))}function an({fix:e}){if(!e)return r.createElement(ai,null);if(!e.valid||!e.fixContext)return r.createElement(al,null);let{ruleId:t,guid:n,fixContext:a}=e;return tn.UN()?.get(n)&&t===nw.C.REQUIRE_COLOR_TOKENS?r.createElement(aa,{context:a}):null}function aa({context:e}){if(!("fixes"in e)||!("selection"in e))return null;let{fixes:t,selection:n}=e;if(!t||0===t.length)return null;let a=t[n??0];if(!a)return null;let{variableId:o,resolvedValue:l}=a,i=v.zl.get(nM.nE),s=i[o]?.name,c=l.value;return c&&s?r.createElement(r.Fragment,null,r.createElement("div",{className:nB},r.createElement(n4.J,{color:c,opacity:c.a})),r.createElement("span",{className:T.cx.textBodyMedium.colorText.truncate.$},s)):null}function ar({violation:e}){let{ruleId:t,detectionContext:n}=e;return t===nw.C.REQUIRE_COLOR_TOKENS?r.createElement(ao,{context:n}):null}function ao({context:e}){if(!e||!("color"in e))return null;let t=e.color,n=e.opacity;return r.createElement("div",{className:T.cx.flex.maxW300.$},r.createElement("div",{className:eI()(T.cx.flex.itemsCenter.h24.radiusMedium.colorBgSecondary.justifyBetween.w250.if(void 0===n,T.cx.w300).$,"design_linter_view--currentColorHexBorderRadius--JEZ3p")},r.createElement("div",{className:T.cx.flex.itemsCenter.$},r.createElement("div",{className:eI()(nB,T.cx.m4.$)},r.createElement(n4.J,{color:t,opacity:n})),r.createElement("div",{className:T.cx.textBodyMedium.colorText.selectNone.$},n6.TI.format(t)))),void 0!==n&&r.createElement("div",{className:eI()(T.cx.pl8.bl1.bSolid.colorBorderBg.colorText.flex.itemsCenter.h24.radiusMedium.colorBgSecondary.$,"design_linter_view--currentColorOpacity--C40Tb")},new n9.t6({min:0,max:100}).format(100*n),r.createElement("span",{className:T.cx.colorTextSecondary.pl12.pr6.selectNone.$},"%")))}function al(){return r.createElement("div",{className:T.cx.flex.itemsCenter.$},r.createElement(n7.Z,null),r.createElement("div",null,(0,d.t)("design_linter.penalty_box.no_fix_available")))}function ai(){return r.createElement("div",{className:T.cx.flex.itemsCenter.$},r.createElement("span",{className:T.cx.flex.ml2.mr4.$},r.createElement(t_.k,{size:"sm"})),(0,d.t)("design_linter.penalty_box.loading_fix"))}function as(){let e=(0,ek.Xr)(nM.Bc);return(0,eC.h)(()=>()=>{e({view:nD.N.GROUPS,selectedViolationGroup:null}),i.Ez5?.uiState().showDesignLinter.set(!1)}),r.createElement("div",{className:"design_linter_view--displayContents--2Xg5Q","data-testid":"design-linter-container"},r.createElement("div",{className:T.cx.flex.flexColumn.wFull.hFull.overflowHidden.overflowYScroll.cursorDefault.$},r.createElement(ac,null),(0,s.kc)().aip_flower_garden_debug&&r.createElement(n8,null)))}function ac(){let e=(0,v.md)(nP.vo)===nP.td.DETECTING,t=nU(),n=nK(),{view:a,selectedViolationGroup:o}=(0,v.md)(nM.Bc),{status:l}=(0,v.md)(nM.v4),i=["uninitialized","loading"].includes(l);return e||i?r.createElement("div",{className:T.cx.flex.mt12.justifyCenter.$},r.createElement(n1.y$,null)):a!==nD.N.GROUPS&&o&&t.length?a===nD.N.VIOLATIONS?r.createElement(au,{violations:t}):null:r.createElement(ad,{groupedViolations:n})}function ad({groupedViolations:e}){let t=(0,nP.r8)();if(!t)return null;let n=Object.entries(e).sort(([e],[t])=>e.localeCompare(t));return r.createElement("div",{"data-testid":"design-linter-groups-list"},r.createElement(nX,null),n.map(([e,n])=>{if(!n.length)return null;let a=n[0],o=a?.ruleId,l=o?t.getRuleById(o):null;return l?r.createElement(ap,{key:e,groupId:e,violationList:n,rule:l}):null}),r.createElement(nW,{shouldDisplay:!n.length}))}function ap({groupId:e,violationList:t,rule:n}){let{selectGroup:a}=nV(),[o,l]=(0,r.useState)(!1),i=t[0];return i?r.createElement(nn.E,{className:T.cx.p16.pr8.flex.justifyBetween.itemsCenter.bb1.colorBorder.bSolid.wFull.if(o,T.cx.colorBgHover).$,onClick:()=>a(e),htmlAttributes:{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1)},recordingKey:(0,n0.Pt)("designLinter",e)},r.createElement("div",{className:T.cx.flex.flexColumn.$},r.createElement("div",{className:T.cx.textBodyMediumStrong.pb2.$},n.name,r.createElement("span",{className:T.cx.pl4.textBodyMedium.colorTextSecondary.$},`(${t.length})`)),r.createElement(am,{rule:n,context:i.detectionContext})),r.createElement(nq.a,{style:{"--color-icon":"var(--color-icon-tertiary)"}})):null}function am({rule:e,context:t}){if(e.id===nw.C.REQUIRE_COLOR_TOKENS){if(!("color"in t))return null;let e=t.color,n=(0,nZ.F_)(e);return r.createElement("div",{className:T.cx.flex.itemsCenter.$},e?r.createElement("div",{className:nB},r.createElement(n4.J,{color:e,opacity:t.opacity})):null,r.createElement("div",{className:T.cx.textBodyMedium.colorTextSecondary.ml4.$},n.toUpperCase().replace("#","")))}return null}function au({violations:e}){let{returnToGroupList:t}=nV(),[n,a]=(0,r.useState)(0),[o,l]=(0,r.useState)(!1),s=(0,V.KH)(),c=(0,r.useRef)(e.length);(0,r.useEffect)(()=>{let t=Object.keys(s),n=new Set(e.map(e=>e.guid));l(t.length>1&&t.every(e=>n.has(e)))},[s,e]);let p=(0,r.useCallback)(()=>{e.length>1||t()},[e,t]),m=function(){let e=(0,nP.r8)();return(0,r.useCallback)(async t=>{if(e)try{return await e.getFix(t)}catch(e){nL("Error getting fix for violation!",nO.zX.EXCLAMATION,"error");return}},[e])}(),u=function(e){let t=(0,nP.r8)();return(0,r.useCallback)(async n=>{if(t)try{await t.fixSingleViolation(n)?e?.():nL((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nO.zX.EXCLAMATION,"error")}catch(e){nL((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nO.zX.EXCLAMATION,"error")}},[t,e])}(p),E=function(e){let t=(0,nP.r8)(),n=(0,V.KH)(),a=nU();return(0,r.useCallback)(async r=>{if(!r?.fixContext||!t)return;let o=Object.keys(n),l=a.filter(e=>o.includes(e.guid));try{await t.applyFixContextToViolations(l,r.fixContext),e?.()}catch(e){nL((0,d.t)("design_linter.penalty_box.fix_failed_bell"),nO.zX.EXCLAMATION,"error")}},[t,e,n,a])}(p),g=(0,r.useCallback)((e,t)=>{n2.Y5.triggerAction("goto-layer",{args:{nodeId:e}}),a(t)},[]),y=(0,r.useCallback)(()=>{let t=(n+1)%e.length;g(e[t].guid,t)},[n,e,g]),_=(0,r.useCallback)(()=>{let t=(n-1+e.length)%e.length;g(e[t].guid,t)},[n,g,e]);(0,eC.h)(()=>{e.length&&g(e[0].guid,0)}),(0,r.useEffect)(()=>{if(c.current===e.length)return;let t=(n+e.length)%e.length;g(e[t].guid,t),c.current=e.length},[e,g,n]);let h=(0,r.useCallback)(()=>{i.Egt?.replaceSelection(e.map(e=>e.guid),!0)},[e]),f=e[n];return r.createElement("div",{"data-testid":"design-linter-violations-list"},f?r.createElement(ae,{violation:f,onGetFix:m,onFix:u,onFixAllSelected:E,selectAllNodes:h,multipleViolationsSelected:o,showSelectAllButton:e.length>1}):r.createElement(nW,{shouldDisplay:!0}),r.createElement(nQ,{onNext:y,onPrev:_,title:(0,d.tx)("design_linter.penalty_box.layer_of_layers",{current:n+1,total:e.length}),disabled:e.length<=1,currentIndex:n}))}let aE="16px",ag=(0,nf.jz)(aE);function ay(){return(0,nM.qZ)()?r.createElement(a_,null):null}let a_=r.memo(()=>{let e=(0,eo.J2)(i.Ez5.uiState().showDesignLinter);return(!function(){let e=(0,ek.Xr)(nM.v4),t=(0,nR.pN)(),n=t.data?.libraryVariables,a=t.data?.libraryVariableSets;(0,r.useEffect)(()=>{if("errors"===t.status){e(e=>({...e,status:"error"}));return}if("loaded"!==t.status)return;let r=new AbortController,o=r.signal;return async function(){if(a&&n){for(let e=0;e<a.length;e+=2){if(o.aborted)return;let t=a.slice(e,e+2).map(e=>(0,nx.RI)(e));await Promise.allSettled(t)}e({libraryVariables:n,libraryVariableSetIdToSet:a.reduce((e,t)=>(t.node_id&&(e[t.node_id]=t),e),{}),status:"loaded"})}}(),()=>{r.abort()}},[t.status,a,n,e])}(),e)?r.createElement(ah,null):null});function ah(){let e=ny.ox(),t=function(){let e=(0,eK.GQ)(),t=(0,r.useMemo)(()=>new tf.Mi(e+(0,nf.jz)(aE),(0,nf.jz)(aE)),[e]),[{windowInnerHeight:n}]=(0,nh.A)((0,nv.l)(),300,{equalityFn:ng.c2});return{initialPosition:t,maxHeight:n-2*ag,minHeight:304,minWidth:284,initialHeight:378,initialWidth:284}}();return!function(e){let t=av(),n=(0,r.useRef)();(0,r.useEffect)(()=>{t===nD.N.GROUPS?n.current&&e.setSize(n.current):t===nD.N.VIOLATIONS&&(n.current=new tf.Mi(e.size.x,e.size.y),e.setSize(new tf.Mi(284,212)))},[t,e])}(e),r.createElement(n_._L,{defaultWidth:t.initialWidth,defaultHeight:t.initialHeight,defaultPosition:{left:t.initialPosition.x,top:t.initialPosition.y},maxHeight:t.maxHeight,manager:e,onClose:({source:e})=>{"outside"!==e&&i.Ez5?.uiState().showDesignLinter.set(!1)}},r.createElement(_.vo,null,r.createElement(_.Y9,null,r.createElement(af,null)),r.createElement(_.nB,{padding:0,scrolling:"none"},r.createElement(as,null))))}function af(){let{selectedViolationGroup:e}=(0,v.md)(nM.Bc),{returnToGroupList:t}=nV(),n=nK(),a=e?n[e]??[]:[];return av()===nD.N.GROUPS?r.createElement(n$,null):r.createElement(nj,{title:function(e){let t=(0,nP.r8)();if(!t||!e)return"";let n=t.getRuleById(e);return n?.name??""}(a[0]?.ruleId),onNavigateBack:t})}function av(){let e=(0,v.md)(nM.Bc),t=nK(),{selectedViolationGroup:n,view:a}=e,r=n?t[n]??[]:[];return a!==nD.N.GROUPS&&n&&r.length?nD.N.VIOLATIONS:nD.N.GROUPS}var ab=n(363668),aS=n(987051),aT=n(344076),aN=n(54900),aI=n(902222),aP=n(641072);function aC({children:e}){return r.createElement(aP.G.Provider,{value:{loggerEventName:"design_navigate"}},e)}var ak=n(30637),aA=n(835036),aw=n(809831),aO=n(818),ax=n(436018),aR=n(617453),aM=n(213190),aL=n(336599),aD=n(428467),aK=n(939562),aF=n(239671),aV=n(7860),aU=n(716622),aB=n(243742),aG=n(506599),az=n(697551),aH=n(914905),aW=n(759096),aY=n(270296),a$=n(3360),aX=n(69814),aj=n(316081),aQ=n(215122),aJ=n(331596),aq=n(848661),aZ=n(618056),a0=n(279145),a1=n(291251),a2=n(140593),a4=n(838516),a8=n(543509),a3=n(177131),a5=n(340818),a7=n(358145),a6=n(886653),a9=n(437304),re=n(286640),rt=n(763658),rn=n(738269),ra=n(395281),rr=n(906899),ro=n(798099),rl=n(416095),ri=n(237929),rs=n(444576),rc=n(945020),rd=n(922358),rp=n(602029),rm=n(7959),ru=n(109388),rE=n(463420),rg=n(96796),ry=n(397863),r_=n(617691),rh=n(46481),rf=n(498606),rv=n(498750),rb=n(255942),rS=n(837746);let rT="styles--contextMenu--C-hVT",rN="styles--caret--DZmzh",rI="styles--rowSelectedExpanded--MGvUV",rP="styles--rowSelectedSecondaryLightBlue--S-zy- draggable_list--rowSelectedSecondary--yOI1g raw_components--rowSelectedSecondary---U7Us raw_components--rowSelected--M2Eip";function rC({childLeft:e,childRight:t,deleteSelectedItems:n,forceShowHoverBorder:a,hideStylePreview:o,index:l,inspectStyleSelected:i,isDragging:s,isEditable:c,isRenaming:d,isCollapsed:p=!0,isLastChildOfSelection:m=!1,isFirstChildOfSelection:u=!1,isFolder:E,level:g,name:y,nameRef:_,onContextMenu:h,onCreateFolder:f,onDoubleClick:v,onHoverChange:b,onMouseDown:S,onMouseMove:T,recordingKey:N,rowRef:I,secondaryName:P,selected:C,selectedSecondary:k,stopRenamingItem:A,tooltipData:w}){let O=r.useRef(null),[x,R]=r.useState(y),[M,L]=r.useState(!1),D=(0,eu.GS)(),K=r.useCallback(e=>{if(e){let t=ru.findDOMNode(e);t&&t.select()}},[]);r.useEffect(()=>{R(y)},[y]);let F=r.useCallback(e=>{""===e.trim()?(A(l,y),R(y)):A(l,e)},[l,y,A]),V=(0,n0.AF)((0,n0.Pt)(N,"text-input"),"change",r.useCallback(e=>{R(e.currentTarget.value)},[R])),U=(0,n0.v_)((0,n0.Pt)(N,"text-input"),"keydown",e=>{e.keyCode===rv.Uz.ESCAPE?(A(l,y),R(y)):e.keyCode===rv.Uz.ENTER&&F(e.currentTarget.value)},{recordMetadata:e=>({inputValue:e.currentTarget.value}),playbackMetadata:e=>({currentTarget:{value:e.inputValue}})}),B=(0,n0.v_)(N,"keydown",e=>{c&&!d&&(e.keyCode===rv.Uz.BACKSPACE||e.keyCode===rv.Uz.DELETE)?n():c&&!d&&e.keyCode===rv.Uz.G&&(0,rv.Fo)(e)?(f(),e.preventDefault()):!d&&e.nativeEvent&&n2.Y5.forwardKeyboardEvent(e.nativeEvent)}),G=r.useCallback(()=>{F(x)},[F,x]),z=(0,n0.rf)(N,"contextmenu",e=>{h(e)}),H=(0,n0.rf)(N,"mousemove",e=>{T(e)},{recordMetadata:e=>({bounds:e.currentTarget.getBoundingClientRect(),pageX:e.pageX,pageY:e.pageY}),playbackMetadata:e=>({currentTarget:{getBoundingClientRect:()=>e.bounds},pageX:e.pageX,pageY:e.pageY})}),W=(0,n0.rf)(N,"mousedown",e=>{S(e),o()}),Y=(0,n0.rf)(N,"mouseenter",r.useCallback(()=>{L(!0),b?.(!0)},[L,b])),$=r.useCallback(()=>{L(!1),b?.(!1)},[L,b]),X=(0,n0.rf)(N,"dblclick",r.useCallback(e=>{v(e)},[v])),j=Math.min((g-1)*3,18),Q=rS.jNX-4-j,J=Q-(D?7:5),q=M&&!d||i?J:Q,Z=C||k,ee=eI()({[rI]:!p&&Z,"styles--folderSecondarySelected--SL0JY":k||C&&!u,[rP]:k&&!D}),et=eI()({[rP]:Z,[rI]:!m&&Z}),en=eI()("styles--rowWithBorder--bphZ-",{[ee]:E,[et]:!E,"styles--rowWithHover--RWNMH":!Z&&(a||M&&!s)}),ea=r.createElement("div",{className:d?"styles--rowContentsRenaming--oDTtO styles--rowContents--37JBy":"styles--rowContents--37JBy",key:y,style:D?{width:"100%"}:{gridColumnEnd:`span ${q}`}},d?r.createElement(rm.ks,{autoCapitalize:"off",autoCorrect:"off",autoFocus:!0,className:"styles--input--LbjR0",onBlur:G,onChange:V,onKeyDown:U,ref:K,spellCheck:!1,value:x}):r.createElement(r.Fragment,null,r.createElement("div",{className:"styles--name--KWZ8d ellipsis--ellipsis--Tjyfa",ref:_,...w},y),P&&r.createElement("div",{className:"styles--textStyle--DiUv4"},P)));return r.createElement(rp.e,{className:en,dragging:s,hideGrabber:!0,onContextMenu:z,onKeyDown:B,onMouseDown:W,onMouseEnter:Y,onMouseLeave:$,onMouseMove:H,onDoubleClick:X,ref:(0,rb.A)(O,I),selected:C,selectedSecondary:!1,tabIndex:0},j>0&&r.createElement("span",{style:{gridColumnEnd:`span ${j}`}}),r.createElement("div",{className:"styles--childLeftContainer--Hu61K",style:D?{gridColumnEnd:`span ${q}`}:void 0},e,D&&ea),!D&&ea,t)}var rk=n(949207),rA=n(432023),rw=n(501191),rO=n(660164);function rx({deleteSelectedItems:e,folder:t,folderNameToNestUnder:n,hideStylePreview:a,index:l,isCollapsed:i,isDragging:s,isEditable:c,isRenaming:p,isTemporarilyExpanded:m,isFirstChildOfSelection:u,level:E,onContextMenu:g,onCreateFolder:y,onMouseDown:_,onMouseMove:h,onRenameItem:f,recordingKey:v,selected:b,selectedSecondary:S,stopRenamingItem:T,temporarilyExpandFolder:N,toggleFolder:I}){let P=(0,o.wA)(),[C,k]=r.useState(!1),A=r.useRef(null),w=r.useRef(null),O=C&&!p&&c,x=r.useCallback(()=>{I(!i)},[i,I]),R=r.useCallback(e=>{e.target!==w.current&&t.styleTypeSection&&f(t.name,!1,t.styleTypeSection)},[t.name,t.styleTypeSection,f]);r.useEffect(()=>{if(C&&s&&i){let e=setTimeout(()=>{N(t.name)},1e3);return()=>clearTimeout(e)}},[C,s,i,N,t]);let M=r.useCallback(()=>{let e=(0,r_.Zk)(t.styleTypeSection),n=A.current?.getBoundingClientRect();e&&n&&P(rr.Zs({rowLeft:n.left,rowTop:n.top,styleType:t.styleTypeSection,styleNameInputPrefix:`${t.name}/`,inheritStyleKeyField:e}))},[A,t.name,t.styleTypeSection,P]);return r.createElement(rC,{deleteSelectedItems:e,forceShowHoverBorder:n===t.name,hideStylePreview:a,index:l,isDragging:s,isEditable:c,isRenaming:p,isCollapsed:i,isFolder:!0,isFirstChildOfSelection:u,level:E,name:(0,ri.kH)(t.name),onContextMenu:g,onCreateFolder:y,onDoubleClick:R,onHoverChange:k,onMouseDown:_,onMouseMove:h,onRenameItem:f,recordingKey:v,selected:b,selectedSecondary:S,stopRenamingItem:T,rowRef:e=>{e&&(A.current=ru.findDOMNode(e))},childLeft:r.createElement(nn.E,{onClick:x,className:"styles--caretContainer--4-dqw",ref:w},r.createElement(rh.U,{svg:i&&!m?rA.A:rk.A,className:rN},i&&!m?r.createElement(rE.k,{className:rN}):r.createElement(rg.O,{className:rN}))),childRight:O&&r.createElement(rm.$4,null,r.createElement(eS.K,{recordingKey:n0.Pt(v,"addButton"),"aria-label":(0,d.t)("design_systems.styles.tooltips.create"),onClick:M,htmlAttributes:{"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.styles.tooltips.create")}},r.createElement(rh.U,{svg:rw.A,fallbackSvg:rO.A,children:r.createElement(ry.x,null)})))})}var rR=n(196367),rM=n(221768),rL=n(378905),rD=n(44892),rK=n(137906),rF=n(720384),rV=n(162502);function rU({deleteSelectedItems:e,hideStylePreview:t,index:n,isDragging:a,isEditable:l,isRenaming:i,isLastChildOfSelection:s,level:c,onContextMenu:p,onCreateFolder:m,onInspectStyle:u,onMouseDown:E,onMouseMove:g,onRenameItem:y,recordingKey:_,selected:h,selectedSecondary:f,stopRenamingItem:v,dsStyle:b,stylePreviewShown:S,updateContextMenuStyleRef:T,updateSelection:N,updateFocusRowRef:I}){let[P,C]=r.useState(!1),k=(0,o.wA)(),A=r.useRef(null),w=r.useRef(null),O=(0,eu.GS)(),x=r.useCallback(()=>{l&&y(b.node_id,!0,b.style_type)},[y,b.node_id,b.style_type,l]),R=S.isShown&&!S.isCreating&&S.style.node_id===b.node_id&&(0,rL.EF)(S.style,b),M=P&&!i||R,L=r.useCallback(function(){let e=w.current;if(e){let t=e.getBoundingClientRect();R?k(rr.sw()):(k(rr.rk({style:b,rowTop:t.top,rowLeft:t.left})),u(b),N({type:b.style_type,folderNames:new Set,styleIds:new Set(b.node_id)}))}k(eZ.XE())},[k,u,N,b,R]),D=r.useCallback(e=>{(2===e.button||e.ctrlKey)&&T(w.current),E(e),R&&L()},[L,E,R,T]),K=A.current,F=!!K&&K.offsetWidth<K.scrollWidth,V=r.useMemo(()=>!a&&b.description&&F?{"data-tooltip-type":rf.Ib.SPECIAL,"data-tooltip":rF.Z,"data-tooltip-style-name":(0,ri.kH)(b.name),"data-tooltip-style-description":b.description,"data-tooltip-max-width":rS.jNX*(0,nf.hG)(rS.dGl)}:null,[F,a,b.name,b.description]),U="TEXT"===b.style_type&&b.meta?.style_thumbnail?b.meta.style_thumbnail:null;return r.createElement(rC,{deleteSelectedItems:e,hideStylePreview:t,index:n,inspectStyleSelected:R,isDragging:a,isEditable:l,isRenaming:i,isFolder:!1,isLastChildOfSelection:s,level:c,name:(0,ri.kH)(b.name),nameRef:A,onContextMenu:p,onCreateFolder:m,onDoubleClick:x,onHoverChange:C,onMouseDown:D,onMouseMove:g,onRenameItem:y,recordingKey:_,rowRef:e=>{if(e){let t=ru.findDOMNode(e);I&&I(t),w.current=t}},secondaryName:U&&(0,rD.P$)(U),selected:h,selectedSecondary:f,stopRenamingItem:v,tooltipData:V,childLeft:r.createElement(r.Fragment,null,r.createElement(rK.zi,{dsStyle:b,disableTooltip:!0}),h&&"FILL"===b.style_type&&r.createElement("div",{className:"styles--selectedRing--UniEc"})),childRight:M&&r.createElement(rm.$4,null,r.createElement("div",{style:{gridColumnEnd:"span 1"}}),O?r.createElement(rR.d,{recordingKey:n0.Pt(_,"customButton"),toggled:R,onClick:L,htmlAttributes:{"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style"),onMouseDown:ro.dG},children:r.createElement(rh.U,{svg:rV.A},r.createElement(rM.A,null)),"aria-label":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style")}):r.createElement(rm.YW,{className:h?"styles--showOnSelectedRowHover--Lcf7e styles--showOnRowHover--OUqRT":"styles--showOnRowHover--OUqRT",recordingKey:n0.Pt(_,"customButton"),"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":l?(0,d.t)("design_systems.styles.edit_style"):(0,d.t)("design_systems.styles.view_style"),selected:R,onMouseDown:ro.dG,onClick:L},r.createElement(rh.U,{svg:rV.A},r.createElement(rM.A,null))))})}function rB({styleType:e,children:t}){let n=!(0,V.p8)("isReadOnly");return r.createElement("div",{className:"styles--styleTypeSection--jPjTq component_tiles--section--qMua7"},n?r.createElement(rG,{styleType:e,recordingKey:`style-section-header-${e}`}):r.createElement("div",{className:"styles--styleTypeSectionHeader--224lA component_tiles--sectionHeader--eEC6d raw_components--panelTitle--VAQQA"},(0,rl.QT)(e)),t)}function rG({styleType:e,recordingKey:t}){let[n,a]=r.useState(!1),l=(0,o.wA)(),i=r.useRef(null),s=r.useCallback(()=>{let t=(0,r_.Zk)(e),n=i.current?.getBoundingClientRect();t&&n&&l(rr.Zs({rowLeft:n.left,rowTop:n.top,styleType:e,inheritStyleKeyField:t}))},[i,e,l]);return r.createElement("div",{className:"styles--styleTypeSectionRow--wVTIO",onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),ref:i},r.createElement(rm.JU,{className:"styles--styleTypeSectionRowLabel--PrKm-"},(0,rl.QT)(e)),r.createElement("div",{style:{visibility:n?"visible":"hidden"}},r.createElement(eS.K,{recordingKey:n0.Pt(t,"addButton"),"aria-label":(0,d.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,rl.XV)(e).toLowerCase()}),onClick:s,htmlAttributes:{"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.styles.tooltips.create_style_from_section",{kind:(0,rl.XV)(e).toLowerCase()})}},r.createElement(rh.U,{svg:rw.A,fallbackSvg:rO.A,children:r.createElement(ry.x,null)}))))}rB.displayName="StyleTypeSection";var rz=n(268537),rH=n(318812),rW=n(333370);let rY=rz.ms,r$=rz.c$,rX=rz.wv,rj="styles-by-type-context-menu",rQ=.75*(0,nf.hG)(rS.uj0);function rJ({styleRowRef:e,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s,styleType:c}){let d=(0,rH.Um)(),p=(0,o.d4)(e=>e.library.localStyleSelection),m=r.useMemo(()=>p&&p.type===c&&d?.type===rj?(0,rW.QA)(p,d.data.uiList):[],[p,d,c]),u=r.useMemo(()=>(0,rW.Ug)(m).map(e=>e.node_id),[m]),E=u.length;return d&&u.length?r.createElement(rq,{styleRowRef:e,selectedItems:m,numStyles:E,dropdownShown:d,onEditStyle:t,onRenameItem:n,onCreateFolder:a,onDeleteItems:l,onCutItems:i,onPasteItems:s}):r.createElement("div",null)}function rq({styleRowRef:e,selectedItems:t,numStyles:n,dropdownShown:a,onEditStyle:l,onRenameItem:s,onCreateFolder:c,onDeleteItems:p,onCutItems:m,onPasteItems:u}){let E=(0,o.wA)();r.useEffect(()=>(i.glU.computePastableStyleCount(),()=>{i.glU.clearPastableStyleCount()}),[]);let g=(0,o.d4)(e=>e.mirror.appModel.pastableStyleCount),y=!!U.q5()?.canEdit,_=r.useCallback(()=>{if(!t.length||t[0].type!==tU.PW.STYLE)return;let n=t[0];if(e){let t=e.getBoundingClientRect();E(rr.rk({style:n,rowTop:t.top,rowLeft:t.left})),E(eZ.XE())}l(n)},[E,t,l,e]),h=r.useCallback(()=>{if(!t.length||t[0].type===tU.PW.STYLE)return;let e=t[0];s(e.name,!1,e.styleTypeSection)},[s,t]);if(-1===g)return r.createElement("div",null);if(!y)return n>1?r.createElement("div",null):r.createElement(rY,{style:a.data.position,className:rT},r.createElement(r$,{recordingKey:"edit-style-option",onClick:_},(0,d.tx)("design_systems.styles.view_style")));let f=1===n&&(t[0].type===tU.PW.STYLE?r.createElement(r$,{recordingKey:"edit-style-option",onClick:_},(0,d.tx)("design_systems.styles.edit_style")):r.createElement(r$,{recordingKey:"rename-folder-option",onClick:h},(0,d.tx)("design_systems.styles.rename_folder")));return r.createElement(rY,{style:a.data.position,className:rT},r.createElement(r$,{recordingKey:"create-folder-option",onClick:c},(0,d.tx)("design_systems.styles.add_new_folder")),f,r.createElement(r$,{recordingKey:"delete-style-option",onClick:p},(0,d.tx)("design_systems.styles.delete_styles",{numStyles:n})),r.createElement(rX,null),r.createElement(r$,{recordingKey:"cut-style-option",onClick:m},(0,d.tx)("design_systems.styles.cut_styles",{numStyles:n})),!!g&&r.createElement(r$,{recordingKey:"paste-style-option",onClick:u},(0,d.tx)("design_systems.styles.paste_styles",{numStyles:g})))}var rZ=n(927457),r0=n(710752),r1=n(582288),r2=n(884909),r4=n(304173),r8=n(405206),r3=n(298543),r5=n(184027),r7=n(608974),r6=n(257812),r9=n(319431),oe=n(914110);let ot="local-style-creation-dropdown";function on(){let e=(0,o.wA)(),t=(0,r.useContext)(r5.lk),n=!(0,V.p8)("isReadOnly"),a=r.useRef(null),l=r.useRef(null),i=a.current,s=(0,rH.Um)(),c=s?.type===ot,p=s?.data?.targetRect,m="localStyleHeader",u=0===(0,aW.Bs)().length,E=(0,o.d4)(e=>e.stylePreviewShown.isShown&&e.stylePreviewShown.isCreating),g=r.useMemo(()=>p||(c&&i?i.getBoundingClientRect():null),[p,i,c]),y=()=>{e(rn.oB())},_=()=>{e(rn.j7({type:ot}))},h=t=>{t.stopPropagation(),e(rr.YG());let n=a.current;c?y():n&&((0,eP.sx)("editor-local-styles-dropdown-show"),_())},f=e=>{y();let n=(0,r_.Zk)(e),a=l.current?.getBoundingClientRect();n&&a&&t({styleType:e,inheritStyleKeyField:n,rowLeft:a.left,rowTop:a.top})},v=u&&!c&&!E;return r.createElement(rm.fI,{className:v?"styles--panelHeaderRowFaded--pfgKz styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO draggable_list--panelHeaderRowFaded--kETRR":"styles--panelHeaderRow--Kxqgo styles--styleTypeSectionRow--wVTIO",ref:l},r.createElement(rm.xZ,{className:"styles--panelTitleText--v7gXm draggable_list--panelTitleText--SwKez",onMouseDown:e=>v&&h(e),onClick:e=>e.stopPropagation()},(0,d.tx)("design_systems.styles.local_styles")),n&&r.createElement(r.Fragment,null,r.createElement(rm.K0,{ref:a,onMouseDown:h,onClick:e=>e.stopPropagation(),className:c?"styles--stylesHeaderButtonHighlight--WTeWy raw_components--iconButtonSelected--bJibL raw_components--_iconButton---ybo6":"styles--stylesHeaderButton--jhpA5 draggable_list--addButton--D0q--","data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("design_systems.create_style.create_style"),recordingKey:n0.Pt(m,"addButton")},r.createElement(rh.U,{svg:rw.A,fallbackSvg:rO.A},r.createElement(rZ.e,null))),c&&g&&r.createElement(r3.Cf,{targetRect:g,minWidth:128,disableDropdownScrollContainer:!0,propagateCloseClick:!0},rl.og.map(e=>{let{icon:t,label:n}=function(e){switch(e){case"TEXT":return{icon:r.createElement(rh.U,{svg:oe.A},r.createElement(r0.e,null)),label:(0,d.t)("design_systems.styles.dropdown.text")};case"FILL":return{icon:r.createElement(rh.U,{svg:r6.A},r.createElement(r1.G,null)),label:(0,d.t)("design_systems.styles.dropdown.fill")};case"GRID":return{icon:r.createElement(rh.U,{svg:r9.A},r.createElement(r2.E,null)),label:(0,d.t)("design_systems.styles.dropdown.grid")};case"EFFECT":return{icon:r.createElement(rh.U,{svg:r7.A},r.createElement(r4.n,null)),label:(0,d.t)("design_systems.styles.dropdown.effect")};default:throw(0,a2.j)(e),Error(`Invalid style type: ${e}`)}}(e),a=t=>{t.stopPropagation(),f(e)};return r.createElement(rz.c$,{key:e,className:"styles--createStyleDropdownRow--7iCXQ",onClick:a,onPointerUp:a,recordingKey:n0.Pt(m,`dropdown-option-${e}`)},r.createElement(r8.Nu,null,t),n)}))))}let oa="collapsed-style-folders";function or({scrollContainer:e,recordingKey:t}){let n=(0,aW.Bs)(),a=(0,V.p8)("isReadOnly");return 0===n.length&&a?null:r.createElement(rt.k,{name:"local_styles_panel"},r.createElement(rm.Zk,null,r.createElement(oo,{scrollContainer:e,recordingKey:t})))}function oo({scrollContainer:e,recordingKey:t}){let n=(0,o.wA)(),a=(0,o.d4)(e=>e.stylePreviewShown),l=(0,o.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),s=(0,o.d4)(e=>e.mirror.appModel.currentTool),c=r.useRef(null),d=(0,aW.Bs)(),p=(0,o.d4)(e=>e.library.localStyleSelection),[m,u]=r.useState(null),[E,g]=r.useState(null),y=r.useRef(null),[_,h]=r.useState(!1),f=l===i.m1T.GRADIENT||l===i.m1T.RASTER||s===i.NLJ.DROPPER_COLOR;r.useEffect(()=>{let e=()=>{!f&&(n(ra.Bn(null)),a.isShown&&(n(rr.sw()),i.glU.selectStyle(a3.n3.INVALID,a3.IA.INVALID)))},t=(0,ro.ft)();return t?window.addEventListener("pointerdown",e):window.addEventListener("mousedown",e),()=>{t?window.removeEventListener("pointerdown",e):window.removeEventListener("mousedown",e)}},[n,a.isShown,f]);let{stylesByType:v,foldersAndStylesByType:b}=r.useMemo(()=>{let e=(0,rl.Kw)(d),t=new Map;return rl.og.map(n=>{let a=e.get(n);if(a){(0,rl.LX)(a);let e=(0,rW.lM)(a,n),r=(0,rW.l0)(e);t.set(n,r)}}),{stylesByType:e,foldersAndStylesByType:t}},[d]),S=r.useCallback(e=>{(0,a2.KF)(null!=e.content_hash,"style does not have a hash"),i.glU.selectStyleByGuid(e.node_id),n(ra.ay({isRenaming:!1})),(0,eP.sx)("Style Inspected",{styleType:e.style_type,from:"styleListClick"})},[n]),T=r.useCallback((e,t,n)=>{u(t?e:null),g(t?null:{name:e,styleTypeSection:n})},[]),N=r.useCallback(e=>{if(!e){n(ra.Bn(null));return}let t=new Set;e.styleIds.forEach(n=>{let a=d.find(e=>e.type===tU.PW.STYLE&&e.node_id===n);if(!a)return;let r=(0,ri.In)(a.name);e.folderNames.has(r)||t.add(n)});let a={type:e.type,folderNames:e.folderNames,styleIds:t};n(ra.Bn(a))},[n,d]),I=r.useCallback((e,t,n)=>{if(!p)return;let a=e[t],r=(e,t)=>{let a=(0,ri.ke)(e.name),r=null!=t?t:a.length-1;a[r]=n;let o=(0,rW.Pc)(a.join("/"));a5.l7.user("rename-style",()=>i.glU.renameNode(e.node_id,o))};if(a.name!==n){if(a.type===tU.PW.STYLE)r(a);else{(0,rW.mx)(t,e).forEach(t=>{let n=e[t];n.type===tU.PW.STYLE&&r(n,a.level-1)});let o=new Set(p.folderNames);o.delete(a.name);let l=(0,ri.In)(a.name)+"/"+n;o.add(l),N({type:p.type,folderNames:o,styleIds:p.styleIds})}}n2.Y5.triggerAction("commit"),u(null),g(null)},[p,N]),P=r.useCallback((e,t)=>{t.preventDefault(),t.stopPropagation(),n(rn.j7({type:rj,data:{uiList:e,position:{top:t.clientY,left:Math.min(t.clientX,window.innerWidth-rQ)}}}))},[n]),C=r.useCallback(e=>{y.current=e},[]),k=r.useCallback(()=>{h(!0)},[]),A=r.useCallback(()=>{h(!1)},[]);return r.createElement("div",{className:"styles--localStylesPanel--T4Gqs",ref:c},r.createElement(on,null),rl.og.map(n=>{let a=v.get(n);if(!a)return;let o=b.get(n);if(o)return r.createElement(ol,{key:n,recordingKey:n0.Pt(t,`style-section-${n}`),styleType:n,storedStyleList:a,styleList:o,updateSelection:N,isDragging:_,onDragStart:k,onDragEnd:A,onInspectStyle:S,onContextMenu:P,updateContextMenuStyleRef:C,renamingStyleID:m,renamingFolder:E,onRenameItem:T,stopRenamingItem:I,styleRowRef:y.current,onEditStyle:S,scrollContainer:e})}))}function ol({styleType:e,storedStyleList:t,styleList:n,renamingStyleID:a,renamingFolder:l,onRenameItem:s,stopRenamingItem:c,onDragStart:p,onDragEnd:m,onInspectStyle:u,onContextMenu:E,updateContextMenuStyleRef:g,updateSelection:y,styleRowRef:_,scrollContainer:h,recordingKey:f}){let v=(0,U.q5)(),b=!(0,V.p8)("isReadOnly"),S=(0,o.wA)(),T=(0,o.d4)(e=>e.stylePreviewShown),N=(0,eu.GS)(),I=(0,o.d4)(t=>(0,rs.i4)(t,e)),P=(0,o.d4)(t=>(0,rs.A7)(t,e,n)),[C,k]=r.useState(()=>{if(re.x4&&v){let t=JSON.parse(re.x4.getItem(oa)||"{}");if(v.key in t){let n=t[v.key];if(e in n)return new Set(n[e])}else t[v.key]={},re.x4.setItem(oa,JSON.stringify(t))}return new Set(n.filter(e=>"STYLE_FOLDER"===e.type).map(e=>e.name))}),[A,w]=r.useState([]),[O,x]=r.useState(null),[R,M]=r.useState(null),L=r.useMemo(()=>(0,a4.s)(()=>{S(nx.GT({styleType:e}))},200),[S,e]);r.useEffect(()=>{L()},[L,n]);let D=(0,a7.ZC)(C);r.useEffect(()=>{if(!D||!re.x4||!v||(0,a9._f)(D,C))return;let t=JSON.parse(re.x4.getItem(oa)||"{}"),n=t[v.key];n&&(n[e]=[...C],re.x4.setItem(oa,JSON.stringify(t)))},[C,v,D,e]);let K=r.useCallback(e=>!!e&&"STYLE_FOLDER"===e.type,[]),F=r.useCallback((e,t)=>{let a=new Set(e),r=[];n.forEach((e,t)=>{if(a.has(e)&&(r.push(t),"STYLE_FOLDER"===e.type)){let e=(0,rW.mx)(t,n);r.push(...e)}});let o=new Set(r),l=t?n.indexOf(t):n.length,i=[...(0,a8.y1)(l).filter(e=>!o.has(e)),...r,...(0,a8.y1)(l,n.length).filter(e=>!o.has(e))],s=new Map;return i.forEach((e,t)=>{e!==t&&s.set(e,t)}),s},[n]),B=r.useCallback(()=>{T.isShown&&(S(rr.sw()),S(eZ.XE()),i.glU.selectStyle(a3.n3.INVALID,a3.IA.INVALID))},[S,T.isShown]),G=r.useMemo(()=>{if(!O)return null;if("in"===O.type){let e=n[O.index];return e?{folderNameToNestUnder:e.name,dividerStyles:{display:"none"}}:null}if(null==O.index||null==R||!I)return null;let e=(0,rW.QA)(I,n),t=e[0],a=null,r=null;if(0===O.index?r=n[O.index]:O.index===n.length?a=n[O.index-1]:(a=n[O.index-1],r=n[O.index]),a?.type==="STYLE_FOLDER"&&C.has(a.name)&&-1===A.indexOf(a.name))return{folderNameToNestUnder:a.name,dividerStyles:{display:"none"}};if(a?.type===tU.PW.STYLE){let e=(0,ri.In)(a.name).split("/");for(let n=0;n<e.length;n++){let a=e.slice(0,n+1).join("/");if(C.has(a)&&-1===A.indexOf(a)){if("STYLE_FOLDER"!==t.type)return{folderNameToNestUnder:a,dividerStyles:{display:"none"}};return{folderNameToNestUnder:(0,ri.In)(a),dividerStyles:{marginLeft:24*Math.min((0,ri.ke)(a).length,8)-8}}}}}let o=0,l=null,i=a?(0,rW.rM)(a):0,s=r?(0,rW.rM)(r):0;if(i<=s)o=s,l=a?a.type===tU.PW.STYLE?(0,ri.In)(a.name):a.name:"";else if((0,a2.KF)(null!=a,"Dragging after an item that doesn't exist"),t.type===tU.PW.STYLE||R>=.5)o=i,l=(0,ri.In)(a.name);else{let e=Math.floor(R/.5*(0,rW.rM)(a));e=Math.max(s-1,e),l=(0,ri.ke)((0,ri.In)(a.name)).slice(0,e).join("/"),o=e+1}let c={marginLeft:24*Math.min(o,8)-8};return a&&e.includes(a)||!(0,rW.Md)(a,t,r)?{folderNameToNestUnder:null,dividerStyles:c}:{folderNameToNestUnder:l,dividerStyles:c}},[C,R,I,O,n,A]),z=r.useCallback((a,r,o,l)=>{if(!t||!r&&!o||!G)return;let i=G.folderNameToNestUnder;if(null===i)return;let s=[],c=[];a.forEach(e=>{(0,rW.Md)(r,e,o,i)&&("STYLE_FOLDER"===e.type?c.push(e):s.push(e))});let d=s.concat(c);if(!d.length)return;let p=a5.l7.user("reorder-styles",()=>(0,rW.VB)(d,r,o,i,n,t,l||!1)),m=new Set,u=new Set;d.forEach(e=>{let t=(0,rW.t_)(e),n=p?.get(t);n&&("STYLE_FOLDER"===e.type?m.add(n):u.add(t))}),y({type:e,folderNames:m,styleIds:u});let E=new Set;return C.forEach(e=>{if(i.startsWith(e))return;let t=p?.get(e);t?E.add(t):E.add(e)}),k(E),B(),l||n2.Y5.triggerAction("commit"),F(d,o)},[y,C,G,F,B,t,n,e]),H=r.useCallback((e,t)=>{if("STYLE_FOLDER"!==t.type)return;let a=n.indexOf(t),r=(0,rW.dm)(t).filter(e=>(0,ri.In)(e.name)===t.name);if(!r.length)return z(e,t,n[a+1]);{let t=r[r.length-1],a=n.indexOf(t);return z(e,t,n[a+1])}},[z,n]),W=(0,a6.xx)((e,t)=>{let a=new Map,r=t.map(e=>e.type===tU.PW.STYLE?e.node_id:e.name);return e.forEach(e=>{let o=r.indexOf(e);-1!==o&&(0,rW.mx)(o,n).forEach(e=>{let n=t[e],r="STYLE_FOLDER"===n.type?n.name:n.node_id,o=a.get(r);o||(o=0),a.set(r,o+1)})}),a}),Y=r.useCallback(()=>{if(!I)return;let t=(0,rW.QA)(I,n);if(0===t.length)return;let a=t[0],r=n.indexOf(a),o=r,l=r+1;if(a.type===tU.PW.STYLE&&n[l]&&n[l].type===tU.PW.STYLE){let e=(0,rW.rM)(a);for(let t=r+1;t<n.length;t++){let a=n[t];if("STYLE_FOLDER"===a.type&&a.level===e||(0,rW.rM)(a)<e){o=t-1,l=t;break}t===n.length-1&&(o=t,l=t+1)}}z(t,n[o],n[l],!0);let c=(0,ri.In)(a.name),p=N?(0,d.t)("design_systems.create_style.new_folder"):(0,d.t)("design_systems.create_style.untitled_folder");c&&(p=`${c}/${p}`);let m=(e,t)=>{if(e.type===tU.PW.STYLE){let n=p+"/"+t+(0,ri.kH)(e.name);a5.l7.user("rename-style",()=>{i.glU.renameNode(e.node_id,n)})}else{let n=t+(0,ri.kH)(e.name)+"/";e.styles.forEach(e=>{m(e,n)}),e.subfolders.forEach(e=>{m(e,n)})}};t.forEach(e=>{m(e,"")}),y({type:e,folderNames:new Set([p]),styleIds:new Set}),s(p,!1,e)},[y,z,N,I,s,n,e]),$=r.useCallback((e,t)=>{let a=n[e];"STYLE_FOLDER"===a.type&&k(e=>{let n=new Set(e);return t?n.add(a.name):n.delete(a.name),n})},[n]),X=r.useCallback((e,t)=>{k(a=>{let r=new Set(a),o=n[e];if("STYLE_FOLDER"===o.type){let e=(0,ri.In)(o.name),n=""===e?t:e+"/"+t;C.has(o.name)&&(C.delete(o.name),C.add(n)),(0,rW.KU)(o).forEach(e=>{if(C.has(e.name)){let t=e.name.replace(o.name,"");C.add(n+t),C.delete(e.name)}})}return r}),c(n,e,t)},[c,C,n]),j=r.useCallback(e=>{E(n,e)},[E,n]),Q=r.useCallback((e,t,n)=>{let a=t>.5?1:Math.round(1e3*t)/1e3;x({index:e,type:n?"in":"before"}),M(a)},[]),J=r.useCallback(()=>{k(e=>a5.l7.user("delete-styles",()=>{let t=new Set(e);return(I?(0,rW.QA)(I,n):[]).forEach(e=>{"STYLE_FOLDER"===e.type?((0,rW.a2)(e,v?.key||null),C.delete(e.name),(0,rW.KU)(e).forEach(e=>C.delete(e.name))):(0,rW.Nr)(e,v?.key||null)}),t})),n2.Y5.triggerAction("commit"),T.isShown&&(S(rr.sw()),S(eZ.XE()),i.glU.selectStyle(a3.n3.INVALID,a3.IA.INVALID)),y(null)},[T.isShown,y,I,n,v?.key,C,S]),q=r.useMemo(()=>{let e=I?(0,rW.QA)(I,n):[];return(0,rW.Ug)(e).map(e=>e.node_id)},[I,n]),Z=r.useCallback(()=>{a5.l7.user("cut-styles",()=>i.glU.cutStyles(q))},[q]),ee=r.useCallback((e,t)=>{t===rc.zy.PASTE?a5.l7.user("paste-styles",()=>i.glU.pasteStyles()):e.shouldPropagate=!0},[]);r.useEffect(()=>{if(!I)return;let e=e=>{e.target&&("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)||Z()};return document.addEventListener("cut",e),()=>{document.removeEventListener("cut",e)}},[Z,I]);let et=r.useCallback(()=>{i.glU.pasteStyles()},[]),en=r.useCallback(e=>{w(t=>[...t,e])},[]),ea=r.useCallback(()=>{p()},[p]),er=n0.rf(f,"ondragend",r.useCallback(()=>{x(null),M(null),w([]),m()},[m])),eo=(0,a7.ZC)(I);r.useEffect(()=>{eo!==I&&I&&k(e=>{let n=new Set(e);for(let e of I.styleIds.values()){let a=t.find(t=>t.node_id===e);if(!a)continue;let r=(0,ri.ke)(a.name);for(let e=0;e<r.length;e++){let t=r.slice(0,e).join("/");n.delete(t)}}return n})},[I,eo,t]);let el=r.useRef(null),ei=r.useCallback(e=>{el.current=e},[el]),es=r.useMemo(()=>I?(0,rW.h$)(I,n):[],[I,n]),ec=r.useMemo(()=>P?(0,rW.h$)(P,n):[],[P,n]),ed=r.useMemo(()=>[...es,...ec].sort((e,t)=>e-t),[es,ec]),ep=r.useCallback((e,t,o,i,c,d)=>{let p="STYLE_FOLDER"===e.type?e.name:e.node_id,m=!1,E=!1;for(let t of A)if("STYLE_FOLDER"===e.type){if(e.name===t){E=!0;break}e.name.startsWith(t)&&(m=!0)}else if((0,ri.In)(e.name)===t){m=!0;break}if(!E&&!m&&W(C,n).has(p))return null;let _=ed&&ed[ed.length-1]===t,h=ed&&ed[0]===t;if(e.type===tU.PW.STYLE){let n=(0,rW.rM)(e),l=null!=a&&a===e.node_id;return r.createElement(rU,{hideStylePreview:B,recordingKey:`style-row-${t}`,index:t,key:e.node_id,isDragging:i,dsStyle:e,selected:o,selectedSecondary:P?.styleIds.has(e.node_id)||!1,level:n,stylePreviewShown:T,onContextMenu:j,updateContextMenuStyleRef:g,updateFocusRowRef:o?ei:null,onMouseDown:c,onMouseMove:d,onInspectStyle:u,updateSelection:y,isEditable:b,deleteSelectedItems:J,isRenaming:l,onRenameItem:s,stopRenamingItem:X,onCreateFolder:Y,isLastChildOfSelection:_})}{let n=null!=l&&l.name===e.name&&l.styleTypeSection===e.styleTypeSection,a=G?.folderNameToNestUnder||null;return r.createElement(rx,{recordingKey:`folder-section-${e.styleTypeSection}-row-${t}`,key:t,index:t,isDragging:i,folder:e,selected:o,selectedSecondary:P?.folderNames.has(e.name)||!1,isCollapsed:C.has(e.name),temporarilyExpandFolder:en,isTemporarilyExpanded:E,isRenaming:n,folderNameToNestUnder:a,onRenameItem:s,stopRenamingItem:X,level:e.level,toggleFolder:e=>$(t,e),onContextMenu:j,onCreateFolder:Y,onMouseDown:c,onMouseMove:d,isEditable:b,deleteSelectedItems:J,hideStylePreview:B,isFirstChildOfSelection:h})}},[y,ed,C,J,G?.folderNameToNestUnder,W,B,j,Y,u,s,l,a,P?.folderNames,P?.styleIds,X,n,T,en,A,$,g,b,ei]),em=r.useCallback(t=>{let a=new Set,r=new Set;t.forEach(e=>{let t=n[e];"STYLE_FOLDER"===t.type?a.add(t.name):r.add(t.node_id)}),y({type:e,folderNames:a,styleIds:r})},[y,n,e]),eE=r.useRef(),eg=r.useRef();return r.useEffect(()=>{eE.current&&es.length?(eE.current(),el.current&&!el.current.contains(document.activeElement)&&el.current.focus()):eg.current&&!es.length&&(eg.current(),el.current=null)},[eE,es,el]),r.createElement(rd.vL,{name:"StyleDraggableList",handleClipboard:ee,focusFunctionRef:eE,blurFunctionRef:eg},r.createElement(rB,{styleType:e},r.createElement(oi,{recordingKey:"style-draggable-list",listItems:n,onInsertItemsIn:H,canInsertItemsIn:K,onInsertItemsBetweenValues:z,onDrag:Q,onDragStart:ea,onDragEnd:er,insertDividerStyle:G?.dividerStyles,selectedIndices:es,updateSelection:em,renderListItem:ep,scrollContainer:h,isDragDisabled:!b}),r.createElement(rJ,{styleRowRef:_,onDeleteItems:J,onCutItems:Z,onPasteItems:et,onRenameItem:s,onEditStyle:u,onCreateFolder:Y,styleType:e})))}class oi extends rp.q{}var os=n(520285),oc=n(70575),od=n(181320),op=n(804846),om=n(33136),ou=n(166635);function oE(e){let t=(0,om.t)();return e.readOnly?r.createElement(ou.lc,{...e}):t.nodesAreAllInsideStacks&&"AUTO"===t.stackPositioning?null:r.createElement(rm.Zk,null,r.createElement(rm.fI,null,r.createElement(rm.xw,{extended:!0},(0,d.tx)("fullscreen.properties_panel.constraints_panel.constraints"))),r.createElement(ou.lc,{...e}))}function og(e){return r.createElement(rt.k,{name:"constraints_panel"},r.createElement(oE,{...e}))}var oy=n(233711),o_=n(78479),oh=n(905060),of=n(841446),ov=n(80479),ob=n(876797),oS=n(750693),oT=n(307905),oN=n(459674),oI=n(443830),oP=n(868876),oC=n(390965),ok=n(868887),oA=n(107239),ow=n(939791);function oO({recordingKey:e,numSelected:t}){let n=(0,eu.GS)(),a=t??1,o=()=>{i.glU.upgradeToLatestVectorOperationVersion()},l=(0,d.tx)("fullscreen.properties_panel.vector_operation.update_text",{numNodes:a}),s=(0,d.tx)("fullscreen.properties_panel.vector_operation.update_button",{numNodes:a});return r.createElement(rm.Zk,null,r.createElement("p",{className:T.cx.pl16.pr16.mb12.font11.$},l),n?r.createElement(ow.Ad,{label:null,input:r.createElement(n3.$n,{variant:"secondary",onClick:o,recordingKey:n0.Pt(e,"updateBoolean")},s)}):r.createElement(oA.z,{onClick:o,recordingKey:n0.Pt(e,"updateBooleanUI2")},s))}var ox=n(520581),oR=n(6024),oM=n(916560);function oL(e){return e.modalShown?.type===oM.y.type||e.modalShown?.prevModal?.type===oM.y.type}function oD(){let e=(0,oR.n)({type:oM.y}),t=(0,r.useCallback)(()=>{e()},[e]),n=(0,o.d4)(oL),a=0===(0,nR.Rb)().length&&!n;return r.createElement(rt.k,{name:"local_variables_panel"},r.createElement(rm.Zk,null,r.createElement(rm.fI,{className:a?"local_variables_panel--localVariablesPanelRowFaded--atToe local_variables_panel--localVariablesPanelRow--zR8nJ draggable_list--panelHeaderRowFaded--kETRR":"local_variables_panel--localVariablesPanelRow--zR8nJ"},r.createElement(rm.xZ,{className:"local_variables_panel--titleText--7rdD7 draggable_list--panelTitleText--SwKez",onClick:t,"data-onboarding-key":"local-variables-panel-title"},(0,d.tx)("variables.local_variables_panel.local_variables_title")),r.createElement(ox.E,{name:"variables_modal_button"},r.createElement(rR.d,{onClick:t,recordingKey:(0,n0.Pt)("localVariablesPanel","variablesModalButton"),toggled:n,"aria-label":(0,d.t)("variables.local_variables_panel.open_variables_button_tooltip"),htmlAttributes:{"data-tooltip":(0,d.t)("variables.local_variables_panel.open_variables_button_tooltip"),"data-tooltip-type":rf.Ib.TEXT}},r.createElement(rh.U,{svg:rV.A},r.createElement(rM.A,null)))))))}var oK=n(460043);function oF({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:g,publishedPlugins:y,saveAsState:_,sceneGraphSelection:h,scrollContainer:f,selectedStyleProperties:b,selectionPaints:S,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:k}){let A=(0,o.wA)(),w=(0,v.md)(aH.b);return r.createElement(aX.i,null,0===Object.keys(h).length&&r.createElement(oc.Mw,{panelName:oc.ON.DESIGN}),(0,aY.d6)(N)&&r.createElement(os.AV,{recordingKey:"alignPanel"}),r.createElement(aj.VF,{isVisible:N[i.ibQ.TRANSFORM_ITEM]},()=>r.createElement(ok.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:g,openFileKey:m?.key||null,canEditConstraints:(0,aY.GG)(N),onlyShowXYInputsRow:w===aW.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),r.createElement(aj.VF,{isVisible:(0,aY.jP)(T)},()=>r.createElement(oO,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:T.numSelected})),r.createElement(aW.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),r.createElement(oy.Q,{selection:h,shownPanels:N,scaleShouldHideOtherPanels:(0,aY.NR)(N)}),r.createElement(aj.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oC.r,{key:"template"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oK.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(op.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(aj.VF,{isVisible:(0,aY.tV)(N,T.stateGroupSelectionInfo)},()=>r.createElement(a1.BS,{key:"componentProperties",recordingKey:"propsPanel"})),r.createElement(aj.VF,{isVisible:(0,aY.M0)(N)},()=>r.createElement(oh._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>r.createElement(ok.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",isUI3:!1,x:l().x,y:l().y,cornerRadius:l().cornerRadius,handleMirroring:l().handleMirroring,dispatch:A,dropdownShown:a})),r.createElement(aj.VF,{isVisible:(0,aY.zp)(N,T,b,!1)},()=>r.createElement(oP.Vy,{key:"stack",onlyShowResizingRow:!1,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM],recordingKey:"stackPanel"})),r.createElement(aj.VF,{isVisible:(0,aY.GG)(N)},()=>r.createElement(og,{key:"constraints",openFileKey:m?.key||null,dropdownShown:a,recordingKey:"constraintsPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>r.createElement(ob.B,{key:"mask",maskType:T.maskType,dispatch:A,dropdownShown:a,recordingKey:"maskPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>r.createElement(aW.tC,{key:"grids",selectionProperties:T})),r.createElement(aj.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>r.createElement(ov.s,{key:"layer",blendMode:T.blendMode,opacity:T.opacity,visible:T.visible,variableConsumptionInfo:T.variableConsumptionInfo,recordingKey:"layerPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>r.createElement(aW.gc,{key:"type",selectionProperties:T})),r.createElement(aj.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>r.createElement(od.v,{key:"canvas-background",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:A,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:g,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,recordingKey:"canvasBackgroundPanel",currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:aZ.rC,sceneGraphSelection:h,selectedStyleProperties:b,hasExports:!!T.exportSettings&&(0,aq._W)(T.exportSettings,[]).length>0})),r.createElement(aj.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oT.C,{key:"remove-group-fill-stroke"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>r.createElement(aW.B8,{key:"fill",selectionProperties:T,variableScopes:(0,oI.og)(T)})),r.createElement(aj.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>r.createElement(oS.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:k,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:A,dropdownShown:a,modalShown:p,pickerShown:g,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:h,selectedStyleProperties:b,openFile:m,isPanelBodyCollapsedAtom:null})),r.createElement(aj.VF,{isVisible:(0,aY.fI)(N,(0,aY.NR)(N),S)},()=>r.createElement(oS.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:S,dispatch:A,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:g,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.rC,library:c,openFile:m,isUI3:!1})),r.createElement(aj.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(aW.w5,{key:"effects",selectionProperties:T})),r.createElement(aj.VF,{isVisible:(0,aY.ji)(N,t,h)},()=>r.createElement(oD,{key:"local-variables"})),r.createElement(aj.VF,{isVisible:(0,aY.ww)(N,h)},()=>r.createElement(or,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),r.createElement(aj.VF,{isVisible:(0,aY.P1)(N,m)},()=>r.createElement(o_.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:o_.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,sceneGraphSelection:h,isSelectionRenamable:o_.LI.isSelectionRenamable(Object.keys(h)),currentPage:(0,a0.Nf)(t),dispatch:A,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:g,saveAsState:_,panelWidth:aY.iP})),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(N)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:u,dispatch:A,openFileKey:m?.key||null,editorType:m?.editorType?(0,aF.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&r.createElement(of.A,null))}var oV=n(814466),oU=n(807835);function oB({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:c,localPlugins:d,modalShown:p,openFile:m,orgEntity:u,pickerInStyleCreationShown:E,pickerShown:g,publishedPlugins:y,saveAsState:_,sceneGraphSelection:h,scrollContainer:f,selectedStyleProperties:b,selectionPaints:S,selectionProperties:T,shownPanels:N,strokePanelMode:I,strokePanelTerminalPointCount:P,stylePickerListLayout:C,stylePickerShown:k}){let A=(0,o.wA)(),w=(0,v.md)(aH.b),O=(0,oI.qh)(T);return r.createElement(aX.i,null,0===Object.keys(h).length&&r.createElement(oc.Mw,{panelName:oc.ON.DESIGN}),r.createElement(oU._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,aY.tV)(N,T.stateGroupSelectionInfo),shouldShowInstancePanel:(0,aY.M0)(N),shouldShowVectorOperationPanel:(0,aY.jP)(T)}),r.createElement(aj.VF,{isVisible:(0,aY.jP)(T)},()=>r.createElement(oO,{key:"vectorOperation",recordingKey:"vectorOperationPanel",numSelected:T.numSelected})),r.createElement(aj.VF,{isVisible:(0,aY.tV)(N,T.stateGroupSelectionInfo)},()=>r.createElement(a1.BS,{key:"componentProperties",recordingKey:"propsPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(op.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(aj.VF,{isVisible:(0,aY.M0)(N)},()=>r.createElement(oh._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(aj.VF,{isVisible:(0,aY.d6)(N)||N[i.ibQ.TRANSFORM_ITEM]},()=>r.createElement(ok.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:w,pickerShown:g,openFileKey:m?.key||null,canEditConstraints:(0,aY.GG)(N),onlyShowXYInputsRow:w===aW.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),r.createElement(aj.VF,{isVisible:(0,aY.zp)(N,T,b,!0)},()=>r.createElement(oP.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:w===aW.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!N[i.ibQ.STACK_ITEM]})),r.createElement(aW.F$,{isVisible:N[i.ibQ.SCALE_ITEM]}),r.createElement(oy.Q,{selection:h,shownPanels:N,scaleShouldHideOtherPanels:(0,aY.NR)(N)}),r.createElement(aj.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oC.r,{key:"template"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oK.$,{key:"templateProperties",recordingKey:"templatePropsPanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.VECTOR_ITEM]},()=>r.createElement(ok.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:T.x,y:T.y,cornerRadius:T.cornerRadius,handleMirroring:T.handleMirroring,dispatch:A,dropdownShown:a})),r.createElement(aj.VF,{isVisible:N[i.ibQ.MASK_ITEM]},()=>r.createElement(ob.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:A,dropdownShown:a})),r.createElement(aj.VF,{isVisible:N[i.ibQ.LAYER_ITEM]},()=>r.createElement(oV.X,{recordingKey:"appearancePanel"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.TYPE_ITEM]},()=>r.createElement(aW.gc,{key:"type",selectionProperties:T})),r.createElement(aj.VF,{isVisible:N[i.ibQ.CANVAS_ITEM]},()=>r.createElement(od.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:T.backgroundColor,backgroundEnabled:T.backgroundEnabled,backgroundOpacity:T.backgroundOpacity,exportBackgroundDisabled:T.exportBackgroundDisabled,dispatch:A,dropdownShown:a,modalShown:p,editModeType:t.activeCanvasEditModeType,pickerShown:g,currentTool:t.currentTool,colorFormat:n,library:c,openFile:m,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:aZ.rC,sceneGraphSelection:h,selectedStyleProperties:b,hasExports:!!T.exportSettings&&(0,aq._W)(T.exportSettings,[]).length>0})),r.createElement(aj.VF,{isVisible:N[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oT.C,{key:"remove-group-fill-stroke"})),r.createElement(aj.VF,{isVisible:N[i.ibQ.FILL_ITEM]},()=>r.createElement(aW.B8,{key:"fill",selectionProperties:T,variableScopes:O})),r.createElement(aj.VF,{isVisible:N[i.ibQ.STROKE_ITEM]},()=>r.createElement(oS.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:k,strokePanelMode:I,strokePanelTerminalPointCount:P,strokePaints:T.strokePaints,borderSharedWeight:T.borderSharedWeight,strokeWeight:T.strokeWeight,strokeAlign:T.strokeAlign,strokeCap:T.strokeCap,strokeJoin:T.strokeJoin,miterLimitAngle:T.miterLimitAngle,connectorLineStyle:T.connectorLineStyle,leftEndCap:T.leftEndCap,rightEndCap:T.rightEndCap,maxStrokeWeight:T.maxStrokeWeight,dashPattern:T.dashPattern,dashCap:T.dashCap,terminalCap:T.terminalCap,arcRadius:T.arcRadius,arcSweep:T.arcSweep,numSelectedByType:T.numSelectedByType,dispatch:A,dropdownShown:a,modalShown:p,pickerShown:g,pickerInStyleCreationShown:E,stylePickerListLayout:C,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.Em,inheritStyleKey:T.inheritFillStyleKeyForStroke||null,inheritStyleID:T.styleIdForStrokeFill||null,library:c,sceneGraphSelection:h,selectedStyleProperties:b,openFile:m,isPanelBodyCollapsedAtom:null})),r.createElement(aj.VF,{isVisible:N[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(aW.w5,{key:"effects",selectionProperties:T})),r.createElement(aj.VF,{isVisible:(0,aY.fI)(N,(0,aY.NR)(N),S)},()=>r.createElement(oS.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:S,dispatch:A,dropdownShown:a,sceneGraphSelection:h,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:g,stylePickerListLayout:C,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.rC,library:c,openFile:m})),r.createElement(aj.VF,{isVisible:(0,aY.ji)(N,t,h)},()=>r.createElement(oD,{key:"local-variables"})),r.createElement(aj.VF,{isVisible:(0,aY.ww)(N,h)},()=>r.createElement(or,{key:"local-styles",recordingKey:"local-styles",scrollContainer:f})),r.createElement(aj.VF,{isVisible:N[i.ibQ.GRIDS_ITEM]},()=>r.createElement(aW.tC,{key:"grids",selectionProperties:T})),r.createElement(aj.VF,{isVisible:(0,aY.P1)(N,m)},()=>r.createElement(o_.LI,{key:"export",recordingKey:"exportsPanel",openFile:m,singleNodeName:o_.LI.singleNodeNameFrom(T),numSelected:T.numSelected,exportSettings:T.exportSettings,isSelectionRenamable:o_.LI.isSelectionRenamable(Object.keys(h)),sceneGraphSelection:h,currentPage:(0,a0.Nf)(t),dispatch:A,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:g,saveAsState:_,panelWidth:aY.iP})),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(N)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:d,publishedPlugins:y,allSavedPlugins:e.plugins,orgEntity:u,dispatch:A,openFileKey:m?.key||null,editorType:m?.editorType?(0,aF.wN)(m.editorType):null,numSelected:l().numSelected??0})),(0,s.kc)().jsx_debugging&&r.createElement(of.A,null))}function oG(e){let t=(0,o.wA)(),n=(0,eu.GS)(),a=(0,e_.iZ)(),l=(0,eo.J2)((0,aR.UK)().expandedFramePresetType);return(((0,a$.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)]))&&!window.figmaPerfTesting&&!(0,ak.Lg)()&&!(0,ak.nl)()&&(0,tR.x1)("PropertiesPanel","Rendering design tab with no shownPropertiesPanels",{isEmpty:(0,a$.Im)(e.shownPanels),shouldRenderInspectTab:(0,aY.S4)(e.appModel,a)}),e.shownPanels[i.ibQ.FRAME_PRESETS])?r.createElement(aX.i,null,r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(aQ.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:t,expandedFramePresetType:l}))):e.shownPanels[i.ibQ.PENCIL_TOOL]?r.createElement(aX.i,null,r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(aJ.q,{key:"pencilToolPanel",recordingKey:"pencilToolPanel",id:"pencilToolPanel",openFile:e.openFile}))):n?r.createElement(oB,{...e}):r.createElement(oF,{...e})}var oz=n(268853),oH=n(776621),oW=n(435225);function oY({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:g,saveAsState:y,sceneGraphSelection:_,selectedStyleProperties:h,selectionPaints:f,selectionProperties:b,shownPanels:S,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,o.wA)(),[k,A]=(0,v.fp)(aH.b);return r.createElement(aX.i,null,(0,aY.d6)(S)&&r.createElement(os.AV,{recordingKey:"alignPanel"}),r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(ok.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:k,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:!1,onlyShowXYInputsRow:!1})),r.createElement(aW.F$,{isVisible:S[i.ibQ.SCALE_ITEM]}),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oh._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(aj.VF,{isVisible:(0,aY.GG)(S)},()=>r.createElement(og,{key:"constraints",recordingKey:"constraintsPanel",openFileKey:p?.key||null,dropdownShown:a})),r.createElement(aj.VF,{isVisible:S[i.ibQ.LAYER_ITEM]},()=>r.createElement(ov.s,{key:"layer",recordingKey:"layerPanel",blendMode:b.blendMode,opacity:b.opacity,visible:b.visible,variableConsumptionInfo:b.variableConsumptionInfo})),k===aW.GR.DEFAULT_SIMPLIFIED&&r.createElement(oW.Y,{onExpand:()=>A(aW.GR.OVERRIDDEN_EXPANDED)}),k===aW.GR.OVERRIDDEN_EXPANDED&&r.createElement(r.Fragment,null,r.createElement(oy.Q,{selection:_,shownPanels:S,scaleShouldHideOtherPanels:(0,aY.NR)(S)}),r.createElement(aj.VF,{isVisible:S[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oC.r,{key:"template"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(op.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.VECTOR_ITEM]},()=>r.createElement(ok.Ss,{key:"vector-transform",recordingKey:"vectorTransformPanel",x:b.x,y:b.y,cornerRadius:b.cornerRadius,handleMirroring:b.handleMirroring,dispatch:C,dropdownShown:a,isUI3:!1})),r.createElement(aj.VF,{isVisible:(0,aY.zp)(S,b,h,!1)},()=>r.createElement(oP.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:!1,onlyStacksSelected:!!S[i.ibQ.STACK_ITEM]})),r.createElement(aj.VF,{isVisible:S[i.ibQ.MASK_ITEM]},()=>r.createElement(ob.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),r.createElement(aj.VF,{isVisible:S[i.ibQ.GRIDS_ITEM]},()=>r.createElement(aW.tC,{key:"grids",selectionProperties:b})),r.createElement(aj.VF,{isVisible:S[i.ibQ.TYPE_ITEM]},()=>r.createElement(aW.gc,{key:"type",selectionProperties:b})),r.createElement(aj.VF,{isVisible:S[i.ibQ.CANVAS_ITEM]},()=>r.createElement(od.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:b.backgroundColor,backgroundEnabled:b.backgroundEnabled,backgroundOpacity:b.backgroundOpacity,exportBackgroundDisabled:b.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:aZ.rC,sceneGraphSelection:_,selectedStyleProperties:h,hasExports:!!b.exportSettings&&(0,aq._W)(b.exportSettings,[]).length>0})),r.createElement(aj.VF,{isVisible:S[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oT.C,{key:"remove-group-fill-stroke"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.FILL_ITEM]},()=>r.createElement(aW.B8,{key:"fill",selectionProperties:b,variableScopes:(0,oI.og)(b)})),r.createElement(aj.VF,{isVisible:S[i.ibQ.STROKE_ITEM]},()=>r.createElement(oS.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:b.strokePaints,borderSharedWeight:b.borderSharedWeight,strokeWeight:b.strokeWeight,strokeAlign:b.strokeAlign,strokeCap:b.strokeCap,strokeJoin:b.strokeJoin,miterLimitAngle:b.miterLimitAngle,connectorLineStyle:b.connectorLineStyle,leftEndCap:b.leftEndCap,rightEndCap:b.rightEndCap,maxStrokeWeight:b.maxStrokeWeight,dashPattern:b.dashPattern,dashCap:b.dashCap,terminalCap:b.terminalCap,arcRadius:b.arcRadius,arcSweep:b.arcSweep,numSelectedByType:b.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.Em,inheritStyleKey:b.inheritFillStyleKeyForStroke||null,inheritStyleID:b.styleIdForStrokeFill||null,library:s,sceneGraphSelection:_,selectedStyleProperties:h,openFile:p,isPanelBodyCollapsedAtom:null})),r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(oS.UA,{key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:C,dropdownShown:a,sceneGraphSelection:_,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.rC,library:s,openFile:p,isUI3:!1})),r.createElement(aj.VF,{isVisible:S[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(aW.w5,{key:"effects",selectionProperties:b})),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,aF.wN)(p.editorType):null,numSelected:l().numSelected??0}))),r.createElement(aj.VF,{isVisible:(0,aY.P1)(S,p)},()=>r.createElement(o_.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:o_.LI.singleNodeNameFrom(b),numSelected:b.numSelected,exportSettings:b.exportSettings,sceneGraphSelection:_,currentPage:(0,a0.Nf)(t),isSelectionRenamable:o_.LI.isSelectionRenamable(Object.keys(_)),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:y,panelWidth:aY.iP})),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,aF.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function o$({allSavedPlugins:e,appModel:t,colorFormat:n,dropdownShown:a,getContextualSelectionProperties:l,library:s,localPlugins:c,modalShown:d,openFile:p,orgEntity:m,pickerInStyleCreationShown:u,pickerShown:E,publishedPlugins:g,saveAsState:y,sceneGraphSelection:_,selectedStyleProperties:h,selectionPaints:f,selectionProperties:b,shownPanels:S,strokePanelMode:T,strokePanelTerminalPointCount:N,stylePickerListLayout:I,stylePickerShown:P}){let C=(0,o.wA)(),[k,A]=(0,v.fp)(aH.b);return r.createElement(aX.i,null,0===Object.keys(_).length&&r.createElement(oc.Mw,{panelName:oc.ON.DESIGN}),r.createElement(oU._i,{recordingKey:"toolbarView",shouldShowComponentPropertiesPanel:(0,aY.tV)(S,b.stateGroupSelectionInfo),shouldShowInstancePanel:(0,aY.M0)(S)}),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oh._,{key:"instance",recordingKey:"instancePanel"})),r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(ok.zq,{key:"transform",recordingKey:"transformPanel",propertiesPanelState:k,pickerShown:E,openFileKey:p?.key||null,canEditConstraints:(0,aY.GG)(S),onlyShowXYInputsRow:k===aW.GR.DEFAULT_SIMPLIFIED||(l().areOnlyResponsiveSetsSelected??!1)})),r.createElement(aj.VF,{isVisible:(0,aY.zp)(S,b,h,!0)},()=>r.createElement(oP.Vy,{key:"stack",recordingKey:"stackPanel",onlyShowResizingRow:k===aW.GR.DEFAULT_SIMPLIFIED,onlyStacksSelected:!!S[i.ibQ.STACK_ITEM]})),r.createElement(aW.F$,{isVisible:S[i.ibQ.SCALE_ITEM]}),k===aW.GR.DEFAULT_SIMPLIFIED&&r.createElement(oW.Y,{onExpand:()=>A(aW.GR.OVERRIDDEN_EXPANDED)}),k===aW.GR.OVERRIDDEN_EXPANDED&&r.createElement(r.Fragment,null,r.createElement(aj.VF,{isVisible:S[i.ibQ.LAYER_ITEM]},()=>r.createElement(oV.X,{recordingKey:"appearancePanel"})),r.createElement(oy.Q,{selection:_,shownPanels:S,scaleShouldHideOtherPanels:(0,aY.NR)(S)}),r.createElement(aj.VF,{isVisible:S[i.ibQ.TEMPLATE_ITEM]},()=>r.createElement(oC.r,{key:"template"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.COMPONENT_ITEM]},()=>r.createElement(op.cu,{key:"component",recordingKey:"componentPanel"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.VECTOR_ITEM]},()=>r.createElement(ok.Ss,{isUI3:!0,key:"vector-transform",recordingKey:"vectorTransformPanel",x:b.x,y:b.y,cornerRadius:b.cornerRadius,handleMirroring:b.handleMirroring,dispatch:C,dropdownShown:a})),r.createElement(aj.VF,{isVisible:S[i.ibQ.MASK_ITEM]},()=>r.createElement(ob.B,{key:"mask",recordingKey:"maskPanel",maskType:l().maskType,dispatch:C,dropdownShown:a})),r.createElement(aj.VF,{isVisible:S[i.ibQ.TYPE_ITEM]},()=>r.createElement(aW.gc,{key:"type",selectionProperties:b})),r.createElement(aj.VF,{isVisible:S[i.ibQ.CANVAS_ITEM]},()=>r.createElement(od.v,{key:"canvas-background",recordingKey:"canvasBackgroundPanel",backgroundColor:b.backgroundColor,backgroundEnabled:b.backgroundEnabled,backgroundOpacity:b.backgroundOpacity,exportBackgroundDisabled:b.exportBackgroundDisabled,dispatch:C,dropdownShown:a,modalShown:d,editModeType:t.activeCanvasEditModeType,pickerShown:E,currentTool:t.currentTool,colorFormat:n,library:s,openFile:p,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,defaultColor:aZ.rC,sceneGraphSelection:_,selectedStyleProperties:h,hasExports:!!b.exportSettings&&(0,aq._W)(b.exportSettings,[]).length>0})),r.createElement(aj.VF,{isVisible:S[i.ibQ.REMOVE_GROUP_BACKGROUND_ITEM]},()=>r.createElement(oT.C,{key:"remove-group-fill-stroke"})),r.createElement(aj.VF,{isVisible:S[i.ibQ.FILL_ITEM]},()=>r.createElement(aW.B8,{key:"fill",selectionProperties:b,variableScopes:(0,oI.og)(b)})),r.createElement(aj.VF,{isVisible:S[i.ibQ.STROKE_ITEM]},()=>r.createElement(oS.$p,{key:"stroke",recordingKey:"strokePanel",stylePickerShown:P,strokePanelMode:T,strokePanelTerminalPointCount:N,strokePaints:b.strokePaints,borderSharedWeight:b.borderSharedWeight,strokeWeight:b.strokeWeight,strokeAlign:b.strokeAlign,strokeCap:b.strokeCap,strokeJoin:b.strokeJoin,miterLimitAngle:b.miterLimitAngle,connectorLineStyle:b.connectorLineStyle,leftEndCap:b.leftEndCap,rightEndCap:b.rightEndCap,maxStrokeWeight:b.maxStrokeWeight,dashPattern:b.dashPattern,dashCap:b.dashCap,terminalCap:b.terminalCap,arcRadius:b.arcRadius,arcSweep:b.arcSweep,numSelectedByType:b.numSelectedByType,dispatch:C,dropdownShown:a,modalShown:d,pickerShown:E,pickerInStyleCreationShown:u,stylePickerListLayout:I,currentSelectedProperty:t.currentSelectedProperty,currentSelectedGradientStop:t.currentSelectedGradientStop,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.Em,inheritStyleKey:b.inheritFillStyleKeyForStroke||null,inheritStyleID:b.styleIdForStrokeFill||null,library:s,sceneGraphSelection:_,selectedStyleProperties:h,openFile:p,isPanelBodyCollapsedAtom:null})),r.createElement(aj.VF,{isVisible:S[i.ibQ.EFFECTS_ITEM]},()=>r.createElement(aW.w5,{key:"effects",selectionProperties:b})),r.createElement(aj.VF,{isVisible:(0,aY.fI)(S,(0,aY.NR)(S),f)},()=>r.createElement(oS.UA,{isUI3:!0,key:"selection-paints",recordingKey:"selectionPaintsPanel",selectionPaints:f,dispatch:C,dropdownShown:a,sceneGraphSelection:_,currentSelectedGradientStop:t.currentSelectedGradientStop,pickerShown:E,stylePickerListLayout:I,currentTool:t.currentTool,colorFormat:n,editModeType:t.activeCanvasEditModeType,defaultColor:aZ.rC,library:s,openFile:p})),r.createElement(aj.VF,{isVisible:S[i.ibQ.GRIDS_ITEM]},()=>r.createElement(aW.tC,{key:"grids",selectionProperties:b})),r.createElement(aj.VF,{isVisible:(0,aY.P1)(S,p)},()=>r.createElement(o_.LI,{key:"export",recordingKey:"exportsPanel",openFile:p,singleNodeName:o_.LI.singleNodeNameFrom(b),isSelectionRenamable:o_.LI.isSelectionRenamable(Object.keys(_)),numSelected:b.numSelected,exportSettings:b.exportSettings,sceneGraphSelection:_,currentPage:(0,a0.Nf)(t),dispatch:C,dropdownShown:a,currentSelectedProperty:t.currentSelectedProperty,pickerShown:E,saveAsState:y,panelWidth:aY.iP})),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,aF.wN)(p.editorType):null,numSelected:l().numSelected??0}))),r.createElement(aj.VF,{isVisible:!(0,aY.NR)(S)},()=>r.createElement(oN.Q,{key:"plugin",recordingKey:"pluginPanel",pluginRelaunchData:l().pluginRelaunchData,localPlugins:c,publishedPlugins:g,allSavedPlugins:e.plugins,orgEntity:m,dispatch:C,openFileKey:p?.key||null,editorType:p?.editorType?(0,aF.wN)(p.editorType):null,numSelected:l().numSelected??0})))}function oX(e){let t=(0,eu.GS)();if((0,a$.Im)(e.shownPanels)||Object.keys(e.shownPanels).every(t=>!e.shownPanels[parseInt(t)])){let e=Error("Rendering simplified design tab with no shownPropertiesPanels");(0,oH.$D)(oz.e.EDITOR_USABILITY,e)}return t?r.createElement(o$,{...e}):r.createElement(oY,{...e})}function oj({scrollContainer:e,...t}){let n=(0,v.md)(aH.b),a=(0,az.Yo)(),o=()=>(0,aY.RB)(t.selectedStyleProperties)?t.selectedStyleProperties:t.selectionProperties;return n===aW.GR.DEFAULT_EXPANDED?r.createElement(oG,{...t,getContextualSelectionProperties:o,orgEntity:a,scrollContainer:e}):r.createElement(oX,{...t,getContextualSelectionProperties:o,orgEntity:a})}var oQ=n(507956);function oJ({appModel:e,dropdownShown:t,pickerShown:n,saveAsState:a,sceneGraphSelection:l,selectedStyleProperties:i,selectionProperties:s}){let c=(0,o.wA)(),p=(0,U.q5)(),m=(0,a0.Nf)(e),u=(0,oQ.ks)(),E=e.isReadOnly&&!u,g=(0,aY.RB)(i)?i:s;return r.createElement(aj.VF,{isVisible:!0},()=>r.createElement(o_.LI,{key:"export",title:E?(0,d.t)("fullscreen.properties_panel.export"):(0,d.t)("fullscreen.properties_panel.presets"),standalone:!0,openFile:p,singleNodeName:o_.LI.singleNodeNameFrom(g),isSelectionRenamable:o_.LI.isSelectionRenamable(Object.keys(l)),numSelected:g.numSelected,exportSettings:g.exportSettings,sceneGraphSelection:l,currentPage:m,dispatch:c,dropdownShown:t,currentSelectedProperty:e.currentSelectedProperty,pickerShown:n,recordingKey:"exportsPanel",saveAsState:a,panelWidth:aY.iP}))}var oq=n(126590),oZ=n(143678),o0=n(889449),o1=n(853497);function o2({selectionProperties:e,scrollContainer:t}){let n=(0,U.q5)(),a=(0,V.KH)(),o=!e.prototypeStartingPointsInfo||e.prototypeStartingPointsInfo?.length>0,l=0===Object.keys(a).length,i=n?.canEdit,s=r.createElement(aj.VF,{isVisible:l&&!i&&o},()=>r.createElement(o1.A,{viewOnly:!0})),c=r.createElement(aj.VF,{isVisible:l},()=>r.createElement(or,{key:"code-local-styles",recordingKey:"code-local-styles",scrollContainer:t}));return r.createElement(M.fu,{name:oZ.e0.CODE_PANEL},r.createElement(aX.i,null,r.createElement(oc.Mw,{panelName:oc.ON.INSPECT}),r.createElement(o0.U,{key:"inspection-properties-panel",recordingKey:"inspectionPanel",flowPanel:s,localStylesPanel:c})))}var o4=n(408263),o8=n(326331),o3=n(977750),o5=n(189904),o7=n(523047),o6=n(335601),o9=n(239349),le=n(662275),lt=n(218973),ln=n(158950),la=n(60088),lr=n(343559),lo=n(959309),ll=n(822397),li=n(198868),ls=n(802926),lc=n(269900),ld=n(288777),lp=n(90115);async function lm(e,t){let n=await (0,lo.vd)(e),a=await (0,lo.vd)(t),r=(await lp.Ay.design.getTextImageEmbeds({model:"clip-huge-shared",input:{images:[n,a]}})).encoded_images;if(!r||2!==r.length)throw Error("Expected two embedding vectors in the response");let o=r[0],l=r[1];if(!o||!l)throw Error("Embedding vectors must not be undefined");return(0,ld.Lb)(o,l)}async function lu(e,t){e(p.F.clearAll());let n=tn.UN().getCurrentPage()?.childrenNodes.filter(e=>"SECTION"===e.type&&1===e.childrenNodes.length);if(!n||0===n.length){e(p.F.enqueue({message:(0,d.t)("living_designs.eval.error"),error:!0}));return}let a=a5.l7.ai(lo.p1,()=>{let e=(0,tn.UN)().createNode("CANVAS");return e.name=`Eval - ${new Date().toLocaleString()}`,e});await (0,tn.UN)().setCurrentPageAsync(a.guid);let r=t.evaluationRuns,o=r*n.length;e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.progress",{completed:0,total:o}),timeoutOverride:1/0}));try{let a=0,l=n.flatMap((e,t)=>Array.from({length:r}).map((n,a)=>{var o;let l=t*r+a;return o=(e.absoluteRenderBounds.w+(l>0?40:0))*l,a5.l7.ai(lo.p1,()=>{let t=e.clone(),n=(0,tn.UN)().get(t);n.relativeTransform={...n.relativeTransform,m02:o};let a=e.clone(),r=(0,tn.UN)().get(a);r.relativeTransform={...r.relativeTransform,m02:o},r.name="Output: "+e.name,r.y=e.y+e.size.y+40,r.size={x:r.size.x,y:3*r.size.y},r.childrenNodes[0].removeSelfAndChildren();let l=n.childrenNodes[0];if(!l)throw Error("Failed to clone node");return{nodeToEval:l,inputSection:n,outputSection:r}})})),i=(0,li.D)();i.viewport.scrollAndZoomIntoView(l.flatMap(({inputSection:e,outputSection:t})=>[e,t].map(e=>i.getNodeById(e.guid)).filter(e=>null!==e)));let s=l.map(async({nodeToEval:n,outputSection:r})=>{let l=await lE(n,r,t);return a++,e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.progress",{completed:a,total:o}),timeoutOverride:1/0})),l}),c=(await Promise.all(s)).map(({metrics:e})=>e),m=function(e){let t=e.reduce((e,t)=>e+t.imageToImageSimilarity,0)/e.length,n=e.length,a=e.filter(e=>e.error).length;return{avgImageToImageSimilarity:t,numTestCases:n,numFailures:a,failureRate:a/n}}(c),u=l[0]?.inputSection;if(!u)throw Error("No sections were prepared for evaluation.");a5.l7.ai(lo.p1,()=>(function(e,t){let n=e.clone(),a=(0,tn.UN)().get(n);a.childrenNodes[0].removeSelfAndChildren(),a.relativeTransform={...a.relativeTransform,m02:e.absoluteRenderBounds.w},a.name="Aggregate Metrics",a.x=e.x-e.size.x-40,a.y=e.y;let r=(0,tn.UN)().createNode("TEXT");r.characters=`Aggregate Metrics: ${JSON.stringify(t,(e,t)=>"number"!=typeof t||Number.isInteger(t)?t:t.toFixed(3),2)}`,r.x=0,r.size.x=a.size.x,r.y=10,a.appendChild(r),r.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],r.fontSize=40})(u,m)),e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.finished")}))}catch(t){a.removeSelfAndChildren(),e(p.F.enqueue({type:"living-designs-evals",message:(0,d.t)("living_designs.eval.error"),error:!0}))}}async function lE(e,t,n){!function e(t){for(let n of t.childrenNodes)e(n);t.annotations.length>0&&((0,lo.Ww)(t,{...(0,lo.u6)(t),messages:t.annotations.map(e=>({id:(0,tC.g)(),createdAt:Date.now(),content:e.label}))}),t.annotations.splice(0,t.annotations.length))}(e);let a=e.size,r={x:t.size.x/2-a.x/2,y:40},o=v.zl.get(ll.Zl).serializer,{html:l,styles:i}=await (0,lo.li)(e,o,(0,ll.Lf)(e).map(e=>e.nodeId));if("sites"===o&&l){let n=await (0,ls.Is)(l),o=await (0,ls.zG)(n),s=await (0,ls._5)(l);lg({name:"HTML",imageSet:(await (0,lc.l)({code:o,width:e.size.x??0,height:e.size.y??0,props:{},styles:`${i}
${s}`})).imageSet,sources:[{code:l,language:"TYPESCRIPT"},{code:i,language:"CSS"}],position:r,size:a,outputSection:t})}let{generatedCode:s,nodesWithProps:c,errorMessage:p}=await (0,ll.kX)(e,{initialBackoffDelay:n.evalBackoffDelay});if(!s||!c)return a5.l7.ai(lo.p1,()=>{let e=(0,tn.UN)().createNode("FRAME");e.size=a,e.x=r.x,e.y=r.y,t.appendChild(e);let n=(0,tn.UN)().createNode("TEXT");n.characters=p??(0,d.t)("living_designs.eval.error"),n.size=e.size,n.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fills=[{type:"SOLID",color:{r:1,g:0,b:0,a:1}}],e.appendChild(n)}),{outputSection:t,metrics:{imageToImageSimilarity:0,error:!0}};let m=await (0,ls.Is)(s),u=await (0,ls.zG)(m),E=await (0,ls._5)(s),g=await (0,lc.l)({code:u,width:e.size.x??0,height:e.size.y??0,props:(0,ll.IL)((0,tn.UN)(),c),styles:`${i}
${E}`}),y=await lg({name:"Generated",imageSet:g.imageSet,sources:[{code:s,language:"TYPESCRIPT"},{code:i,language:"CSS"}],position:r,size:a,outputSection:t}),_=await lm(e,y);return a5.l7.ai(lo.p1,()=>{let e=(0,tn.UN)().createNode("TEXT");e.characters=`Image-Image Similarity: ${_.toFixed(2)}`,e.x=0,e.size.x=y.size.x,e.y=10,t.appendChild(e),e.fills=[{type:"SOLID",color:{r:1,g:1,b:1,a:1}}],e.fontSize=40}),{outputSection:t,metrics:{imageToImageSimilarity:_,error:!1}}}async function lg({name:e,imageSet:t,sources:n,position:a,size:r,outputSection:o}){let l=[],i=20,s=a5.l7.ai(lo.p1,()=>{let s=(0,tn.UN)().createNode("FRAME");s.size=r,s.x=i,s.y=a.y,s.insertImageInFillPaint(t),s.name=e,i+=r.x+40;let c=(o.size.x-i)/n.length-40;for(let t of n){let n=(0,tn.UN)().createNode("FRAME");n.name=e+" Code",n.size={x:c,y:r.y},n.x=i,n.y=a.y,n.frameMaskDisabled=!1,o.appendChild(n);let d=(0,tn.UN)().createNode("CODE_BLOCK");l.push([d.guid,t]),n.appendChild(d),o.appendChild(s),i+=c+40}return s}),c=(0,li.D)();for(let[e,t]of l){await c.loadFontAsync({family:"Source Code Pro",style:"Medium"});let n=c.getNodeById(e);n.code=t.code,n.codeLanguage=t.language}return a.y+=r.y+40,s}var ly=n(688009),l_=n(940319),lh=n(847855),lf=n(237870),lv=n(547583),lb=n(746806),lS=n(711490),lT=n(502601),lN=n(908604),lI=n(20484);let lP="LivingDesignsModal",lC=(0,lf.Ju)(function({initialSize:e}){let t=(0,o.wA)(),[n,a]=(0,r.useState)(0),l=(0,lI.ts)(e,lA),[i,s,c]=ly.t.useTabs({preview:!0,code:!0,debug:!0});if(!l)return null;let{width:p,setWidth:m,height:u,setHeight:E,minWidth:g,minHeight:y,position:_,setPosition:h}=l,f=r.createElement(ly.t.TabStrip,{manager:c},r.createElement(ly.t.Tab,{...i.preview},(0,d.t)("living_designs.modal.tabs.preview")),r.createElement(ly.t.Tab,{...i.code},(0,d.t)("living_designs.modal.tabs.code")),r.createElement(ly.t.Tab,{...i.debug},(0,d.t)("living_designs.modal.tabs.debug"))),v=r.createElement(eS.K,{onClick:()=>a(e=>e+1),"aria-label":(0,d.t)("living_designs.modal.refresh")},r.createElement(l_._,null));return r.createElement(lT.Q,null,r.createElement(lw.Provider,{value:{tabPropsMap:i,tabPanelPropsMap:s,tabManager:c}},r.createElement(lb.BL,{customButton:v,title:f,position:_,allowResizeHeight:!0,allowResizeWidth:!0,dragHeaderOnly:!0,fullFrame:!0,height:u,width:p,minWidth:g,minHeight:y,setWidth:m,setHeight:E,setPosition:h,onClose:()=>{t((0,le.ES)({type:lP}))},overflowHidden:!0},r.createElement(lx,{key:n,size:{x:p,y:u}}))))},lP),lk={x:400,y:400},lA={x:260,y:80},lw=r.createContext(void 0),lO=()=>{let e=r.useContext(lw);if(!e)throw Error("usePreviewContext must be used within a PreviewContext.Provider");return e};function lx({size:e}){let{isResizing:t,isDragging:n}=r.useContext(lS.O);return r.createElement(lM,{disablePointerEvents:t||n,size:e})}var lR=(e=>(e.None="none",e.Generating="generating",e.Bundling="bundling",e.Ready="ready",e.Error="error",e))(lR||{});function lM({disablePointerEvents:e,size:t}){let n=(0,tA.VW)(),a=(0,lo.L4)(),o=(0,lo.Jp)(),l=(0,a7.PD)(o),i=n?.guid?o:l,[s,c]=(0,v.fp)((0,ll.R)(a?.guid||"")),[p,m]=(0,r.useState)(null),[u,E]=(0,r.useState)(""),{tabPanelPropsMap:g}=lO(),y=(0,z.Fk)(ll.IL,i?.generation?.nodesWithProps||[]);(0,r.useEffect)(()=>{let e=i?.generation;if(!e||"idle"!==s.status){m(null),E("");return}!async function(){let t=Promise.all([(0,lh.b)(e.code),(0,lh.b)(e.styles)]),[n,a]=await t,r=await (0,ls.Is)(n),o=await (0,ls.zG)(r),l=await (0,ls._5)(o);m(o),E(`${a}
${l}`)}()},[i?.generation,s]);let _="idle"===s.status&&i?.generation?.code?p?"ready":"bundling":"loading"===s.status?"generating":"none";return r.createElement("div",{className:T.cx.wFull.hFull.relative.$},r.createElement(ly.t.TabPanel,{...g.preview},r.createElement("div",{className:T.cx.absolute.top0.right0.bottom0.left0.$},"none"===_&&r.createElement("div",{className:T.cx.flex.hFull.wFull.itemsCenter.justifyCenter.$},(0,d.t)("living_designs.preview.no_design")),"generating"===_&&r.createElement("div",{className:T.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},r.createElement("div",null,(0,d.t)("living_designs.preview.generating")),r.createElement(t_.k,null)),"bundling"===_&&r.createElement("div",{className:T.cx.flex.hFull.wFull.itemsCenter.justifyCenter.flexColumn.$},r.createElement("div",null,(0,d.t)("living_designs.preview.bundling")),r.createElement(t_.k,null)),"ready"===_&&r.createElement(lN.eu,{disablePointerEvents:e,code:p,props:y,styles:u,size:{x:t.x,y:t.y},withReset:!0,onError:e=>c({status:"idle",errorMessage:e.message}),scaleLinearly:!0}),"idle"===s.status&&s.errorMessage&&r.createElement("div",{className:T.cx.absolute.left0.right0.bottom0.h24.flex.justifyBetween.itemsCenter.bt1.bSolid.colorBorder.p12.colorBgDanger.colorTextOndanger.$},(0,d.t)("living_designs.preview.error",{error:s.errorMessage||"Unknown"})))),r.createElement(ly.t.TabPanel,{...g.code},r.createElement("textarea",{readOnly:!0,className:T.cx.absolute.top0.right0.bottom0.left0.$,value:i?.generation?.code||"No code available"})),r.createElement(ly.t.TabPanel,{...g.debug},r.createElement("div",{className:T.cx.absolute.top0.right0.bottom0.left0.overflowYScroll.$},r.createElement(lv.p,{data:i?.generation}))))}var lL=n(140686),lD=n(256296),lK=n(499777),lF=n(420186),lV=n(699365),lU=n(538697),lB=n(994481);let lG=new n9.KD({}),lz=e=>e.replace(/([A-Z])/g," $1").toLowerCase().replace(/^./,e=>e.toUpperCase()).trim();function lH({prop:e,onChange:t}){switch(e.type){case"number":return r.createElement(lW,{prop:e,onChange:t});case"color":return r.createElement(lY,{prop:e,onChange:t});case"string":return r.createElement(l$,{prop:e,onChange:t});case"enum":return r.createElement(lX,{prop:e,onChange:t});case"boolean":return r.createElement(lj,{prop:e,onChange:t});default:return null}}function lW({prop:e,onChange:t}){let n=(0,o.wA)();return r.createElement(lB.cS,{label:lz(e.name),input:r.createElement(lt.j5,{value:e.value??e.defaultValue??0,onValueChange:e=>t(e),formatter:lG,dispatch:n,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":lz(e.name)})})}function lY({prop:e,onChange:t}){let n=(0,o.wA)(),a=(0,lK.Xo)(),l=r.useRef(null),i=(0,nZ.H0)(e.value??e.defaultValue??"#ffffff")||{r:1,g:1,b:1,a:1},s={type:"SOLID",color:i,opacity:i.a?i.a:1};return r.createElement("div",null,a?.id===`living-design-prop-${e.name}-color-picker`&&r.createElement(lV.h3,{disabledVariableIds:new Set,initialPosition:new tf.Mi(a.initialX,a.initialY),color:i,boundVariable:null,onChange:e=>t((0,nZ.YU)(e)),onClose:()=>n(eZ.XE())}),r.createElement(lB.cS,{label:lz(e.name),input:r.createElement("div",{className:"living_designs_props--colorValueContainer--nPsog paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t",ref:l},r.createElement(oS.y7,{paint:s,onChange:e=>{let n=e.color;n&&(void 0!==e.opacity&&(n.a=e.opacity),t((0,nZ.YU)(n)))},togglePicker:()=>{if(!l.current)return;let{x:t,y:a}=(0,lF.cn)(l.current);n(eZ.u1({id:`living-design-prop-${e.name}-color-picker`,initialX:t,initialY:a}))}}))}))}function l$({prop:e,onChange:t}){return r.createElement(lB.cS,{label:lz(e.name),input:r.createElement(rm.ks,{value:e.value??e.defaultValue??"",onChange:e=>t(e.currentTarget.value)})})}function lX({prop:e,onChange:t}){let n=(0,o.wA)(),a=(0,rH.Um)();return r.createElement(lB.cS,{label:lz(e.name),input:r.createElement(lU.l6,{property:e.value??e.defaultValue??"",onChange:e=>t(e),id:`living-design-prop-${e.name}`,dispatch:n,dropdownShown:a,formatter:{format:e=>e}},e.options?.map(e=>r.createElement(lU.c$,{key:e,value:e},e)))})}function lj({prop:e,onChange:t}){return r.createElement(lB.cS,{label:lz(e.name),input:r.createElement(lL.S,{checked:e.value??e.defaultValue??!1,onChange:e=>t(e),label:r.createElement(lD.h,null,lz(e.name))})})}var lQ=n(320986),lJ=n(289298);function lq(e,t){return t.map(t=>({displayText:t,callback(){v.zl.set(ll.f3,{provider:e,modelId:t})}}))}let lZ=[{displayText:"Anthropic",children:lq("anthropic",["claude-3-5-sonnet-20240620","claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-5-sonnet-20241022","claude-3-haiku-20240307"])},{displayText:"OpenAI",children:lq("openai",["ft:gpt-4o-2024-08-06:figma-development::A95wrEFE:ckpt-step-732","gpt-3.5-turbo","gpt-3.5-turbo-0301","gpt-3.5-turbo-0613","gpt-3.5-turbo-1106","gpt-3.5-turbo-0125","gpt-3.5-turbo-16k","gpt-3.5-turbo-16k-0613","gpt-4","gpt-4-0314","gpt-4-0613","gpt-4-1106-preview","gpt-4-vision-preview","gpt-4-turbo-2024-04-09","gpt-4o-2024-05-13","gpt-4o-2024-08-06","gpt-4o-mini-2024-07-18","o1-preview-2024-09-12","o1-mini-2024-09-12"])}];function l0(){let{toggleDropdown:e,dropdownTargetRef:t,Dropdown:n,isDropdownShown:a}=(0,la.B)(),o=(0,v.md)(ll.f3);return r.createElement(r.Fragment,null,a&&r.createElement(n,{items:lZ,showPoint:!0,lean:"left"}),r.createElement("div",{ref:t},r.createElement(nn.E,{className:T.cx.wFull.flex.alignCenter.justifyBetween.cursorPointer.b1.colorBorder.bRadius4.$,onClick:e},r.createElement("span",{className:T.cx.p4.$},null==o?"Pick a model":o.modelId),r.createElement(rh.U,{svg:lJ.A},r.createElement(o8.r,null)))))}function l1(){let e=(0,o9.VW)(),t=(0,lo.L4)(),n=(0,lo.Vq)(),[a,l]=r.useState(""),i=(0,o.wA)(),s=(0,v.md)((0,ll.R)(t?.guid||""));if(!e||!n)return r.createElement(l8,null);let c=()=>{a.length&&(l(""),(0,lo.Ww)(e,e=>{let t=Date.now();return{...e,messages:[...e.messages||[],{id:(0,tC.g)(),createdAt:t,content:a}]}}),n2.Y5.triggerAction("commit"),(0,ll.kX)(e,{openPreview:p}))},p=()=>{let e={x:Math.max(t?.size.x||lk.x,lA.x),y:Math.max(t?.size.y||lk.y,lA.y)};i((0,le.ES)({type:lP})),i((0,le.to)({type:lC,data:{initialSize:e}}))},m=(t,n)=>{(0,lo.Ww)(e,e=>{if(!e.props)return e;let a=e.props.map(e=>{if(e.name!==t)return e;try{return o4.Ts.parse({...e,value:n})}catch(t){return console.error(`Invalid value for prop "${e.name}":`,t.errors),e}});return{...e,props:a}})};return r.createElement(r.Fragment,null,r.createElement(rm.Zk,null,r.createElement(lr.r,{titleTx:r.createElement("span",null,(0,d.t)("living_designs.properties_panel.title")),icon:r.createElement(o3.O,{onClick:p})}),r.createElement("div",{className:T.cx.flex.flexColumn.gap12.$},r.createElement("div",{className:T.cx.flex.flexColumn.gap8.$},!!n.messages?.length&&r.createElement("div",{className:T.cx.flex.flexColumn.$},n.messages.map((e,t)=>r.createElement(l2,{key:e.id,message:e,artwork:0===t?r.createElement(o5.N,null):r.createElement("div",{className:T.cx.w16.h16.flex.justifyCenter.$},r.createElement("span",{className:T.cx.textBodyMedium.colorTextSecondary.$},(0,d.t)("living_designs.properties_panel.interactions.version_number",{number:t}))),variant:0===t?"primary":"secondary"}))),r.createElement(ow.Ad,{label:void 0,input:r.createElement("div",{className:T.cx.flex.gap8.$},r.createElement(l4,{value:a,placeholder:(0,d.t)("living_designs.properties_panel.description_input.placeholder"),handleChange:l,handleSubmit:c}),r.createElement(n3.$n,{onClick:c,disabled:!a.length||"loading"===s.status,"aria-label":(0,d.t)("living_designs.properties_panel.interactions.add_button.label")},"loading"===s.status?r.createElement(t_.k,null):r.createElement(o7.W,null))),appendedClassName:"living_designs_panel--textareaRow--V8RnZ"}),r.createElement(ow.Ad,{label:"Model ID",input:r.createElement(l0,null)})),n.props&&!!n.props.length&&r.createElement("div",{className:T.cx.flex.flexColumn.gap12.$},r.createElement("span",{className:T.cx.textBodyMediumStrong.px16.$},(0,d.t)("living_designs.properties_panel.properties_header")),n.props.map(e=>r.createElement("div",{key:e.name,className:T.cx.$},r.createElement(lH,{prop:e,onChange:t=>m(e.name,t)})))))),r.createElement(l8,null),e.guid===t?.guid&&r.createElement(rm.Zk,{className:lQ.rq},r.createElement(oA.z,{onClick:()=>(0,lo.T9)(t),disabled:"loading"===s.status},(0,d.t)("living_designs.properties_panel.settings.reset_button"))))}function l2({message:e,artwork:t,variant:n="primary"}){return r.createElement("div",{className:T.cx.flex.px16.py4.gap8.$},t&&r.createElement("div",{style:{"--color-icon":"var(--color-icon-assistive)"}},t),r.createElement("div",null,r.createElement("span",{className:T.cx.textBodyMedium.case([["primary"===n,T.cx.colorText],["secondary"===n,T.cx.colorTextSecondary]]).$},e.content)))}function l4({value:e,placeholder:t,handleChange:n,minHeight:a,handleSubmit:o,disabled:l}){let{inputRef:i,inputProps:{onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m}}=(0,o6.X)({onChange:function(e){n(e.target.value)}});return r.createElement(ln.v,{ref:e=>{e?.textarea&&(i.current=e.textarea)},value:e,placeholder:t,onChange:s,onFocus:c,onMouseUp:d,onMouseLeave:p,onKeyUp:m,minHeight:a,submit:o,bypassModifiers:!0,preventSubmitOnBlur:!0,disabled:l})}function l8(){let[e,t]=(0,v.fp)(ll.Zl),n=(0,o.wA)(),a=n=>{t({...e,serializer:n})};return r.createElement(rm.Zk,null,r.createElement(lr.r,{titleTx:r.createElement("span",null,(0,d.t)("living_designs.properties_panel.settings.header"))}),r.createElement(ow.Ad,{label:(0,d.t)("living_designs.properties_panel.settings.serializer_dropdown"),input:r.createElement("div",{className:T.cx.flex.flexColumn.gap4.$},r.createElement("select",{value:e.serializer,onChange:e=>a(e.target.value),className:`${T.cx.p8.$}`},[{label:"Hybrid",serializer:"hybrid"},{label:"Sites",serializer:"sites"},{label:"Sparse Tree Enrichment",serializer:"ste"}].map(({label:e,serializer:t})=>r.createElement("option",{key:e,value:t},e)))),alwaysShowLabel:!0}),r.createElement(ow.Ad,{label:(0,d.t)("living_designs.properties_panel.settings.eval_runs"),input:r.createElement(lt.Ht,{value:e.evaluationRuns,onValueChange:n=>{t({...e,evaluationRuns:n})},dispatch:n,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("living_designs.properties_panel.settings.eval_runs"),min:1,max:5}),alwaysShowLabel:!0}),r.createElement(ow.Ad,{label:(0,d.t)("living_designs.properties_panel.settings.backoff_delay"),input:r.createElement(lt.Ht,{value:e.evalBackoffDelay,onValueChange:n=>{t({...e,evalBackoffDelay:n})},dispatch:n,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("living_designs.properties_panel.settings.backoff_delay"),min:0,max:6e4}),alwaysShowLabel:!0}),r.createElement(oA.z,{onClick:()=>lu(n,e)},(0,d.t)("living_designs.properties_panel.settings.create_evals_button")))}function l3(){return r.createElement(aX.i,null,r.createElement(l1,null))}var l5=n(807616),l7=n(234587),l6=n(572304),l9=n(94500),ie=n(832637),it=n(742311),ia=n(205135);class ir extends n0.o6{render(){return r.createElement(rm.Zk,null,r.createElement(rm.fI,null,r.createElement(rm.xw,null,(0,d.tx)("proto.menu.background"))),r.createElement(io,{...this.props}))}}function io(e){let t=r.useRef(null),n=r.useRef(null),a=(0,eu.GS)(),{dispatch:o,pickerShown:l,prototypeBackgroundColor:i}=e,s=r.useCallback(()=>{let e=a?n.current:t.current;if(l&&l.id===tb.$T)o(eZ.XE());else if(e&&e instanceof HTMLElement){let t=(0,lF.cn)(e);o(eZ.u1({id:tb.$T,initialX:t.x,initialY:t.y}))}},[o,l,a]),c=r.useCallback((e,t)=>{o((0,l9._P)({name:"Prototype Background Modified"})),n2.Y5.updateSelectionProperties({prototypeBackgroundColor:e},{shouldCommit:t})},[o]),d=(0,aq._W)(i,{r:0,g:0,b:0,a:1}),p=r.createElement("div",{className:"prototype_background_panel--colorValueContainer--CEbzl paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},r.createElement(n4.J,{onClick:s,color:d,opacity:d.a,recordingKey:n0.Pt(e,"chit"),className:"prototype_background_panel--chit--F--d0 paint_panels--chit--twQEy"}),r.createElement(ia.AN,{className:"prototype_background_panel--color--e5Pc8 paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:n6.TI,property:d,onChange:c,recordingKey:n0.Pt(e,"colorInput"),noBorderOnFocus:!0}));return r.createElement(r.Fragment,null,a?r.createElement(lB.TN,{ref:n},p):r.createElement(rm.fI,{ref:t,className:"prototype_background_panel--colorRow--MtNeY"},p),l&&l.id===tb.$T&&r.createElement(lV.h3,{disabledVariableIds:new Set,initialPosition:new tf.Mi(l.initialX??0,l.initialY??0),color:d,boundVariable:null,onChange:c,recordingKey:n0.Pt(e,"colorPicker")}))}ir.displayName="PrototypeBackgroundPanel";var il=n(720245),ii=n(902237),is=n(158970),ic=n(333780),id=n(992271),ip=n(276660),im=n(371435),iu=n(834447);let iE="prototype_device_panel--deviceSelect--wnOgI",ig="prototype_device_panel--deviceOption--rvW-q",iy="prototype_device_panel--inactiveLabel--UEKyk prototype_device_panel--activeLabel--l162n",i_="prototype_device_panel--labelInactive--pv4Sf",ih="prototype_device_panel--deviceDropdownChevron--kq9TV",iv="prototype_device_panel--deviceDropdownInput--AxG9E";var ib=n(537545),iS=n(64111);class iT extends ip.I{}class iN extends ip.Y{}class iI extends r.PureComponent{constructor(){super(...arguments),this.deviceInfo=()=>id.hY[this.props.prototypeDevice.presetIdentifier],this.shouldShowModelDropdown=()=>{let e=this.deviceInfo();return id.yr[e?.deviceName||""].length>1},this.onModelChange=e=>{if(!this.deviceInfo())return;let t=id.hY[e];if(!t)return;let n=this.props.prototypeDevice.rotation;n2.Y5.updateSelectionProperties({prototypeDevice:{type:"PRESET",size:t.framePresetSize,presetIdentifier:e,rotation:n}})},this.renderModelDropdown=(e,t,n)=>{if(!e)return;let a=r.createElement(ix,{dispatch:this.props.dispatch,presetIdentifier:this.deviceInfo().presetIdentifier,dropdownShown:this.props.dropdownShown,onChange:this.onModelChange,recordingKey:n0.Pt(this.props,"modelDropdown")}),o=t?r.createElement(lB.dx,{left:a,right:n}):r.createElement(lB.TN,null,a);return r.createElement("div",null,!this.props.isUI3&&r.createElement(rm.hl,null,r.createElement(rm.UZ,{className:i_},(0,d.tx)("presets.device_panel.model"))),this.props.isUI3?o:r.createElement(rm.fI,null,a))},this.cssForCurrentDeviceRotation=()=>{if("NONE"===this.props.prototypeDevice.type)return;let e="";switch("MICROSOFT_SURFACE_PRO_4"===this.props.prototypeDevice.presetIdentifier&&(e="scale(0.65)"),this.props.prototypeDevice.rotation){case"NONE":default:return;case"CCW_90":return`rotate(-90deg) ${e}`}},this.renderDevicePreview=()=>{let e=this.deviceInfo();if(!e)return;let t=(0,aq._W)(this.props.prototypeBackgroundColor,{r:0,g:0,b:0,a:0}),n=n6.z5.format(t),a=t.r>.9&&t.g>.9&&t.b>.9,o=`1px solid ${a?"#EFEFEF":"transparent"}`,l=r.createElement("div",{className:"prototype_device_panel--devicePreview--T2Tzn",style:{backgroundColor:n,border:o}},r.createElement("img",{className:"prototype_device_panel--deviceImage--Wpr8Y",src:e.thumbnailUrl,style:{transform:this.cssForCurrentDeviceRotation()},alt:`${e.getI18nDeviceName()}`}));return r.createElement("div",null,!this.props.isUI3&&r.createElement(rm.hl,null,r.createElement(rm.UZ,{className:i_},(0,d.tx)("presets.device_panel.preview"))),this.props.isUI3?r.createElement(lB.TN,{appendedClassName:iu.Rk},l):r.createElement("div",{className:"prototype_device_panel--devicePreviewContainer--pC-H4"},l))},this.onChangeOrientation=e=>{let t=this.props.prototypeDevice;if("NONE"===t.type)return;let n=t.size.y>t.size.x,a=t.rotation;a=n?"PORTRAIT"===e?"NONE":"CCW_90":"PORTRAIT"===e?"CCW_90":"NONE",n2.Y5.updateSelectionProperties({prototypeDevice:{...t,rotation:a}})},this.currentDeviceOrientation=()=>{let e=this.props.prototypeDevice;return"NONE"===e.type?"PORTRAIT":e.size.y>e.size.x?"NONE"===e.rotation?"PORTRAIT":"LANDSCAPE":"NONE"===e.rotation?"LANDSCAPE":"PORTRAIT"}}render(){let e=this.props.prototypeDevice,t=r.createElement(iA,{dispatch:this.props.dispatch,prototypeDevice:this.props.prototypeDevice,isUI3:this.props.isUI3,dropdownShown:this.props.dropdownShown,recordingKey:n0.Pt(this.props,"deviceDropdown")}),n=r.createElement(iT,{property:this.currentDeviceOrientation(),onChange:this.onChangeOrientation,recordingKey:n0.Pt(this.props,"orientationControl"),className:"prototype_device_panel--orientationControl--YdZ-v"},r.createElement(iN,{value:"PORTRAIT",svg:iS.A}),r.createElement(iN,{value:"LANDSCAPE",svg:ib.A})),a=r.createElement(il.bL,{onChange:this.onChangeOrientation,recordingKey:n0.Pt(this.props,"orientationControl"),value:this.currentDeviceOrientation(),legend:r.createElement(ii.q,null,(0,d.t)("presets.device_panel.rotation"))},r.createElement(il.c$,{"aria-label":(0,d.t)("presets.device_panel.rotation.portrait"),value:"PORTRAIT",icon:r.createElement(rh.U,{svg:iS.A},r.createElement(is.l,null))}),r.createElement(il.c$,{"aria-label":(0,d.t)("presets.device_panel.rotation.landscape"),value:"LANDSCAPE",icon:r.createElement(rh.U,{svg:ib.A},r.createElement(ic.J,null))})),o=(0,s.kc)().prototype_fpl_conversion?a:n,l=(0,id.$X)(e.type||"NONE",e.presetIdentifier),i=r.createElement(rm.fI,null,t,l&&o),c=this.deviceInfo()&&this.shouldShowModelDropdown(),p=l&&!c?r.createElement(lB.dx,{left:t,right:o}):r.createElement(lB.TN,null,t),m=r.createElement(iP,{prototypeDevice:this.props.prototypeDevice,dispatch:this.props.dispatch,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:n0.Pt(this.props,"deviceSizeInputs")});return r.createElement(rm.Zk,null,r.createElement(rm.fI,{className:"prototype_device_panel--panelTitleRowOuter--wkKKy collapsible_property_panel--panelTitleRowOuter--i5K0R"},r.createElement(rm.xw,{extended:this.props.isUI3},this.props.isUI3?(0,d.tx)("presets.device_panel.prototype_settings"):(0,d.tx)("presets.device_panel.device"))),this.props.isUI3?p:i,this.renderModelDropdown(!!c,l,o),this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&m,this.props.isUI3&&r.createElement(io,{pickerShown:this.props.pickerShown,dispatch:this.props.dispatch,prototypeBackgroundColor:this.props.prototypeBackgroundColor,recordingKey:n0.Pt(this.props,"backgroundPanel")}),this.renderDevicePreview(),!this.props.isUI3&&"CUSTOM"===this.props.prototypeDevice.type&&m)}}function iP(e){let t=r.useCallback(t=>{n2.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:t,y:e.prototypeDevice.size.y},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.y,e.prototypeDevice.rotation]),n=r.useCallback(t=>{n2.Y5.updateSelectionProperties({prototypeDevice:{type:"CUSTOM",size:{x:e.prototypeDevice.size.x,y:t},rotation:e.prototypeDevice.rotation}})},[e.prototypeDevice.size.x,e.prototypeDevice.rotation]),a=r.createElement(lt.$j,{className:"prototype_device_panel--scrubbableInputLeftCol--P2T66 prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--leftColInput--pAJSy prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.x,onValueChange:t,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("presets.device_panel.device_width_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(e,"deviceWidth")},r.createElement("span",{className:iy},(0,d.tx)("proto.device_panel.width"))),o=r.createElement(lt.$j,{className:"prototype_device_panel--scrubbableInput--0TFVb",inputClassName:"prototype_device_panel--input--vNirJ",dispatch:e.dispatch,value:e.prototypeDevice.size.y,onValueChange:n,smallNudgeAmount:e.smallNudgeAmount,bigNudgeAmount:e.bigNudgeAmount,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("presets.device_panel.device_height_tooltip"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(e,"deviceHeight")},r.createElement("span",{className:iy},(0,d.tx)("proto.device_panel.height")));return(0,eu.GS)()?r.createElement(lB.dx,{left:a,right:o}):r.createElement(rm.fI,null,a,o)}iI.displayName="PrototypeDevicePanel";let iC=lU.l6,ik=lU.c$;class iA extends n0.o6{constructor(){super(...arguments),this.formatter={format:e=>"NONE"===e?this.props.isUI3?(0,d.t)("proto.frame_preset_panel.no_device"):(0,d.t)("proto.frame_preset_panel.none"):"CUSTOM"===e?(0,d.t)("proto.frame_preset_panel.custom_size"):"PRESENTATION"===e?(0,d.t)("proto.frame_preset_panel.presentation"):e.getI18nDeviceName(),isEqual:(e,t)=>"NONE"===e||"CUSTOM"===e||"PRESENTATION"===e||"NONE"===t||"CUSTOM"===t||"PRESENTATION"===t?e===t:e.presetIdentifier===t.presetIdentifier},this.onChange=e=>{(0,l9.$J)(e,this.props.prototypeDevice);let t=this.props.prototypeDevice.type,n=t;n="NONE"===e?"NONE":"PRESENTATION"===e?"PRESENTATION":"CUSTOM"===e?"CUSTOM":"PRESET",this.props.dispatch((0,l9._P)({name:"Prototype Device Type Changed",params:{oldType:this.props.prototypeDevice.presetIdentifier||t,newType:e.presetIdentifier||n,isInlinePreviewOpened:v.zl.get(im.h).modalStatus===im.b.OPEN}}))},this.renderPresetOption=(e,t)=>{let n=(0,id.Fh)(e,this.props.prototypeDevice);if(null===n)return null;let a=n.framePresetSize;return r.createElement(ik,{value:n,key:t,recordingKey:n0.Pt(this.props,n.deviceName)},r.createElement("div",{className:ig},r.createElement("span",null,n.getI18nDeviceName()),r.createElement("span",null,a.x,"\u200A\xd7\u200A",a.y)," "))}}render(){let e;return e="NONE"===this.props.prototypeDevice.type?"NONE":"PRESENTATION"===this.props.prototypeDevice.type?"PRESENTATION":"CUSTOM"===this.props.prototypeDevice.type?"CUSTOM":id.hY[this.props.prototypeDevice.presetIdentifier]||"NONE",r.createElement(iC,{className:iE,chevronClassName:ih,inputClassName:iv,id:"prototype-device-select",property:e,formatter:this.formatter,onChange:this.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--deviceDropdown--ufbuZ",recordingKey:n0.Pt(this.props,"select"),dropdownAlignment:"right"},r.createElement(ik,{value:"NONE",recordingKey:n0.Pt(this.props,"NONE")}),r.createElement(lU.sK,null),id.r6.map(this.renderPresetOption),r.createElement(lU.sK,null),id.J_.map(this.renderPresetOption),r.createElement(lU.sK,null),id.AG.map(this.renderPresetOption),r.createElement(lU.sK,null),id.$w.map(this.renderPresetOption),r.createElement(lU.sK,null),r.createElement(ik,{value:"CUSTOM",recordingKey:n0.Pt(this.props,"CUSTOM")},r.createElement("div",{className:ig},r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.custom_size")),r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.fit")))),r.createElement(ik,{value:"PRESENTATION",recordingKey:n0.Pt(this.props,"PRESENTATION")},r.createElement("div",{className:ig},r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.presentation")),r.createElement("span",null,(0,d.tx)("proto.frame_preset_panel.fill")))),r.createElement(lU.sK,null),id.dr.map(this.renderPresetOption))}}iA.displayName="DeviceDropdown";let iw=lU.l6,iO=lU.c$;class ix extends n0.o6{constructor(){super(...arguments),this.formatter={format:e=>{let t=id.hY[e];return t?t.getI18nStyleName():(0,d.t)("proto.frame_preset_panel.missing")},isEqual:(e,t)=>e===t},this.renderStyleOption=(e,t)=>{let n=e.presetIdentifier;return r.createElement(iO,{value:n,key:t,recordingKey:n0.Pt(this.props,n)},id.hY[n].getI18nStyleName())}}render(){let e=id.hY[this.props.presetIdentifier];if(!e)return null;let t=id.yr[e.deviceName],n=this.props.presetIdentifier;return r.createElement(iw,{className:iE,chevronClassName:ih,inputClassName:iv,id:"prototype-style-select",property:n,formatter:this.formatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,dropdownClassName:"prototype_device_panel--modelDropdown--WbHYJ",recordingKey:n0.Pt(this.props,"select")},t.map(this.renderStyleOption))}}ix.displayName="ModelDropdown";var iR=n(536825),iM=n(939683),iL=n(529004),iD=n(723081),iK=n(46878),iF=n(634238),iV=n(234945),iU=n(279702),iB=n(113468),iG=n(107244),iz=n(248752);function iH(e){return e??"Default"}let iW=r.createContext({getNodeName:iH}),iY=r.memo(function({getNodeName:e=iH,children:t}){let n=r.useMemo(()=>({getNodeName:e}),[e]);return r.createElement(iW.Provider,{value:n},t)});var i$=n(325682),iX=n(73349),ij=n(38340),iQ=n(908946),iJ=n(987850),iq=n(239737),iZ=n(222478),i0=n(709731),i1=n(30075),i2=n(384775),i4=n(406385),i8=n(556298);function i3(){let e=(0,o.wA)(),t=(0,o.d4)(e=>(0,a0.Yh)(e.mirror.appModel,iZ.JT.MAGIC_LINK)),n=(0,iq.PE)(),{withinMeter:a}=(0,iJ.X)(iZ.JT.MAGIC_LINK);return n&&a?r.createElement("span",{className:"magic_link--magicLinkButton--CWefW","data-testid":"magic-link-entry"},r.createElement(eS.K,{recordingKey:n0.Pt("prototypeInteractionList","magicLinkButton"),"aria-label":(0,s.kc)().prototype_ai_magic_link_name_change?(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),onClick:()=>{(0,i2.$I)({moduleToOpen:{type:"custom",module:r.createElement(i4.p,null),name:i1.Sn.MAGIC_LINK,beforeModuleOpen:()=>{e((0,l9.Zh)({name:"prototype.ai_magic_link_entry_clicked",params:{source:"properties_panel"}})),(0,i0.B3)(iZ.JT.MAGIC_LINK),t&&(0,i0.Ag)(iZ.JT.MAGIC_LINK,i8.e,{})}},trackingData:{source:"prototype_magic_link_triggered"}})},htmlAttributes:{"data-tooltip":(0,s.kc)().prototype_ai_magic_link_name_change?(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip-v2"):(0,d.t)("fullscreen.toolbar.prototyping-add-interactions-tooltip"),"data-tooltip-type":rf.Ib.TEXT,"data-tooltip-show-above":!0}},r.createElement(iQ.B,null))):null}var i5=n(422237);let i7=(0,i5.ex)("prototype_info",function(e){let{tooltipText:t}=e;return r.createElement("div",{className:T.cx.flex.justifyCenter.itemsCenter.$},r.createElement("span",{className:T.cx.m6.flexGrow1.$,style:{maxWidth:144}},t))},e=>({tooltipText:e.getAttribute("data-tooltip-text")}));var i6=n(139055),i9=n(930269),se=n(819785),st=n(695038),sn=n(612325);let sa=new iD.JV,sr=new iD.Eq,so=new iD.sX,sl=r.memo(function({filterInteractionCategory:e}){let t=(0,o.wA)(),n=(0,o.d4)(ij.Cy),a=(0,o.d4)(ij.n9),l=(0,o.d4)(ij.DV),c=(0,o.d4)(sd),d=(0,o.d4)(iV.dK),p=(0,o.d4)(iV.Xt),m=(0,ij.a2)(),u=(0,ij.R)(),E=(0,o.d4)(sm),g=(0,o.d4)(sc),y=Object.keys(p).length>1,_=su(),h=function(){let e=su(),t=(0,o.d4)(sp);return!!e&&!!t&&t.selectionOverrides[i.YnC.PROTOTYPE_INTERACTIONS]}(),f=(0,U.q5)(),v=(0,iM.U)(),b=(0,aw.cJ)(),S=r.useMemo(()=>new iD.cP(d),[d]),T=r.useCallback(e=>S.format(e),[S]),N=r.useRef(null),I=e=>{n2.Y5.updateSelectionProperties({prototypeInteractions:e},{shouldCommit:iU.zk.NO_BUT_TRACK_AS_EDIT}),n2.Y5.commit()},P=(0,it.Zj)(Object.keys(p)),C=r.createElement(si,{interactionGroups:m,inheritedInternalInteractionGroups:u,mixed:y,isOrInInstance:_,openFile:f,dispatch:t,currentSelectedProperty:c,onChange:(e,t)=>{let r=e.map(e=>e.interactions).reduce((e,t)=>e.concat(t),[]),o=new Set,l=[];for(let e of r){let t=l6.dI(e.id);if(t&&!o.has(t))l.push(e);else{if(!(t=i.glU.generateUniqueID()))continue;let n=l6.sH(t);if(!n)continue;l.push({...e,id:n})}t&&o.add(t)}t===iB.J.NORMAL?l=[...l,...a]:t===iB.J.INHERITED_INTERNAL&&(l=[...n,...l]),I(l)},onAddProperty:e=>{e.stopPropagation();let t=[],r=[];for(let e of Object.keys(p)){let n=i.glU.generateUniqueID();if(!n)return;let a=l6.sH(n);if(!a)return;let o={id:a,sourceNodeID:l6.sH(e)??l6.Hr,event:{interactionType:function(e,t=!1){let n=new Set;for(let{event:t}of e)n.add(t.interactionType);for(let e of sE)if((!(0,s.kc)().sts_interaction_interop||!t||"DRAG"!==e)&&!n.has(e))return e;return"ON_KEY_DOWN"}(m,b)}};o.stateManagementVersion=1,o.actions=[{connectionType:"NONE"}],t.push(o);let l=(0,tH.kh)(d,e);r.push(l?l.guid:"")}let o=t.map(e=>iL.d({nodeID:e.sourceNodeID,interactionID:e.id}));if(o.length>0){i.glU.setSelectedInteractions(o);let e=(0,lF.cn)(N.current);sf(new tf.Mi(e.x,e.y+(0,nf.jz)(i9.rightNavGridRowHeight)))}let l=[...n,...t,...a];v("prototype_interaction_added",{interactionCount:l.length,sourceTlfIds:JSON.stringify(r)}),I(l)},onDeleteProperty:(e,t)=>{let n=(t===iB.J.NORMAL?m:u).filter((t,n)=>e.has(n)),a=[];for(let e of n)a.push(...e.interactions);let r=sh(a);a5.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(r)),n2.Y5.deselectProperty()},shouldIgnoreKeyboardEvents:l.length>0||c.type!==i.rrT.PROTOTYPE_INTERACTION&&c.type!==i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,isValidPrototypingSourceSelected:E,showResetInteractionsButton:h,toggleScrollBehaviorPicker:()=>{if(g?.id===tb.AO)t(eZ.XE());else{let e=(0,lF.cn)(N.current);t(eZ.u1({id:tb.AO,initialX:e.x,initialY:e.y}))}},headerAccessory:P&&r.createElement(i3,null),inSites:b,filterInteractionCategory:e});return r.createElement(iY,{getNodeName:T},b?C:r.createElement(rm.Zk,{"data-onboarding-key":"prototypePanel",ref:N,"data-testid":"prototype-interaction-list"},C))});function si(e){let t=r.useRef(!1),n=(0,eu.GS)(),a=(0,s.kc)().sts_interaction_interop&&!!e.filterInteractionCategory,o=!a||e.filterInteractionCategory===iB.J.NORMAL,l=e.isOrInInstance&&e.inheritedInternalInteractionGroups.length>0,c=a?e.filterInteractionCategory===iB.J.INHERITED_INTERNAL&&l:l,p=n?r.createElement("div",{className:"prototype_interaction_list--categoryRow--Xxfm4"},r.createElement(lD.J,{className:"prototype_interaction_list--categoryLabel--0dGOM"},(0,d.tx)("proto.interaction_list.variant_interactions"))):r.createElement(rm.fI,null,r.createElement(rm.UZ,{className:"prototype_interaction_list--label--dGwgy"},(0,d.tx)("proto.interaction_list.variant_interactions")));return r.createElement(r.Fragment,null,o&&r.createElement(iz.h6,{title:e.inSites?"":(0,d.t)("proto.title_interactions"),stylePickerShown:{isShown:!1},addProperty:e.onAddProperty,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,hideAddButton:!e.isValidPrototypingSourceSelected,renderProperty:(n,a,o,l,i,c,d,p,m)=>!(0,s.kc)().sts_interaction_interop&&e.inSites&&(0,i6.p4)(n.interactions)?r.createElement(r.Fragment,{key:a}):r.createElement(ss,{interactionGroups:e.interactionGroups,interactionGroup:n,index:a,selected:o,hasFocus:i,isDragging:l,singletonRow:e.interactionGroups.length<=1,onMouseDown:d,onMouseMove:p,onMouseUp:m,dispatch:e.dispatch,category:iB.J.NORMAL,autoOpenVariablePicker:t,recordingKey:n0.Pt("prototypeInteractionList",a),key:a,inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,iB.J.NORMAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INTERACTION,propertyList:e.interactionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,iB.J.NORMAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:"prototypeInteractionList",boldHeaderRow:e.interactionGroups.length>=1||e.inheritedInternalInteractionGroups.length>=1,showResetInteractionsButton:e.showResetInteractionsButton,onResetInteractions:a5.nc.user("reset-instance-interactions",()=>i.glU.resetSymbolOverrides(i.YnC.PROTOTYPE_INTERACTIONS)),headerAccessory:e.headerAccessory}),c&&p,c&&r.createElement(iz.h6,{title:"",stylePickerShown:{isShown:!1},addProperty:S.lQ,hideAddButton:!0,toggleScrollBehaviorPicker:e.toggleScrollBehaviorPicker,renderProperty:(n,a,o,l,i,s,c,d,p)=>r.createElement(ss,{interactionGroups:e.inheritedInternalInteractionGroups,interactionGroup:n,key:a,index:a,selected:o,hasFocus:i,isDragging:l,singletonRow:e.inheritedInternalInteractionGroups.length<=1,onMouseDown:c,onMouseMove:d,onMouseUp:p,dispatch:e.dispatch,category:iB.J.INHERITED_INTERNAL,autoOpenVariablePicker:t,recordingKey:n0.Pt("prototypeInheritedInternalInteractionList",a),inSites:e.inSites}),openFile:e.openFile,onChange:t=>e.onChange(t,iB.J.INHERITED_INTERNAL),currentSelectedProperty:e.currentSelectedProperty,selectedPropertyType:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,propertyList:e.inheritedInternalInteractionGroups,pickerShown:null,dispatch:e.dispatch,onDeleteProperty:t=>e.onDeleteProperty(t,iB.J.INHERITED_INTERNAL),shouldIgnoreKeyboardEvents:e.shouldIgnoreKeyboardEvents,recordingKey:n0.Pt("prototypeInheritedInternalInteractionList")}))}function ss({interactionGroups:e,interactionGroup:t,index:n,hasFocus:a,isDragging:l,selected:c,singletonRow:p,onMouseDown:m,onMouseMove:u,onMouseUp:E,dispatch:g,category:y,recordingKey:_,inSites:h}){let f=(0,eu.GS)(),{getNodeName:b}=r.useContext(iW),T=(0,o.d4)(ij.DV),N=(0,ij.a2)(),I=(0,o.d4)(sc),P=I?.id===tb.o$?I:null,C=(0,o.d4)(iV.dK),[k,A]=r.useState(!1),w=(0,v.md)(iF.NE)?sr:sa,O=r.useContext(i6.qd),x=function(e,t){let n=new Set(t.map(e=>{let t=iL.s(e);return t?l6.dI(t.interactionID):""}).filter(e=>""!==e));for(let t of e.interactions){let e=l6.dI(t.id);if(e&&n.has(e))return!0}return!1}(t,T),R=r.useRef(null),M=r.useRef(null),L=r.useCallback(()=>{let e=f&&h?M.current:ru.findDOMNode(R.current);sf((0,lF.cn)(e))},[h,f]),D=r.useCallback(()=>{i.glU.setSelectedInteractions([]),g(eZ.XE()),n2.Y5.deselectProperty()},[g]),K=n=>{if(!R||!M)return;let a=s_(t);if(n.metaKey||n.ctrlKey)x?a=T.filter(e=>!a.includes(e)):a.push(...T);else if(n.shiftKey){var r;let n,o;let l=(r=t.key,e.findIndex(({key:e})=>e===r));if(-1===l)return;let i=function(e,t){let n=1/0,a=e;for(let r of t){let t=Math.abs(e-r);t<n&&(a=r,n=t)}return a}(l,function(e,t){let n=new Set,a=new Set(t);for(let t=0;t<e.length;t++)s_(e[t]).some(e=>a.has(e))&&n.add(t);return n}(e,T)),s=(n=l,o=i,l>i&&(n=i,o=l),e.slice(n,o+1));for(let e of(a=[...T],s))a.push(...s_(e))}i.glU.setSelectedInteractions(a),n2.Y5.updateAppModel({currentSelectedProperty:{type:y===iB.J.NORMAL?i.rrT.PROTOTYPE_INTERACTION:i.rrT.PROTOTYPE_INHERITED_INTERNAL_INTERACTION,indices:[]}}),a.length?P&&P.shouldPin?h&&(a.length>1||a.includes(T[0]))&&D():L():D()},F=(0,o.d4)(iG.ZM),V=!1,U=null,B=null;for(let e of t.interactions)if(!U&&e.actions&&e.actions.length>0)U=e.actions[0],B=e;else if(sy(U,b,f,F)!=sy((e.actions??[])[0],b,f,F)){V=!0;break}let G=()=>{let e=sh(t.interactions);i.glU.hoverInteractions(e),A(!0)},z=()=>{i.glU.hoverInteractions([]),A(!1)},H=e=>{e.stopPropagation()},W=e=>{e.stopPropagation();let n=sh(t.interactions);a5.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(n)),n2.Y5.deselectProperty(),n2.Y5.commit()},Y=!1,$=!1;if(y===iB.J.NORMAL){for(let e of t.interactions){if(!e.actions||0===e.actions.length)continue;let t=e.actions[0];if(!t||"SWAP_STATE"!==t.navigationType)continue;let n="";if(t.transitionNodeID){let e=C.get(l6.dI(t.transitionNodeID));if(e){if(e.isState)n=e.parentGuid||"";else{Y=!0;break}}}let a=i.glU.getContainingStateGroupOrSelf(l6.dI(e.sourceNodeID??l6.Hr))||"";if(""===a||""!==n&&a!==n){Y=!0;break}}let n=["ON_CLICK","MOUSE_DOWN","MOUSE_UP"].includes(t.event.interactionType??""),a=e.some(e=>"ON_HOVER"===e.event.interactionType);$=n&&a}Y=y!==iB.J.INHERITED_INTERNAL&&Y;let X=function(e,t,n){if(e!==iB.J.INHERITED_INTERNAL)return null;let a=n.find(e=>e.key===t.key&&e.interactions.length===t.interactions.length&&1===t.interactions.length&&function(e,t){let n=void 0!==e.actions&&e.actions.length>=1,a=void 0!==t.actions&&t.actions.length>=1;if(!n||!a)return!1;let r=e.actions.every(e=>"UPDATE_MEDIA_RUNTIME"===e.connectionType),o=e.actions.every(e=>l6.fn(e.transitionNodeID));var l=!1;for(let e of t.actions)if("INTERNAL_NODE"===e.connectionType&&"SWAP_STATE"===e.navigationType){l=!0;break}return r&&o&&l}(e.interactions[0],t.interactions[0]));return a?.interactions[0]??null}(y,t,e),j=(0,a7.ZC)(X),Q=(0,iM.U)();if(r.useEffect(()=>{null===j&&X&&Q("prototype_interaction_conflict_override_created",{interaction_type:t.interactions[0].event?.interactionType,action_type:X.event?.interactionType})}),(0,s.kc)().sts_interaction_interop&&t.event.interactionType&&O&&O!==(0,i$.hD)(t.event.interactionType)||(0,s.kc)().sts_interaction_interop&&"mouse"===O&&(0,i6.zL)(t.interactions))return null;let J=y===iB.J.INHERITED_INTERNAL&&N.some(e=>e.key===t.key)&&!X,q=c&&a,Z=x&&!c,ee=new iD.js(f,F),et=(0,iD.mj)(U),en=B?.actions?.length??0,ea=(0,s.kc)().sts_interaction_interop&&en>1?(0,d.t)("sites.panel.interaction_summary",{numActions:en}):V||!U||"NONE"===et?void 0:ee.format(et),er=r.createElement(n7.Z,null),eo=Y||$||J,el=Y?(0,d.t)("proto.prototype_panel.this_interaction_must_swap_from_a_variant_to_another_variant_within_the_same_component_set_tooltip"):$?(0,d.t)("proto.prototype_panel.prototype_multiple_interactions_mouse_and_hover_tooltip"):J?(0,d.t)("proto.prototype_panel.this_interaction_will_not_be_triggered_as_interactions_on_instances_are_triggered_before_inherited_internal_interactions_tooltip"):"",ei=r.createElement(ow.Y9,{ref:M,"data-testid":`prototypeInteractionItem-${n}`,singletonRow:p,dragging:l,onMouseDown:m,onMouseMove:u,onMouseUp:E,onMouseEnter:G,onMouseLeave:z,recordingKey:n0.Pt(_,"draggableRow"),onClick:(0,s.kc)().sts_interaction_interop?K:S.lQ},r.createElement(ow.s2,{label:null,leftIcon:r.createElement(rR.d,{toggled:Z&&!!P,recordingKey:n0.Pt(_,"interactionIcon"),onClick:(0,s.kc)().sts_interaction_interop?S.lQ:K,htmlAttributes:{onMouseDown:H,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":eo?el:sg(t.event,w,!!h)},"aria-label":eo?el:sg(t.event,w,!!h),children:eo?er:(0,iK.e7)(t.event.interactionType)}),input:r.createElement(nr.D8,{onClick:(0,s.kc)().sts_interaction_interop?S.lQ:K,onMouseDown:H,recordingKey:n0.Pt(_,"interactionText")},sg(t.event,w,!!h),ea&&r.createElement("span",{className:"prototype_interaction_list--summaryText--hGpp4"},"\xa0\xb7\xa0",ea)),rightIcon:r.createElement("div",{hidden:(0,s.kc)().sts_interaction_interop&&!k},r.createElement(eS.K,{onClick:W,"aria-label":(0,d.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:n0.Pt(_,"removeButton"),htmlAttributes:{onMouseDown:H}},r.createElement(rh.U,{svg:se.A,fallbackSvg:st.A},r.createElement(iR.O,null))))}));return h?ei:r.createElement("div",null,r.createElement(rp.e,{ref:R,className:f?"prototype_interaction_list--interactionListRow---i0Rg ui3_rows--ui3OneInputOneIconRow--SMoQ9 ui3_rows--_row--DnZFk ui3_rows--_grid--cP2Wu":void 0,"data-testid":`prototypeInteractionItem-${n}`,selected:q,selectedSecondary:Z,singletonRow:p,dragging:l,onMouseDown:m,onMouseMove:u,onMouseUp:E,onMouseEnter:G,onMouseLeave:z,recordingKey:n0.Pt(_,"draggableRow")},r.createElement(nr.D8,{className:eI()({"prototype_interaction_list--interactionButton--q-58Q":!0,"prototype_interaction_list--interactionButtonSelected--8YX9A":q,"prototype_interaction_list--interactionButtonSelectedSecondary--Nx73L":Z}),onClick:K,onMouseDown:H,recordingKey:_},eo&&r.createElement(nC.B,{className:"prototype_interaction_list--warningIcon--Mgr5O",svg:sn.A,"data-tooltip-type":rf.Ib.SPECIAL,"data-tooltip":i7,"data-tooltip-text":el}),r.createElement("div",{className:eo?"prototype_interaction_list--interactionNameShort--5UMLL prototype_interaction_list--interactionName--zQsSL":"prototype_interaction_list--interactionName--zQsSL"},sg(t.event,w,!!h)),r.createElement(rh.U,{className:"prototype_interaction_list--actionIcon--x-haP",svg:V?(0,iK.Yb)("NONE"):(0,iK.Yb)((0,iD.mj)(U))},(0,iK.av)((0,iD.mj)(U))),r.createElement("div",{className:"prototype_interaction_list--targetText--UMXyE",dir:"auto"},V?(0,d.t)("proto.variant_actions.mixed"):y===iB.J.INHERITED_INTERNAL?(0,d.t)("proto.variant_actions.change_to"):sy(U,b,f,F))),r.createElement("span",{className:"prototype_interaction_list--removeButton--g6aiQ"},r.createElement(eS.K,{onClick:W,"aria-label":(0,d.t)("proto.prototype_panel.remove_interaction_tooltip"),recordingKey:n0.Pt(_,"removeButton"),htmlAttributes:{onMouseDown:H}},r.createElement(rh.U,{svg:se.A,fallbackSvg:st.A},r.createElement(iR.O,null))))))}function sc(e){return e.pickerShown}function sd(e){return e.mirror.appModel.currentSelectedProperty}function sp(e){return e.mirror.selectionProperties.resettableInstanceOverrides}function sm(e){return e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0}function su(){let e=(0,o.d4)(iV.Xt),t=(0,o.d4)(iV.dK);for(let n of Object.keys(e)){let e=t.get(n);if(e&&("INSTANCE"===e.type||e.isInstanceSublayer))return!0}return!1}let sE=["ON_CLICK","DRAG","ON_HOVER","ON_PRESS","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"];function sg(e,t,n){let a=t.format(e.interactionType??"NONE");if("ON_KEY_DOWN"===e.interactionType&&e.keyTrigger&&e.keyTrigger.keyCodes){let t=(0,iX._i)(e.keyTrigger.keyCodes),r=(0,iX.E8)(e.keyTrigger,!0);if("KEYBOARD"===e.keyTrigger.triggerDevice&&t)return(0,s.kc)().sts_interaction_interop&&n?(0,iX.U8)(t):a+" ("+(0,iX.U8)(t)+")";if(r)return(0,s.kc)().sts_interaction_interop&&n?r:a+" ("+r+")"}return a}function sy(e,t,n,a){let r=new iD.js(n,a);if(!e)return r.format("NONE");let o=(0,iD.mj)(e);switch(o){case"NONE":case"GO_BACK":case"CLOSE_OVERLAY":case"SET_VARIABLE":case"SET_VARIABLE_MODE":case"CONDITIONAL":return r.format(o);case"OPEN_URL":if(null!=e.connectionURL){if((0,aq.gl)(e.connectionURL))return(0,d.t)("fullscreen.mixed");return e.connectionURL.replace(/https?:\/\//,"")}return r.format("NONE");case"UPDATE_MEDIA_PLAY":case"UPDATE_MEDIA_PAUSE":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":case"UPDATE_MEDIA_MUTE":case"UPDATE_MEDIA_UNMUTE":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":case"UPDATE_MEDIA_SKIP_FORWARD":case"UPDATE_MEDIA_SKIP_BACKWARD":case"UPDATE_MEDIA_SKIP_TO":return so.format(e)}return e.transitionNodeID?(0,aq.gl)(e.transitionNodeID)?(0,d.t)("fullscreen.mixed"):t(l6.dI(e.transitionNodeID)):r.format("NONE")}function s_(e){return e.interactions.filter(e=>e.id&&e.sourceNodeID).map(e=>iL.d({nodeID:e.sourceNodeID,interactionID:e.id}))}function sh(e){let t=[];for(let n of e){let{sourceNodeID:e,id:a}=n;e&&a&&t.push(iL.d({nodeID:e,interactionID:a}))}return t}function sf(e){n2.Y5.triggerAction("show-prototype-interaction-edit-modal",{args:{source:i.yxn.PROPERTIES_PANEL,x:e.x,y:e.y}})}var sv=n(889157),sb=n(797613),sS=n(974985),sT=n(256981),sN=n(43604);let sI=(0,r.memo)(function(e){return(0,nS.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nS.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M14 6v1.879l-1 1V6l-1 1-2 2H7.5a.5.5 0 0 0-.5.5v5c0 .107.034.206.091.288l-.71.71A1.5 1.5 0 0 1 6 14.5v-5A1.5 1.5 0 0 1 7.5 8h2.086l2.707-2.707A1 1 0 0 1 14 6m-1 7.121 1-1V18a1 1 0 0 1-1.707.707l-2.44-2.44.708-.706L12 17l1 1zm3.779-3.778-.71.71a2.5 2.5 0 0 1-.676 4.283c-.223.085-.393.285-.393.522v.03c0 .304.272.54.562.448a3.501 3.501 0 0 0 1.217-5.993m-1.551 1.55-.172.173a.5.5 0 0 0-.056.226v1.415c0 .345.35.576.588.326a1.5 1.5 0 0 0 0-2.066c-.112-.117-.247-.13-.36-.073m2.626-4.04a.5.5 0 0 0-.708-.706l-11 11a.5.5 0 1 0 .708.707z",clipRule:"evenodd"})})});var sP=n(875533),sC=n(697945),sk=n(477633),sA=n(564734),sw=n(68710),sO=n(632319);function sx({videoPlayback:{mediaLoop:e,muted:t}}){let n=null;return(0,aq.gl)(e)&&(0,aq.gl)(t)?n=(0,d.tx)("proto.prototype_panel.replace_mixed_muted_and_loop_video_playback",{loopSvg:r.createElement(nC.B,{svg:sk.A,className:sC.eT}),speakerSvg:r.createElement(nC.B,{svg:sw.A,className:sC.To})}):(0,aq.gl)(e)?n=(0,d.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:r.createElement(nC.B,{svg:sk.A,className:sC.eT})}):(0,aq.gl)(t)&&(n=(0,d.tx)("proto.prototype_panel.replace_mixed_video_playback",{svg:r.createElement(nC.B,{svg:sw.A,className:sC.To})})),n?r.createElement(rm.fI,null,r.createElement(rm.UZ,{className:sC.pc},n)):null}let sR=e=>(0,aq.gl)(e)?"mixed":e,sM=e=>!0===e,sL=function(e){let t=()=>{let t=!sM(e.videoPlayback.mediaLoop);e.updateSelectionProperties({videoMediaLoop:t}),e.dispatch((0,l9._P)({name:"Node video loop changed",params:{newLoop:t,oldLoop:sR(e.videoPlayback.mediaLoop),numVideosSelected:e.videoPlayback.numVideosSelected}}))},n=()=>{let t=!e.videoPlayback.muted;e.updateSelectionProperties({videoMuted:t}),e.dispatch((0,l9._P)({name:"Node video muted changed",params:{newMuteValue:t,oldMuteValue:sR(e.videoPlayback.muted),numVideosSelected:e.videoPlayback.numVideosSelected}}))},a=r.createElement("span",{className:(0,eu.GS)()?void 0:sC.hW},r.createElement(lL.S,{label:r.createElement(lD.J,{htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.default_video_playback_state"),"data-tooltip-type":rf.Ib.TEXT}},(0,d.tx)("proto.prototype_panel.autoplay")),onChange:t=>{e.updateSelectionProperties({videoAutoplay:t}),e.dispatch((0,l9._P)({name:"Node video autoplay Changed",params:{newAutoplay:t,oldAutoplay:sR(e.videoPlayback.autoplay),numVideosSelected:e.videoPlayback.numVideosSelected}}))},checked:sM(e.videoPlayback.autoplay),mixed:(0,aq.gl)(e.videoPlayback.autoplay),recordingKey:n0.Pt(e,"autoPlayToggle")})),o=(0,eu.GS)()?r.createElement(sb.f,{checked:sM(e.videoPlayback.mediaLoop),mixed:(0,aq.gl)(e.videoPlayback.mediaLoop),onIcon:r.createElement(rh.U,{svg:sk.A},r.createElement(sS.p,null)),offIcon:r.createElement(rh.U,{svg:sA.A},r.createElement(sT.U,null)),onChange:t,recordingKey:n0.Pt(e,"videoLoopToggle"),"aria-label":(0,d.t)("proto.prototype_panel.loop"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.loop"),"data-tooltip-type":rf.Ib.TEXT}}):r.createElement(sP.m,{toggled:sM(e.videoPlayback.mediaLoop),svg:e.videoPlayback.mediaLoop?sk.A:sA.A,fallbackSvg:e.videoPlayback.mediaLoop?sk.A:sA.A,onMouseDown:t,recordingKey:n0.Pt(e,"videoLoopToggle"),"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.loop"),dataTestId:"videoLoopToggle",className:sC.BM}),l=(0,eu.GS)()?r.createElement(sb.f,{checked:sM(!e.videoPlayback.muted),mixed:(0,aq.gl)(e.videoPlayback.muted),onIcon:r.createElement(rh.U,{svg:sw.A},r.createElement(sN.L,null)),offIcon:r.createElement(rh.U,{svg:sO.A},r.createElement(sI,null)),onChange:n,recordingKey:n0.Pt(e,"videoSoundToggle"),"aria-label":(0,d.t)("proto.prototype_panel.sound"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.sound"),"data-tooltip-type":rf.Ib.TEXT}}):r.createElement(sP.m,{toggled:!e.videoPlayback.muted,svg:sM(e.videoPlayback.muted)?sO.A:sw.A,fallbackSvg:sM(e.videoPlayback.muted)?sO.A:sw.A,onMouseDown:n,recordingKey:n0.Pt(e,"videoSoundToggle"),"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.sound"),dataTestId:"videoSoundToggle",className:sC.BM}),i=(0,eu.GS)()?r.createElement(ow.pG,{input:a,leftIcon:o,rightIcon:l}):r.createElement(rm.fI,{className:sC.kh},a,r.createElement("div",{className:sC.zc},o,l));return r.createElement(rm.Zk,null,r.createElement(rm.fI,null,r.createElement(rm.xw,{extended:!0},(0,d.tx)("proto.prototype_panel.video"))),i,r.createElement(sx,{videoPlayback:e.videoPlayback}))};var sD=n(794272),sK=n(555074),sF=n(420450),sV=n(955136);function sU(e){let{type:t}=e;return r.createElement("div",{className:T.cx.flex.justifyCenter.itemsCenter.$},r.createElement(nC.B,{className:T.cx.flexGrow1.mx12.$,useOriginalSrcFills_DEPRECATED:!0,svg:"horizontal"===t?sF.A:sV.A}),r.createElement("span",{className:T.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.content_needs_to_be_bigger_than_the_frame_tooltip")))}let sB=(0,i5.ex)("prototype_scroll_horizontal_info",sU,()=>({type:"horizontal",unconstrainWidth:!0})),sG=(0,i5.ex)("prototype_scroll_vertical_info",sU,()=>({type:"vertical",unconstrainWidth:!0})),sz="scroll_behavior_panel--inactiveLabel--IexW8",sH="scroll_behavior_panel--inactiveLabelContainer--lQjAi";var sW=n(591363);function sY(e){let{scrollDirection:t,showScrollWarning:n,disableOverflowBehaviorItem:a,disableScrollBehaviorItem:l,dropdownShown:s,updateSelectionProperties:c}=e,p=(0,o.wA)(),[m,u]=function(){let e=(0,eo.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels)[i.ibQ.OVERFLOW_ITEM],t=(0,l7.cJ)(),n=(0,sK.kl)("isSection"),a=(0,sK.kl)("anyTopLevelFramesInSelection");return[e,!t&&!n&&!a]}(),E=(0,eu.GS)()?r.createElement(lr.mS,{titleTx:(0,d.tx)("proto.scroll_panel.scroll_behavior_title")}):r.createElement(rm.fI,null,r.createElement(rm.xw,{className:"scroll_behavior_panel--panelTitle--kN-Nl"},(0,d.tx)("proto.scroll_panel.scroll_behavior_title")));return m||u?r.createElement(rt.k,{name:"scroll_behavior_panel"},r.createElement(rm.Zk,null,E,u&&r.createElement(rm.fI,null,r.createElement("div",{className:sH},r.createElement("span",{className:sz},(0,d.tx)("proto.scroll_panel.position_dropdown.position"))),r.createElement(sZ,{recordingKey:n0.Pt(e,"scrollBehavior"),dropdownShown:s,disabled:l})),m&&r.createElement(rm.fI,null,r.createElement("div",{className:sH},r.createElement("span",{className:sz},(0,d.tx)("proto.scroll_panel.overflow_dropdown.overflow"))),n&&r.createElement(nC.B,{className:"scroll_behavior_panel--infoIcon--FeXbf",svg:sW.A,useOriginalSrcFills_DEPRECATED:!0,"data-tooltip-type":rf.Ib.SPECIAL,"data-tooltip":"HORIZONTAL"===t?sB:sG,"data-tooltip-show-immediately":!0}),r.createElement(sQ,{className:n?"scroll_behavior_panel--scrollDirectionShort--w6iSo":"scroll_behavior_panel--scrollDirection--XSmzK",property:t,dispatch:p,dropdownShown:s,onChange:e=>{p((0,l9._P)({name:"Overflow Behavior changed",params:{newDirection:e,oldDirection:(0,aq._W)(t,"MIXED")}})),c({scrollDirection:e})},disabled:a,recordingKey:n0.Pt(e,"scrollDirection")})))):null}let s$=lU.l6,sX=lU.c$,sj=["NONE","HORIZONTAL","VERTICAL","BOTH"];class sQ extends r.PureComponent{render(){return r.createElement(s$,{id:"scroll-direction-select",className:this.props.className,chevronClassName:"scroll_behavior_panel--scrollDirectionChevron--5keRt",inputClassName:"scroll_behavior_panel--scrollDirectionInput--vJSqu",property:this.props.property||"NONE",formatter:iD.Rk,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,disabled:this.props.disabled,recordingKey:this.props.recordingKey,dataTestId:"scroll-direction-dropdown"},sj.map(e=>r.createElement(sX,{key:e,value:e,recordingKey:n0.Pt(this.props,e)})))}}sQ.displayName="ScrollDirectionDropdown";let sJ=lU.l6,sq=lU.c$;function sZ(e){let t=(0,o.wA)(),n=(0,sK.kl)("scrollBehavior"),{fixedScrollingDisabled:a}=(0,sD.R)(e=>{let t=e.mirror.selectionProperties;return{fixedScrollingDisabled:!t.nodesAreAllNotInStacksOrAbsolutePositioned||!t.allHaveScrollableFrameAsParent}}),l="scroll-behavior-select",s=e.dropdownShown&&e.dropdownShown.type===l?iD.Ge:iD.wi;return r.createElement(sJ,{id:l,className:"scroll_behavior_panel--scrollPosition--YAyUM",formatter:s,property:n||"SCROLLS",onChange:e=>{t((0,l9._P)({name:"Node Scroll Behavior Changed",params:{newValue:e}}));let n="FIXED_WHEN_CHILD_OF_SCROLLING_FRAME"===e?i.KjJ.FIXED:"STICKY_SCROLLS"===e?i.KjJ.STICKY_SCROLLS:i.KjJ.SCROLLS;a5.l7.user("set-scroll-behavior",()=>i.X3B.aggressivelySetScrollBehaviorOfSelection(n)),n2.Y5.commit()},dispatch:t,dropdownShown:e.dropdownShown,dropdownClassName:"scroll_behavior_panel--fullWidth--reSmx",recordingKey:e.recordingKey,disabled:e.disabled,dataTestId:"scroll-behavior-dropdown"},r.createElement(sq,{value:"SCROLLS"}),r.createElement(sq,{value:"FIXED_WHEN_CHILD_OF_SCROLLING_FRAME",disabled:a}),r.createElement(sq,{value:"STICKY_SCROLLS"}))}var s0=n(105020),s1=n(548183),s2=n(854547),s4=n(654784),s8=n(351731);function s3(){return r.createElement(ie.u,{idForTests:"create-connection-hint",title:(0,d.t)("proto.onboarding.creating_a_connection"),userFlag:"dismissed_create_connection_hint",icon_DEPRECATED:s2.A,iconFallback:s4.A,hintText:(0,d.t)("proto.onboarding.select_a_frame_or_object_hint")})}function s5(){return r.createElement(ie.u,{idForTests:"delete-connection-hint",title:(0,d.t)("proto.onboarding.removing_a_connection"),userFlag:"dismissed_delete_connection_hint",icon_DEPRECATED:s0.A,iconFallback:s1.A,hintText:(0,d.t)("proto.onboarding.to_delete_a_connection_click_and_drag_on_either_end")})}function s7(){return r.createElement(ie.u,{idForTests:"play-button-hint",title:(0,d.t)("proto.onboarding.running_your_prototype"),userFlag:"dismissed_play_button_hint",icon_DEPRECATED:s8.A,hintText:(0,d.t)("proto.onboarding.use_the_play_button_hint")})}function s6({dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a}){let o=0===a&&!e,l=0!==a&&!t,i=!n,s=r.useMemo(()=>o?R.c.CREATING_A_CONNECTION:l?R.c.REMOVING_A_CONNECTION:i?R.c.RUNNING_YOUR_PROTOTYPE:null,[o,l,i]);return s?r.createElement(M.fu,{name:"Prototype Onboarding Hint Panel V1",properties:{trackingDescriptor:s}},r.createElement(rm.Zk,null,r.createElement("div",null,o&&r.createElement(s3,null),l&&r.createElement(s5,null),i&&r.createElement(s7,null)))):null}class s9 extends r.PureComponent{constructor(){super(...arguments),this.onClickShowPrototypeSettings=()=>{this.props.dispatch((0,l9._P)({name:"Show Prototype Settings Clicked"})),ee.wr()}}renderOnboardingPanel(){let e=!!this.props.userFlags.dismissed_create_connection_hint,t=!!this.props.userFlags.dismissed_delete_connection_hint,n=!!this.props.userFlags.dismissed_play_button_hint,a=this.props.selectionProperties.numTransitionsOnCurrentPage;return r.createElement(s6,{dismissedCreateConnectionHint:e,dismissedDeleteConnectionHint:t,dismissedPlayButtonHint:n,numTransitionsOnCurrentPage:a})}renderPrototypeSettingsPanel(){return r.createElement(rt.k,{name:"show_prototype_settings_panel"},r.createElement(rm.Zk,{className:this.props.isUI3?lQ.rq:void 0},r.createElement(oA.z,{onClick:this.onClickShowPrototypeSettings,recordingKey:n0.Pt(this.props,"prototypeSettingsButton")},(0,d.tx)("proto.menu.show_prototype_settings"))))}renderDevicePanel(){(0,a2.KF)((0,aq.hS)(this.props.selectionProperties.prototypeDevice),"should not have mixed device selection");let e=(0,l9.Qx)(this.props.selectionProperties.prototypeDevice);return r.createElement(iI,{key:"device-panel",dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,prototypeDevice:e,smallNudgeAmount:this.props.smallNudgeAmount,bigNudgeAmount:this.props.bigNudgeAmount,recordingKey:"devicePanel",isUI3:this.props.isUI3,pickerShown:this.props.pickerShown})}render(){let e=!(0,aq.hS)(this.props.selectionProperties.transitionNodeID)||l6.fn((0,aq.E7)(this.props.selectionProperties.transitionNodeID)),t=this.props.selectionProperties.numSelected??!1,n=!this.props.isSites&&!!this.props.selectionProperties.numVideosSelected,a=this.props.selectionProperties.isInstanceSelected||this.props.selectionProperties.isInstanceSublayerSelected,o=this.props.selectionProperties.isInstanceSublayerSelected,l=!this.props.isSites&&this.props.selectionProperties.prototypeStartingPointsInfo&&this.props.selectionProperties.prototypeStartingPointsInfo.length>0,i=!this.props.isSites&&!e,s=!this.props.isSites&&((this.props.selectionProperties.isValidPrototypingSourceSelected??!0)||this.props.selectionProperties.isSectionSelected&&(0,it.YR)());if(!t)return r.createElement("div",null,!this.props.isSites&&this.renderDevicePanel(),!this.props.isUI3&&r.createElement(ir,{recordingKey:n0.Pt(this.props,"backgroundPanel"),prototypeBackgroundColor:this.props.selectionProperties.prototypeBackgroundColor,pickerShown:this.props.pickerShown,dispatch:this.props.dispatch}),l&&r.createElement(o1.A,null),!this.props.isSites&&i&&this.renderOnboardingPanel(),r.createElement(oc.Mw,{panelName:oc.ON.PROTOTYPE}));{let e=r.createElement(sY,{dropdownShown:this.props.dropdownShown,scrollDirection:this.props.selectionProperties.scrollDirection??"NONE",showScrollWarning:this.props.selectionProperties.showWontScrollWarning??!1,disableOverflowBehaviorItem:!!a,disableScrollBehaviorItem:!!o,recordingKey:n0.Pt(this.props,"scrollBehaviorPanel"),updateSelectionProperties:n2.Y5.updateSelectionProperties});return r.createElement("div",null,!this.props.isSites&&this.props.selectionProperties.isTopLevelFrameAndValidPrototypeSourceSelected&&r.createElement(sv.A,{recordingKey:n0.Pt(this.props,"startingPointPanel")}),s&&r.createElement(sl,null),e,n&&r.createElement(sL,{updateSelectionProperties:n2.Y5.updateSelectionProperties,dispatch:this.props.dispatch,videoPlayback:function(e){let{videoMediaLoop:t,videoAutoplay:n,videoMuted:a,numVideosSelected:r}=e;return(0,a2.B1)(t),(0,a2.B1)(n),(0,a2.B1)(a),(0,a2.B1)(r),{autoplay:n,muted:a,mediaLoop:t,numVideosSelected:r}}(this.props.selectionProperties)}),!this.props.isSites&&this.renderPrototypeSettingsPanel(),i&&this.renderOnboardingPanel(),r.createElement(oc.Mw,{panelName:oc.ON.PROTOTYPE}),r.createElement("div",null))}}}s9.displayName="PrototypePanel";let ce=(0,M.kp)(function(e){let{bigNudgeAmount:t,smallNudgeAmount:n}=(0,aR.sT)(),a=(0,eu.GS)(),o=(0,l7.cJ)();return r.createElement(s9,{...e,bigNudgeAmount:t,smallNudgeAmount:n,isUI3:a,isSites:o})},oZ.e0.PROTOTYPE_PANEL);function ct({appModel:e,colorFormat:t,dropdownShown:n,expandedFramePresetType:a,library:l,pickerShown:s,sceneGraphSelection:c,selectedStyleProperties:d,selectionProperties:p,shownPanels:m,userFlags:u}){let E=(0,o.wA)(),g=(0,U.q5)(),y=(0,l7.cJ)(),_=(0,aY.RB)(d)?d:p,h=!m[i.ibQ.FRAME_PRESETS]&&!m[i.ibQ.PENCIL_TOOL]&&!_.containsResponsiveSets;return r.createElement(aX.i,null,r.createElement(aj.VF,{isVisible:m[i.ibQ.FRAME_PRESETS]},()=>r.createElement(aQ.nl,{key:"frame-presets",recordingKey:"framePresetPanel",dispatch:E,expandedFramePresetType:a})),!y&&r.createElement(aj.VF,{isVisible:m[i.ibQ.PENCIL_TOOL]},()=>r.createElement(aJ.q,{id:"pencilToolPanel",key:"pencilToolPanel",recordingKey:"pencilToolPanel",openFile:g})),r.createElement(aj.VF,{isVisible:h},()=>r.createElement(ce,{key:"prototype",recordingKey:"prototypePanel",dispatch:E,selectionProperties:_,appModel:e,pickerShown:s,dropdownShown:n,currentTool:e.currentTool,colorFormat:t,sceneGraphSelection:c,editModeType:e.activeCanvasEditModeType,library:l,openFile:g,userFlags:u})))}function cn({scrollContainer:e,refMainScrollContainer:t,...n}){(0,oq.S2)();let a=(0,ax.F)(),o=n.appModel.topLevelMode,l=n.propertiesPanelTab,c=n.appModel.isReadOnly,d=o!==i.lyf.PREVIEW&&(o!==i.lyf.BRANCHING||!(0,aY.S4)(n.appModel,n.user))&&o!==i.lyf.DEV_HANDOFF&&l===i.FAf.DESIGN,p=o!==i.lyf.PREVIEW&&o!==i.lyf.BRANCHING&&l===i.FAf.PROTOTYPE,m=o===i.lyf.PREVIEW&&!n.userStateLoaded&&!a||l===i.FAf.INSPECT,u=(0,s.kc)().livefish&&o===i.lyf.LAYOUT&&!c&&l===i.FAf.LIVING_DESIGNS,E=l===i.FAf.EXPORT,g=l===i.FAf.COMMENT;return r.createElement(r.Fragment,null,d&&r.createElement(oj,{scrollContainer:e,...n}),p&&r.createElement(ct,{appModel:n.appModel,colorFormat:n.colorFormat,dropdownShown:n.dropdownShown,expandedFramePresetType:n.expandedFramePresetType,library:n.library,pickerShown:n.pickerShown,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties,shownPanels:n.shownPanels,userFlags:n.userFlags}),m&&r.createElement(o2,{scrollContainer:e,selectionProperties:n.selectionProperties}),u&&r.createElement(l3,null),E&&r.createElement(oJ,{appModel:n.appModel,dropdownShown:n.dropdownShown,pickerShown:n.pickerShown,saveAsState:n.saveAsState,sceneGraphSelection:n.sceneGraphSelection,selectedStyleProperties:n.selectedStyleProperties,selectionProperties:n.selectionProperties}),g&&r.createElement(n.commentsPanel,null))}function ca(e){!function(){let e="ui3"===(0,aB.DP)().version,{isPropertiesPanelCollapsed:t,setPropertiesPanelCollapsed:n}=(0,aG.iT)(),a=(0,eK.Ye)(),l=(0,aw.ow)(),s=(0,V.ax)(),c=(0,V.dH)(),d=c===i.NLJ.FRAME||c===i.NLJ.COMMENTS||c===i.NLJ.VECTOR_PENCIL,p=(0,o.d4)(e=>e.mirror.appModel.activeUserAction===i.QOV.DEFAULT),m=(0,aG.ys)();(0,r.useEffect)(()=>{e&&p&&!l&&t&&(d||s)&&n(!1)},[s,p,c,e,n,t,a,d,l]),(0,r.useEffect)(()=>{m&&n(!0)},[m,n,t])}();let{dispatch:t,...n}=e,a=null,l=e=>{a=e};return r.createElement(l5.j,{recordingKey:n.recordingKey,activeTab:n.propertiesPanelTab,refMainScrollContainer:l},r.createElement(cn,{...n,scrollContainer:a,refMainScrollContainer:l}))}var cr=n(282263),co=n(991052),cl=n(16771),ci=n(59434);let cs=r.memo(function(){let e=(0,o.wA)(),t=(0,o.d4)(e=>(0,aD.getPermissionsState)(e)),n=(0,V.aV)(),a=(0,o.d4)(e=>e.loadingState),l=(0,o.d4)(e=>e.mirror.appModel),c=(0,v.md)(aK.wm),d=(0,o.d4)(e=>e.mirror.sceneGraphSelection),p=(0,o.d4)(e=>e.mirror.selectionPaints),m=(0,o.d4)(e=>e.mirror.selectionProperties),u=(0,o.d4)(e=>e.mirror.selectedStyleProperties),E=(0,o.d4)(e=>e.currentUserOrgId),g=(0,o.d4)(e=>e.dropdownShown),y=(0,o.d4)(e=>e.fonts),_=(0,o.d4)(e=>e.fileVersion),h=(0,o.d4)(e=>e.installedPluginVersions),f=(0,o.d4)(e=>e.library),b=(0,o.d4)(e=>e.localPlugins),S=(0,o.d4)(e=>e.modalShown),T=(0,o.d4)(e=>e.multiplayer),N=(0,o.d4)(e=>e.openFile),I=(0,o.d4)(e=>e.pickerShown),P=(0,o.d4)(e=>e.pickerInStyleCreationShown),C=(0,o.d4)(e=>e.publishedPlugins),k=(0,o.d4)(e=>e.saveAsState),A=(0,o.d4)(e=>e.selectedView),w=(0,o.d4)(e=>e.voice.showWidget),O=(0,o.d4)(e=>e.stylePickerListLayout),x=(0,o.d4)(e=>e.stylePickerShown),R=(0,o.d4)(e=>e.stylePreviewShown),M=(0,o.d4)(e=>e.styleSets),L=(0,o.d4)(e=>e.usedKeyboardShortcuts),D=(0,o.d4)(e=>e.user),K=(0,o.d4)(e=>e.userFlags),F=(0,o.d4)(e=>e.userStateLoaded),U=(0,o.d4)(e=>e.repos),B=(0,o.d4)(e=>e.folders),G=(0,o.d4)(e=>e.teams),z=(0,o.d4)(e=>e.orgById),H=(0,o.d4)(e=>e.orgUsersByOrgId),W=(0,o.d4)(e=>e.userEduGracePeriods),Y=(0,o.d4)(e=>e.licenseGroups),$=(0,eu.GS)(),X=(0,aw.my)()===aF.nT.Design,j=(0,ax.F)(),Q=(0,aL.VP)(a,"edit_button_upgrading_to_edit"),J=n||Q,q=(0,eo.ut)((0,ee.aY)(),i.FAf.DESIGN),Z=(0,eo.J2)(i.Ez5.propertiesPanelState().shownPropertiesPanels),et=(0,eo.J2)(i.Ez5.propertiesPanelState().strokePanelMode),en=(0,eo.J2)(i.Ez5.propertiesPanelState().strokePanelTerminalPointCount),ea=(0,eo.J2)((0,aR.UK)().expandedFramePresetType),er=(0,aR.Ku)(),el=(0,aR.qw)(),ei=(0,aO.b)(),es=(0,eo.J2)(i.Ez5.uiState().showPropertiesPanel),ec=!(0,aA.Oo)()&&$&&es,ed=(0,eo.J2)((0,aR.UK)().renderRulers),{isRightPanelCollapsed:ep}=(0,r.useContext)(aV.t),{inProductHelpViewType:em}=(0,aU.A5)(),eE=(0,eo.J2)(i.Ez5.uiState().inProductHelpSidePanelWidth),eg=(0,aM.Tn)(),ey=(0,aM.qM)(),e_=(0,r.useMemo)(()=>j?i.FAf.COMMENT:q,[q,j]);return(0,r.useEffect)(()=>{e_!==q&&ee.aY()?.set(e_)},[e_,q]),r.createElement(ci.o,{boundaryKey:"PropertiesPanel",loggedOutDesktopRevampExpAvaialable:X},r.createElement(ca,{recordingKey:"propertiesPanel",isCollapsed:ep,propertiesPanelTab:e_,strokePanelMode:et,strokePanelTerminalPointCount:en,commentsPanel:cl.L,dispatch:e,isLoading:J,shouldAnimateLoadingState:n,shouldShowBackgroundGradient:ec,shownPanels:Z,rulersVisible:ed,isInsetEditorEnabled:ei,expandedFramePresetType:ea,colorFormat:er,propertiesPanelSplitPosition:el,permissionsState:t,key:(0,ak.tw)()??void 0,appModel:l,sceneGraph:c,sceneGraphSelection:d,selectionPaints:p,selectionProperties:m,selectedStyleProperties:u,currentUserOrgId:E,dropdownShown:g,fonts:y,fileVersion:_,allSavedPlugins:h,library:f,localPlugins:b,modalShown:S,multiplayer:T,openFile:N,pickerShown:I,pickerInStyleCreationShown:P,publishedPlugins:C,saveAsState:k,selectedView:A,stylePickerListLayout:O,stylePickerShown:x,stylePreviewShown:R,styleSets:M,usedKeyboardShortcuts:L,user:D,userFlags:K,userStateLoaded:F,repos:U,folders:B,teams:G,orgById:z,orgUsersByOrgId:H,userEduGracePeriods:W,licenseGroups:Y,isUI3:$,showVoiceWidget:w,hasMergedDimensionsAndAutolayout:$,inProductHelpViewType:em,inProductHelpSidePanelWidth:eE,justChangedMinimizeUIValue:eg,isUIMinimized:ey}),(0,s.kc)().asset_binding_picker?r.createElement(co.lD,null):r.createElement(cr.tZ,null))});var cc=n(728521),cd=n(889085),cp=n(648836),cm=n(481483),cu=n(544750),cE=n(75888),cg=n(677859),cy=n(541524),c_=n(630978),ch=n(695342),cf=n(221537),cv=n(12519);let cb="stack_controls--input--gK1jo text--fontNeg12--2PWcg text--_fontBase--QdLsd text--_negText--j9g-L",cS="stack_controls--scrubbableControl--b1ChI",cT="stack_controls--inputSvg--wFizL",cN="stack_controls--stackSpacingRow--Uus3H";function cI(){let e=(0,eo.J2)(i.Ez5.canvasViewState().focusedStackRegion);if(!e)return null;let{region:t,focus:n}=e;return t===i.RN9.SPACING?r.createElement(cC,{focusOnMount:n}):t===i.RN9.COUNTER_SPACING?r.createElement(ck,{focusOnMount:n}):r.createElement(cA,{stackRegion:t,focusOnMount:n})}let cP=e=>{if(e.keyCode===rv.Uz.TAB){e.preventDefault(),e.currentTarget.blur();let t=e.shiftKey;i.Qa7.tabActiveStackRegion(t)}};function cC({focusOnMount:e}){return r.createElement(rm.fI,{className:cN},r.createElement(cv.KI,{focusOnMount:e,outerClassName:cS,inputClassName:cb,svgClassName:cT,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cP,onPaste:cw,noBorderOnFocus:!0,recordingKey:"stackSpacingControl",inputTestId:"stackSpacingControl",source:"canvas",onCanvasUI:!0}))}function ck({focusOnMount:e}){return r.createElement(rm.fI,{className:cN},r.createElement(c_.q,{focusOnMount:e,outerClassName:cS,inputClassName:cb,svgClassName:cT,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cP,onPaste:cw,noBorderOnFocus:!0,recordingKey:"stackCounterSpacingControl",inputTestId:"stackCounterSpacingControl",source:"canvas",onCanvasUI:!0}))}function cA({stackRegion:e,focusOnMount:t}){let[n]=(0,cf.HF)(e),a=Array.isArray(n)?n.length:0;return e===i.RN9.SPACING?null:r.createElement(rm.fI,{className:eI()("stack_controls--stackPaddingRow--40WUa",{"stack_controls--large--bJFUN":a>3})},r.createElement(ch.s,{paddingSelection:e,focusOnMount:t,outerClassName:cS,inputClassName:cb,onBlur:i.Qa7.clearActiveStackRegion,onKeyDown:cP,onPaste:cw,noBorderOnFocus:!0,svgClassName:cT,recordingKey:"stackPaddingControl",inputTestId:"stackPaddingControl",source:"canvas",disableVariablesEntryPoint:!0}))}function cw(e){(0,cy.gk)(e)&&(e.preventDefault(),e.currentTarget.blur(),a5.l7.user("paste-in-stack",()=>{i.glU.triggerAction("paste",{})}))}let cO=r.memo(function(){return(0,o.d4)(e=>e.mirror.appModel.isReadOnly)?null:r.createElement(cx,null)});function cx(){return r.createElement(cp.k,{isShown:!0},r.createElement(cE.IA,null,r.createElement(cR,{testID:"DesignInlineMenu"})))}function cR({testID:e}){let t=(0,o.d4)(e=>{let t=e.mirror.selectionProperties.stackMode;return 1===e.mirror.selectionProperties.numSelected&&("HORIZONTAL"===t||"VERTICAL"===t)});return(0,o.d4)(e=>{let t=e.mirror.selectionProperties.selectedWidgetInfo;return!!(1===e.mirror.selectionProperties.numSelected&&t?.propertyMenu.length)})?r.createElement(cg.W1,{size:"small",testID:e},r.createElement(cm.jk,null),r.createElement(cu.x,null)):t?r.createElement(cg.W1,{testID:e,darkModePreferred:!0},r.createElement(cI,{key:"stackControls"})):null}var cM=n(100303),cL=n(137345),cD=n(624488),cK=n(515288),cF=n(936486),cV=n(237701),cU=n(876743),cB=n(622422),cG=n(179479),cz=n(265911),cH=n(988022),cW=n(177505),cY=n(13252),c$=n(283978),cX=n(597106),cj=n(265746),cQ=n(696808),cJ=n(634480),cq=n(862442),cZ=n(457630),c0=n(227795),c1=n(286723);function c2(){let e=(0,o.wA)(),t=(0,o.d4)(e=>!!e.modalShown),n=(0,o.d4)(e=>e.versionHistory.compareId),a=i.AWq.getChunkChangeCount(),l=(0,cq.Z)("chunk_change_navigator_navigate"),s=(0,cJ.E)(),c=r.useCallback(e=>{i.Egt.setSelectedNodeAndCanvas(e,!0),l((0,cZ.QZ)({nodeId:e,...c1.ob}),c1.kh),s(e)},[l,s]),p=r.useCallback(e=>{t||0===a||("ArrowUp"===e.key||"ArrowLeft"===e.key||e.shiftKey&&"Tab"===e.key?c(i.glU.navigateToNextChange(-1)):("ArrowDown"===e.key||"ArrowRight"===e.key||"Tab"===e.key)&&c(i.glU.navigateToNextChange(1)))},[t,a,c]);return(r.useEffect(()=>{e(cQ.Q.dequeue({type:cj._.SEE_WHATS_CHANGED}))},[e]),r.useEffect(()=>{n&&0!==a&&c(i.glU.navigateToFirstVisibleOrClosestChange())},[a,n,c]),r.useLayoutEffect(()=>{if(0!==a)return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)}},[a,p]),0===a)?null:r.createElement(r.Fragment,null,r.createElement("div",{className:"chunk_change_navigator--chunkChangeCount--ZFnfP"},(0,d.tx)("collaboration.feedback.change_count",{changeCount:a})),r.createElement("div",{className:"chunk_change_navigator--chunkChangeNavigator--82303"},r.createElement(c0.K0,{svg:nH.A,onClick:e=>{e.stopPropagation(),c(i.glU.navigateToNextChange(-1))},"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.previous_change"),recordingKey:"change_stepper.previous",disabled:0===a}),r.createElement(c0.K0,{svg:nz.A,onClick:e=>{e.stopPropagation(),c(i.glU.navigateToNextChange(1))},"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("collaboration.feedback.next_change"),recordingKey:"change_stepper.next",disabled:0===a})))}var c4=n(415702),c8=n(126049),c3=n(554322),c5=n(690260),c7=n(493323),c6=n(140908),c9=n(746757),de=n(298527),dt=n(813648),dn=n(594901),da=n(933342),dr=n(243987),dl=n(435011),di=n(693223),ds=n(378762),dc=n(426046),dd=n(715762),dp=n(563706),dm=n(26328),du=n(140796),dE=n(48515);function dg({searchOptions:e,keyboardNavigationPath:t,keyboardNavigationColumn:n}){let a=(0,o.wA)(),l=(0,o.d4)(dm.UQ),{activeTab:s,shouldFocusSearchBar:c}=(0,o.d4)(e=>e.leftPanel),p=s===i.xae.ASSETS,m=r.useRef(null),u=(0,o.d4)(e=>e.mirror.appModel.activeCanvasEditModeType),E=(0,du.vb)({isVisible:p,autofocus:!0,selectOnFocus:!0,ref:m});r.useEffect(()=>{let e=e=>{(dp.Ay.chromeos?e.altKey&&e.shiftKey&&e.keyCode===rv.Uz.KEY_2:e.altKey&&e.keyCode===rv.Uz.KEY_2)&&u!==i.m1T.TEXT&&(E(),e.preventDefault())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[u,E]);let g=r.useCallback(t=>{let n;e&&((0,dm.eu)(e.type)?n=e.type:(n={type:dE.I.ALL},e.onSetAssetType(n))),a(ra.ku({query:t,searchOptions:n,entryPoint:"asset_panel"}))},[a,e]),y=eI()("component_sidebar_search--searchWithViewModeToggle--nKJ2-","component_sidebar_search--negMargin--QTfpB");return null!=t?r.createElement(du.E1,{query:l.query,onChange:g,isVisible:p,className:y,recordingKey:"componentsLibrarySearch",placeholder:(0,d.t)("design_systems.assets_panel.search"),autofocus:c,selectOnFocus:!0,hideSearchIcon:!0,entryPointForTracking:"editor:assets_panel",path:t,column:n,forwardedRef:m}):r.createElement(du.aU,{query:l.query,onChange:g,isVisible:p,className:y,recordingKey:"componentsLibrarySearch",placeholder:(0,d.t)("design_systems.assets_panel.search"),autofocus:c,selectOnFocus:!0,hideSearchIcon:!0,forwardedRef:m,entryPointForTracking:"editor:assets_panel"})}var dy=n(320067),d_=n(35645),dh=n.n(d_),df=n(708389),dv=n(588666),db=n(696673),dS=n(788744),dT=n(756317),dN=n(680681),dI=n(824630),dP=n(957987),dC=n(776018);function dk(e){let{assetType:t,libraryNameByFileKey:n,fileKeyToLibraryKey:a,onSetAssetType:l,onSetKeyboardNavigationElement:i,validAssetTypeOptions:c}=e,p=(0,o.wA)(),m=(0,o.d4)(e=>e.modalShown),u=(0,o.d4)(e=>e.dropdownShown),E=(0,o.d4)(U.tB),g=t.type===dE.I.FILE?t.fileKey:void 0,y=(0,dS.Sd)(),_=(0,dS.Fl)(),h=r.useCallback(()=>{m?.type===dC.V&&p(le.AS()),eP.az.trackDefinedEvent("assets_panel.asset_type_dropdown_opened",{fileKey:E?.key,assetsPanelVersion:2})},[p,m,E?.key]),f=r.useMemo(()=>{if((0,dN.NX)(y)){let e=Object.entries(n??{}).map(([e,t])=>({key:e,name:t,library_key:a[e]}));return(0,dN.k9)({libraries:e,approvedLibraryFileKeysByResourceType:y,approvedLibraryKeysByResourceType:_}),e.map(({key:e})=>e)}return Object.keys(n??{}).sort((e,t)=>df.f.LEXICOGRAPHICALLY(n[e],n[t]))},[n,y,_,a]),v=(0,de.Ck)(),[b,S]=dh()(f,e=>!(0,db.wJ)(e)),T=S.length>0&&v(),N=r.useMemo(()=>({format:e=>{switch(e.type){case dE.I.RECENT:return(0,d.t)("design_systems.assets_panel.dropdown_type_recents");case dE.I.ALL:return(0,d.t)("design_systems.assets_panel.dropdown_type_all_libraries");case dE.I.LOCAL:if((0,s.kc)().dse_local_assets_copy)return(0,d.t)("design_systems.assets_panel.created_in_this_file");if((0,s.kc)().dse_editor_templates_v1)return(0,d.t)("design_systems.assets_panel.dropdown_type_local_assets");return(0,d.t)("design_systems.assets_panel.dropdown_type_local");case dE.I.FILE:return n[e.fileKey];case dE.I.SITE_KIT:return""}},isEqual:dA}),[n]);return r.createElement(lU.l6,{className:"sidebar_asset_type_select--select--PTmwH",id:"component-sidebar-asset-type-select",property:t,formatter:N,onChange:l,dropdownAlignment:"left",openOnKeyPressed:[rv.Uz.SPACE,rv.Uz.ENTER],inputRef:i,dispatch:p,chevronClassName:"sidebar_asset_type_select--chevron--xyZLx",inputClassName:"sidebar_asset_type_select--input--sSEn2",dropdownShown:e.useLocalState?e.dropdownShown:u,dropdownWidth:260,onShowDropdown:h,onShowDropdownOverride:e.useLocalState?e.onShowDropdownOverride:void 0,onHideDropdownOverride:e.useLocalState?e.onHideDropdownOverride:void 0,rightIcon:r.createElement(dP.P,{resourceId:g,libraryKey:g?(0,dv.$)(g):void 0})},!!c[dE.I.ALL]&&r.createElement(lU.c$,{value:{type:dE.I.ALL}}),!!c[dE.I.RECENT]&&r.createElement(lU.c$,{value:{type:dE.I.RECENT}}),!!c[dE.I.LOCAL]&&r.createElement(lU.c$,{value:{type:dE.I.LOCAL}}),b.length>0?r.createElement(lU.sK,null):null,b.length>0?r.createElement(lU.c$,{isHeader:!0,formattedValue:E?.org?.name?(0,d.t)("design_systems.assets_panel.dropdown_org_libraries",{orgName:E.org.name}):(0,d.t)("design_systems.assets_panel.dropdown_libraries")}):null,b.map(e=>(0,dN.sF)(a[e],e)?r.createElement(lU.c$,{key:e,value:{type:dE.I.FILE,fileKey:e},removeTextRightPadding:!0,rightSettingsIcon:r.createElement(dT.FX,null)}):r.createElement(lU.c$,{key:e,value:{type:dE.I.FILE,fileKey:e},fullWidth:!0})),T?r.createElement(lU.sK,null):null,T?r.createElement(lU.c$,{isHeader:!0,formattedValue:(0,d.t)("design_systems.assets_panel.dropdown_curated_libraries")}):null,T&&S.map(e=>r.createElement(lU.c$,{key:e,value:{type:dE.I.FILE,fileKey:e},removeTextRightPadding:!0,rightSettingsIcon:r.createElement(dI.t,null)})))}function dA(e,t){return e.type===dE.I.FILE&&t.type===dE.I.FILE?e.fileKey===t.fileKey:e.type===t.type}var dw=n(280999),dO=n(731719);function dx({disabled:e,isList:t,onSetKeyboardNavigationElement:n,onToggleViewMode:a,recordingKey:o}){let l=t?(0,d.t)("design_systems.assets_panel.show_as_grid"):(0,d.t)("design_systems.assets_panel.show_as_list");return r.createElement(c0.K0,{ref:n,recordingKey:n0.Pt(o,"toggleComponentsSidebarViewMode"),"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":l,svg:t?dw.A:dO.A,onClick:a,disabled:e})}var dR=n(135076),dM=n(311692),dL=n(716034),dD=n(940596);let dK=(0,dD.Wh)(()=>(0,dL.eU)(0)),dF=(0,dD.Wh)(()=>(0,dL.eU)(ne.Bk.Grid));var dV=n(669178),dU=n(809073);function dB(e,t,n){return null!=e&&(t[e.type]||e.type===dE.I.FILE&&n[e.fileKey])?e:{type:dE.I.ALL}}var dG=n(420576),dz=n(670494),dH=n(532888),dW=n(238837),dY=n(372291),d$=n(233333);let dX="searchResults";function dj(e,t){return`${t}:${e.key}`}function dQ(e){return`${e}:${dX}:templates`}function dJ(e){return`${e}:recentlyUsed`}function dq(e){return`${e}:stickySection`}var dZ=n(734013),d0=n(607283),d1=n(154483),d2=n(146817),d4=n(376406),d8=n(175290),d3=n(801161),d5=n(830445),d7=n(274071),d6=n(180715),d9=n(603396),pe=n(969504),pt=n(986231),pn=n(811559),pa=n(734017),pr=n(739212),po=n(486107),pl=n(408938);let pi=(0,d1.fv)();function ps({asset:e,fileName:t,sourceForTracking:n,thumbHeight:a,thumbLayout:l,thumbWidth:i,viewMode:c,sectionNameForTracking:d,sectionPosition:p,noFlyout:m,preventDrag:u,disableContextMenu:E}){let g=(0,o.wA)(),y=(0,o.d4)(e=>e.dropdownShown),_=(0,o.d4)(iV.dK),h=(0,o.d4)(t2.F9),f=(0,o.d4)(t2.e_),b=(0,v.md)(d6.T),S=f.assetsPanelSearch.searchOptions?.type===dE.I.ALL,T=r.useMemo(()=>pi(e),[e]),N=(0,dS.fV)(e.library_key,T),I=(0,d5.E_)(T),P=S&&(N||I),C=r.useRef(null),k=(0,ri.kH)(e.name),A=(0,d4.NG)({text:k,textRef:C}),w=r.useRef(null),O=(0,d4.NG)({text:t??"",textRef:w}),x=y?.type===pa.K.ASSETS_PANEL?y?.data?.component:void 0,R=x?.node_id===e.node_id,M=c===ne.Bk.List,L=M?"list-no-padding":"grid",D=!!f.assetsPanelSearch.query,K=(0,pe.F)(e,pa.K.ASSETS_PANEL,p,d),F=(0,d9.n)(e),V=(0,a7.ZC)(F),U=!m;r.useEffect(()=>{F&&!V&&g(d3.jD())},[F,g,V]);let B=e.isLocal&&(0,ak.PN)()?(0,pr.eT)(e.node_id,_).join("-"):e.node_id,G="Local components"===d||"Local private components"===d||e.isLocal,z=l!==t9.rp.SMALL&&!M,H=!M&&(0,s.kc)().api_asset_search_with_scores,W=(0,pt.Y)(e),Y=M?a:a-2,$=M?i:i-2,X=r.useMemo(()=>u?void 0:{sourceForTracking:n,clickToInsert:!1,afterSuccessfulInsert:d7.$z,sectionNameForTracking:d},[u,d,n]),j=G?r.createElement(pn.MT,{item:e,height:Y,width:$,draggable:X,buttonProps:{onContextMenu:E?void 0:K},shouldHideTooltip:U||R||F,isFilePublished:h,recordingNodePath:B,isSearch:D,useBaseTile:!0,hideNameOverlay:z,numVariants:W,displayType:L,sectionPosition:p,showTooltipImmediately:!1,fileName:A||O?t:void 0,alwaysShowBorder:!0}):r.createElement(pn.lX,{item:e,showName:!0,height:Y,width:$,draggable:X,buttonProps:{onContextMenu:E?void 0:K},shouldHideTooltip:U||R||F,recordingNodePath:B,isSearch:D,useBaseTile:!0,hideNameOverlay:z,numVariants:W,displayType:L,sectionPosition:p,showTooltipImmediately:!1,fileName:A||O?t:void 0,alwaysShowBorder:!0});return r.createElement("div",{className:M?po.AD:po.iE},M?j:r.createElement("div",{className:eI()(po.QX,{[po.Gr]:F,[po.HR]:F&&b})},j),z&&r.createElement("div",{role:"button",className:po.Bm,style:{width:i}},r.createElement("span",{className:po.UU,ref:C},k),U&&r.createElement(nC.B,{ariaHidden:!0,className:po.OW,svg:pl.A})),z&&!!t&&r.createElement(d8.Y,{spacing:0,direction:"horizontal"},r.createElement("div",{className:eI()(po.Md,po.Rm),ref:w,style:P?{maxWidth:i-dP.J}:{width:i}},t),P&&r.createElement(dP.P,{resourceId:T,libraryKey:e.library_key,showPresetTooltip:!0,tooltipDelay:500,tooltipLocation:"below",compact:!0})),H&&r.createElement(r.Fragment,null,r.createElement("div",{className:eI()(po.Md,po.Rm),style:P?{maxWidth:i-dP.J}:{width:i}},"AI: "+(e.ai_score??"N/A")),r.createElement("div",{className:eI()(po.Md,po.Rm),style:P?{maxWidth:i-dP.J}:{width:i}},"Lex: "+(e.lexical_score??"N/A"))),U&&M&&r.createElement(nC.B,{ariaHidden:!0,className:po.Ki,svg:pl.A}))}var pc=n(10648),pd=n(262311);let pp="library_section_header--sectionHeaderH1--P70zQ ellipsis--ellipsis--Tjyfa",pm="library_section_header--sectionHeader3_redesign--TGISe ellipsis--ellipsis--Tjyfa",pu="library_section_header--sectionHeaderH3--5VrMz ellipsis--ellipsis--Tjyfa",pE=e=>"isExpandable"in e&&e.isExpandable,pg=(e,t)=>{switch(e){case pp:return t?"library_section_header--sectionHeaderDivider--SdrS5 ellipsis--ellipsis--Tjyfa":"library_section_header--sectionHeader1_redesign--cWZaj ellipsis--ellipsis--Tjyfa";case pu:return pm;default:return"library_section_header--sectionHeader3_normal--bf4ra"}},py=e=>{let t=[];if(e&&e.length){t.push(r.createElement("div",{className:"library_section_header--sectionHeader1_sticky--mZ4QY ellipsis--ellipsis--Tjyfa",key:e[0]},e[0]+" / ","\xa0"));let n=e.slice(1).join(" / ");t.push(r.createElement("div",{className:pm,key:n},n,"\xa0"))}return t};class p_ extends r.Component{componentDidUpdate(e){pE(this.props)&&pE(e)&&e.isExpanded!==this.props.isExpanded&&"h1"===this.props.size&&(0,ex.YQ)({id:"library_section_header_toggled"})}render(){let e="h1"===this.props.size?pp:pu,t=pE(this.props)?"library_section_header--sectionHeaderExpandable--hHEFq":"",n=pg(e,this.props.shouldShowDividerLine),a=pE(this.props)&&this.props.isFixed?"library_section_header--isFixed--eVHns":"";return r.createElement(M.fu,{name:"Section Header",properties:{title:this.props.title,isExpanded:!!pE(this.props)&&this.props.isExpanded},trackingTargets:pc.K.RCS},r.createElement("div",{className:eI()(n,e,t,a)},pE(this.props)&&r.createElement(nC.B,{className:this.props.isExpanded?"library_section_header--expandCaretOpen--083vU library_section_header--expandCaret--20Tzs object_row--expandCaret--f1MjE object_row--indent--uZlad":"library_section_header--expandCaret--20Tzs object_row--expandCaret--f1MjE object_row--indent--uZlad",svg:this.props.isExpanded?rk.A:rA.A}),pE(this.props)&&this.props.breadcrumbPath&&!this.props.isFixed&&r.createElement("div",{className:"library_section_header--breadcrumbPath--Jevbg"},this.props.breadcrumbPath,"\xa0"),pE(this.props)&&this.props.isFixed&&this.props.stickyHeadertokens&&this.props.stickyHeadertokens.length?py(this.props.stickyHeadertokens):r.createElement("div",{className:n},this.props.title),(0,dN.sF)(this.props.subscribedLibraryKey,this.props.subscribedFileKey)&&r.createElement("div",{className:T.cx.flex.alignCenter.justifyCenter.ml4.$},r.createElement(dT.KP,{libraryKey:this.props.subscribedLibraryKey,fileKey:this.props.subscribedFileKey})),((0,d5.TX)(this.props.subscribedFileKey)||(0,d5.Ag)(this.props.subscribedFileKey))&&r.createElement("div",{className:T.cx.flex.alignCenter.justifyCenter.ml4.$},r.createElement(dI.E,{hubFileId:this.props.subscribedFileKey,showTooltip:!0,redirectToHubFile:!0}))))}}p_.H1_HEIGHT=(0,nf.hG)(pd.BS),p_.H3_HEIGHT=(0,nf.hG)(pd.T);class ph extends r.Component{render(){return r.createElement("div",{className:12===this.props.size?"library_section_header--spacer12--0h1Dt":"library_section_header--spacer16--iPkYc"})}}ph.HEIGHT=(0,nf.hG)(pd.FX);let pf="component_sidebar--stickyHeaderSpacer--SaKsM",pv=(0,nf.hG)(pd.FX),pb=(0,nf.hG)(pd.FX)/2,pS=(0,nf.hG)(pd.Nz),pT=(0,nf.hG)(pd.cP),pN=(0,d1.fv)();function pI({parent:e,outputElements:t,libraryNameByResourceId:n,items:a,keyPrefix:o,sharedOptions:l,sectionNameForTracking:i}){let c=(0,t9.PI)(a,!0),d={layout:c,...l},p=(0,t9.A5)(d),{width:m,height:u}=(0,t9.rj)(d,p),E=l.isList?1:0,g=l.isList?0:pS,y=l.isList||!n?0:pT,_=u+(l.isList?pb:pv)+g+y+E+(l.isList?0:-2);(0,s.kc)().api_asset_search_with_scores&&(_+=2*(0,nf.hG)(pd.uY));let h=m+(l.isList?pb:pv)+(l.isList?0:-2),f=0,v=d0.oz.getNextRenderedElementTop(t)+pb;for(let[d,E]of a.entries()){let a;let g=l.isList?v+f*_:v+Math.floor(f/p)*_,y=l.isList?0:3+f%p*h,b=(0,d2.V)(E),S=pN(E),T=S?n?.[S]:void 0;a=(0,s.kc)().asset_search_return_file_name&&E.file_name?E.file_name:T,t.push({parent:e,type:d0.zq.TILE,top:g,left:y,height:_,key:`${o}:${b}`,element:function({item:e,fileName:t,sourceForTracking:n,sectionNameForTracking:a,thumbLayout:o,thumbHeight:l,thumbWidth:i,isList:s,sectionPosition:c}){return r.createElement(ps,{asset:e,fileName:t,sourceForTracking:n,sectionNameForTracking:a,thumbLayout:o,thumbHeight:l,thumbWidth:i,viewMode:s?ne.Bk.List:ne.Bk.Grid,sectionPosition:c})}({containerWidth:l.containerWidth,fileName:a,sourceForTracking:l.sourceForTracking,sectionNameForTracking:i,thumbLayout:c,thumbHeight:u,thumbWidth:m,isList:l.isList,item:E,isExpanded:l.isExpanded,sectionPosition:d}),item:E,numCols:p,containerWidth:l.containerWidth,sectionNameForTracking:i,sectionPosition:d}),f+=1}}let pP=(e,t,n)=>{let a=dq(n.keyPrefix),o=d0.oz.getNextRenderedElementTop(t),l={parent:e,type:d0.zq.ROW,top:o,height:"h1"==n.size?p_.H1_HEIGHT:p_.H3_HEIGHT,key:a,element:r.createElement(p_,{size:n.size,isExpandable:!0,isExpanded:n.isExpanded,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,isFixed:!1,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}),isSticky:!0,isFixed:!1,children:[],isExpandable:!0,isExpanded:n.isExpanded,getExpandableElement:e=>r.createElement(p_,{size:n.size,isExpandable:!0,isExpanded:e,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}),sectionNameForTracking:n.sectionNameForTracking,rowType:n.rowType,fixedElement:r.createElement(r.Fragment,null,r.createElement("div",{className:pf}),r.createElement(p_,{size:"h1",isExpandable:!0,isExpanded:n.isExpanded,title:n.title,breadcrumbPath:n.breadcrumbPath?n.breadcrumbPath:null,stickyHeadertokens:n.stickyHeaderTokens?n.stickyHeaderTokens:void 0,isFixed:!0,subscribedFileKey:n.subscribedFileKey,subscribedLibraryKey:n.subscribedLibraryKey}))};return t.push(l),l};function pC({sectionHeaderText:e,isFixed:t}){return r.createElement("div",{className:eI()("component_sidebar--sectionHeader--v0N1h",t?"component_sidebar--isFixed--orinE":"")},r.createElement("div",{className:"component_sidebar--sectionHeaderText--hDKu5"},e))}function pk(e,t,n){let a=d0.oz.getNextRenderedElementTop(e),o={key:`${n.keyPrefix}:sectionHeader:${t}`,isSticky:!0,parent:null,isFixed:!1,type:d0.zq.ROW,top:a,height:40,element:r.createElement(pC,{sectionHeaderText:t,isFixed:!1}),fixedElement:r.createElement(r.Fragment,null,r.createElement("div",{className:pf}),r.createElement(pC,{sectionHeaderText:t,isFixed:!0})),isStaticRow:!0,sectionNameForTracking:n.sectionNameForTracking};return e.push(o),o}function pA({outputElements:e,results:t,moreResults:n,showMoreResults:a,keyPrefix:o,overallOptions:l,libraryNameByResourceId:i,toggleShowMoreResults:s,parent:c}){if(t.length>0&&pI({parent:c??null,outputElements:e,items:t,keyPrefix:`${o}:results`,sharedOptions:l,libraryNameByResourceId:i,sectionNameForTracking:"Primary search results"}),n.length>0){let t=d0.oz.getNextRenderedElementTop(e);e.push({parent:c??null,type:d0.zq.ROW,top:t,height:40,key:`${o}:moreResultsLink`,element:r.createElement("div",{className:"component_sidebar--text--g20jk"},a&&(0,d.tx)("design_systems.assets_panel.showing_results_from_all_libraries"),!a&&r.createElement("a",{className:"component_sidebar--link--I-ane blue_link--blueLink--9rlnd",onClick:s},(0,d.tx)("design_systems.assets_panel.more_results_in_all_libraries",{results:n.length}))),sectionNameForTracking:"More search results"}),a&&pI({parent:null,outputElements:e,items:n,keyPrefix:`${o}:moreResults`,sharedOptions:l,libraryNameByResourceId:i,sectionNameForTracking:"More search results"})}}function pw({prevParent:e,outputElements:t,inputSubtree:n,inputParentTree:a,keyPrefix:o,sharedOptions:l,sectionNameForTracking:i,hideTitle:c}){let d=dj(n,o),p=!c&&function(e,t){switch(e.type){case"FILE":return""!==e.name;case"PAGE":return t.subtrees.length>1;case"NAME_GROUP":return!e.skipElementsInRendering;case"ASSET_TYPE":return e.items.length>0||e.subtrees.length>0}}(n,a),m=function(e,t,n,a,r,o){if(!e)return null;let l=dj(a,r),i=dq(l),s=o.isExpanded(i,(0,dZ.pR)(a.type,a.sectionNameForTracking));switch(a.type){case"FILE":return pP(null,n,{keyPrefix:l,size:"h1",title:a.name,isExpanded:s,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,subscribedFileKey:a.subscribedFileKey,subscribedLibraryKey:a.subscribedLibraryKey,sectionNameForTracking:a.sectionNameForTracking,rowType:d0.l$.LIBRARY});case"PAGE":return pP(t,n,{keyPrefix:l,title:a.name,size:"h3",isExpanded:s,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,sectionNameForTracking:a.sectionNameForTracking,rowType:d0.l$.PAGE});case"NAME_GROUP":return pP(t,n,{keyPrefix:l,size:"h3",title:a.flattenedPath?a.flattenedPath:a.name,isExpanded:s,breadcrumbPath:a.breadcrumbPath?a.breadcrumbPath:void 0,stickyHeaderTokens:a.stickyHeaderTokens?a.stickyHeaderTokens:void 0,sectionNameForTracking:a.sectionNameForTracking,rowType:d0.l$.NAME_GROUP});case"ASSET_TYPE":let c=pO(a.sectionNameForTracking);return pP(t,n,{keyPrefix:l,size:"h3",title:a.name,isExpanded:!0,sectionNameForTracking:a.sectionNameForTracking,rowType:c})}}(p,e,t,n,o,l),u=m?m.children:t,E=m||e;if((0,s.kc)().dse_templates_proto){let e=n.subtrees.find(dW.Qe);null!=e&&pw({prevParent:null,outputElements:u,inputSubtree:e,inputParentTree:n,keyPrefix:o,sharedOptions:l,sectionNameForTracking:e.sectionNameForTracking})}switch(n.type){case"PAGE":case"ASSET_TYPE":case"FILE":pI({parent:E,outputElements:u,items:n.items,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});break;case"NAME_GROUP":n.skipElementsInRendering||pI({parent:E,outputElements:u,items:n.items,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});break;default:(0,a2.xb)(n.type)}for(let e of n.subtrees)(0,s.kc)().dse_templates_proto&&(0,dW.Qe)(e)||pw({prevParent:E,outputElements:u,inputSubtree:e,inputParentTree:n,keyPrefix:d,sharedOptions:l,sectionNameForTracking:i});"FILE"===n.type&&p&&function(e,t,n){let a=d0.oz.getNextRenderedElementTop(t);t.push({parent:e,type:d0.zq.SEPARATOR,top:a,height:n.size,key:`${n.keyPrefix}:spacer${n.size}`,element:r.createElement(ph,{size:n.size})})}(E,u,{keyPrefix:d,size:16})}let pO=e=>{let t=e?.toLowerCase().includes("local");return e?.toLowerCase().includes("templates")?t?d0.l$.LOCAL_TEMPLATES:d0.l$.TEMPLATES:t?d0.l$.LOCAL_COMPONENTS:d0.l$.COMPONENTS},px="root";var pR=n(545816);let pM=[];function pL(e,t,n){let a=[];return e&&pw({prevParent:null,outputElements:a,inputSubtree:e,inputParentTree:t,keyPrefix:px,sharedOptions:n,sectionNameForTracking:e.sectionNameForTracking,hideTitle:!0}),a}let pD="library-section-asset-type";function pK(e){switch(e){case"all":return{type:dE.I.ALL};case"recent":return{type:dE.I.RECENT};case"local":return{type:dE.I.LOCAL};default:return{type:dE.I.FILE,fileKey:e}}}var pF=n(56063),pV=n(639318),pU=n(40182),pB=n(39185);let pG=(0,nf.hG)(rS.gNA),pz={improved:{search:{path:[0,0],column:0},libraryModal:{path:[0,0],column:1},dropdown:{path:[0,1],column:0},viewToggle:{path:[0,1],column:1}}};function pH(e,t){(0,eP.sx)("Component Sidebar Viewed",{viewMode:(0,ne.RN)(e),assetsPanelVersion:2,fileKey:t?.key,fileTeamId:t?.teamId??void 0,fileOrgId:t?.parentOrgId??void 0})}function pW({containerSizingOptions:e,recordingKey:t}){let n=(0,e_.iZ)(),a=(0,U.q5)(),[o,l]=(0,v.fp)(dK),i=(0,c8.A)(e=>{l(e),n&&(0,cH.uE)("action_left_panel_scroll",{user:n},{assetsPanelVersion:2,tab:"assets",fileKey:a?.key,fileTeamId:a?.teamId??void 0,fileOrgId:a?.parentOrgId??void 0})},500),[s,c]=(0,v.fp)(dF);(0,eC.h)(()=>{pH(s,a)});let d=r.useCallback(()=>{c(e=>{let t=e===ne.Bk.Grid?ne.Bk.List:ne.Bk.Grid;return pH(t,a),t})},[a,c]);return r.createElement(tv.dP,{recordingKey:"localComponents",className:"component_sidebar--container--Wxtr4",dataTestId:"component-sidebar","data-does-not-dismiss-component-flyout":!0},r.createElement(pY,{initialScrollTop:o,onScroll:i,viewMode:s,toggleViewMode:d,containerSizingOptions:e,recordingKey:t}))}function pY({initialScrollTop:e,onScroll:t,viewMode:n,toggleViewMode:a,containerSizingOptions:l,recordingKey:i}){let c=(0,o.wA)(),p=(0,o.d4)(e=>e.dropdownShown),m=(0,o.d4)(t2.e_),u=(0,o.d4)(dl.hK),E=(0,o.d4)(iV.dK),g=(0,o.d4)(iV.Xt),y=(0,o.d4)(di.P),_=(0,o.d4)(e=>e.userFlags.has_dismissed_component_sidebar_library_upsell_banner),h=(0,o.d4)(e=>e.isFreeUser),f=(0,o.d4)(e=>e.user),b=(0,c3.Av)(),S=(0,U.q5)(),T=(0,dn.FC)(),N=(0,d$.D)(),{query:I,searchSessionId:P}=(0,da.Gq)();(0,pF.y)(),(0,c9.S)();let C=(0,tv.q_)();r.useEffect(()=>{c(ra.cr({shouldSearchDefaultLibraries:!1}))},[c]);let{assetType:k,libraryNameByFileKey:A,fileKeyToLibraryKey:w,onSetAssetType:O,scrollContent:x,validAssetTypeOptions:R}=function({containerSizingOptions:e,viewMode:t}){var n;let a=function(){let e=(0,o.d4)(t2.e_),t=(0,o.d4)(U.tB),n=(0,o.d4)(dH.t_),a=(0,o.d4)(e=>e.hubFiles),l=(0,o.d4)(t2.MH),i=(0,o.d4)(t2.dM),s=(0,o.d4)(t2.h3),c=(0,o.d4)(di.P),d=(0,de.Ck)(),p=(0,dS.Sd)(),m=(0,dS.Fl)(),u=t?.teamId?c[t.teamId]:null,E=!!u&&(0,dr.w5)(u),g=r.useMemo(()=>(0,ne.Sg)(l,i),[l,i]),y=r.useMemo(()=>(0,ne.ND)(s),[s]),_=(0,ne.UY)(e,n),h=(0,dY.Lm)(),f=(0,ne.jl)(h,n),v=(0,ne.Tk)(e,a),b=r.useMemo(()=>d()?v:null,[d,v]);return(0,dz.jP)(b),r.useMemo(()=>(0,dW.Nx)({localLibraryItemsInfo:g,localTemplatesInfo:y,subscribedItemsInfo:_,subscribedTemplatesInfo:f,subscribedCommunityItemsInfo:b,defaultSubscribedItemsInfo:(0,ne.Mt)(),canPublish:E,currentFileKeyForPublish:t?(0,dG.Kz)(t)?t.sourceFileKey:t.key:null,approvedLibraryFileKeysByResourceType:p,approvedLibraryKeysByResourceType:m}),[g,y,_,f,b,E,t,p,m])}(),{productComponents:l,templates:i}=(0,dV.g5)(dU.$A.Design),c=(0,o.d4)(dm.q5),p=(0,d$.D)(),m=r.useMemo(()=>({productComponents:l,templates:(0,s.u4)("dse_editor_templates_v1",i,[])}),[l,i]),u=r.useMemo(()=>c?dE.v:function(e,t,n,a=[]){let r=!!((0,s.kc)().dse_editor_templates_v1&&n&&(n.items.length>0||t.subtrees.length>0));return{[dE.I.ALL]:!0,[dE.I.RECENT]:!!(e.length+(0,s.u4)("dse_editor_templates_v1",a.length,0)),[dE.I.LOCAL]:t.items.length>0||t.subtrees.length>0||r,[dE.I.FILE]:!1,[dE.I.SITE_KIT]:!1}}(l,a.localSubtree,a.localTemplateSubtree,i),[c,l,i,a.localSubtree,a.localTemplateSubtree]),E=(n=a.subscribedFileSubtrees,r.useMemo(()=>{let e={};for(let[t,a]of Object.entries(n))a&&(e[t]=a.name);return e},[n])),g=a.fileKeyToLibraryKey,{assetType:y,onSetAssetType:_}=function(e,t){let[n,a]=r.useState(!1),[l,i]=r.useState({type:dE.I.ALL}),s=(0,o.wA)(),c=(0,o.d4)(dm.q5),d=(0,U.q5)();r.useEffect(()=>{n||"loading"===e||(i(dB(function(){if(re.x4)try{let e=re.x4.getItem(pD);if(!e)return;return pK(e)}catch(e){return}}(),e,t)),a(!0))},[n,e,t]);let p=r.useCallback(e=>{(!c||(0,dm.eu)(e))&&(i(e),re.x4?.setItem(pD,function(e){switch(e.type){case dE.I.ALL:return"all";case dE.I.RECENT:return"recent";case dE.I.LOCAL:return"local";case dE.I.FILE:return e.fileKey;case dE.I.SITE_KIT:return""}}(e)),c&&s(ra.gP({searchOptions:e})),eP.az.trackDefinedEvent("assets_panel.asset_type_changed",{assetType:e.type,isSearching:!!c,fileKey:e.type===dE.I.FILE?e.fileKey:void 0,openFileKey:d?.key,fileTeamId:d?.teamId??void 0,fileOrgId:d?.parentOrgId??void 0,assetsPanelVersion:2}))},[c,s,d?.key,d?.parentOrgId,d?.teamId]),m=r.useCallback(e=>e.key===pD&&null!=e.newValue,[]),u=r.useCallback(n=>{if(!n)return;let a=pK(n);"loading"!==e&&i(dB(a,e,t))},[e,t]);return(0,re.tl)({onSync:u,shouldSyncValue:m}),{assetType:l,onSetAssetType:p}}(p?"loading":u,E),h=function({assetType:e,containerSizingOptions:t,recentlyUsedItems:n,treeWithSubtrees:a,viewMode:o}){let{library:l}=(0,sD.R)(e=>({library:e.library})),i=(0,pR.O)(),[c,p]=r.useState(!1),m=o===ne.Bk.List,u=r.useMemo(()=>({isList:m,isExpanded:dZ.xO,sourceForTracking:ne.mZ,...t}),[t,m]),E=r.useMemo(()=>{let e,t;let{query:n,normalizedSearchResults:a,unsubscribedSearchResults:r}=l.assetsPanelSearch;if(!n)return pM;(0,s.kc)().dse_editor_templates_v1?[t,e]=(0,dm._2)(a):e=a;let o=e,m=o.length+r.length;if(0===m&&(!t||0===t.length))return pM;!c&&0===o.length&&r.length>0&&p(!0);let E=[];if(t&&t.length>0&&(0,s.kc)().dse_editor_templates_v1){let e=pk(E,(0,d.t)("design_systems.assets_panel.templates"),{keyPrefix:dQ(px),sectionNameForTracking:"Templates search results"});pA({outputElements:E,results:t,moreResults:[],showMoreResults:!1,keyPrefix:dQ(px),overallOptions:u,libraryNameByResourceId:i,toggleShowMoreResults:()=>{},parent:e})}if(m>0){let e=(0,s.kc)().dse_editor_templates_v1?pk(E,(0,d.t)("design_systems.assets_panel.components"),{keyPrefix:`${px}:${dX}`,sectionNameForTracking:"Primary search results"}):null;pA({outputElements:E,results:o,moreResults:r,showMoreResults:c,keyPrefix:`${px}:${dX}`+((0,s.kc)().dse_editor_templates_v1?"1":""),overallOptions:u,libraryNameByResourceId:i,toggleShowMoreResults:()=>{p(e=>!e)},parent:e})}return E},[i,l.assetsPanelSearch,u,c]),{productComponents:g,templates:y}=n,_=r.useMemo(()=>{if(!g.length&&!y.length)return pM;let e=[];return(0,s.kc)().dse_editor_templates_v1?(y.length>0&&pI({parent:pk(e,(0,d.t)("design_systems.assets_panel.templates"),{keyPrefix:dJ(px+":templates"),sectionNameForTracking:"Recently used templates"}),outputElements:e,items:y,keyPrefix:dJ(px+":templates"),sharedOptions:u}),g.length>0&&pI({parent:pk(e,(0,d.t)("design_systems.assets_panel.components"),{keyPrefix:dJ(px+":components"),sectionNameForTracking:"Recently used"}),outputElements:e,items:g,keyPrefix:dJ(px+":components"),sharedOptions:u})):pI({parent:null,outputElements:e,items:g,keyPrefix:dJ(px),sharedOptions:u}),e},[g,y,u]),h=r.useMemo(()=>(0,s.kc)().dse_editor_templates_v1?function(e,t,n){let a=[];return e.forEach(e=>{e&&pw({prevParent:null,outputElements:a,inputSubtree:e,inputParentTree:t,keyPrefix:px,sharedOptions:n,sectionNameForTracking:e.sectionNameForTracking,hideTitle:!1})}),a}([a.localTemplateSubtree,a.localSubtree],a.tree,u):pL(a.localSubtree,a.tree,u),[u,a.localSubtree,a.localTemplateSubtree,a.tree]),f=r.useMemo(()=>pL(e.type===dE.I.FILE?a.subscribedFileSubtrees[e.fileKey]:void 0,a.tree,u),[e,u,a.subscribedFileSubtrees,a.tree]),v=r.useMemo(()=>{let e=[];return!function(e,t,n,a){if((0,s.kc)().dse_templates_proto){let r=t.subtrees.find(dW.Qe);null!=r&&pw({prevParent:null,outputElements:e,inputSubtree:r,inputParentTree:t,keyPrefix:n,sharedOptions:a,sectionNameForTracking:r.sectionNameForTracking})}for(let r of(t.items.length>0&&pI({parent:null,outputElements:e,items:t.items,keyPrefix:n,sharedOptions:a}),t.subtrees))(0,s.kc)().dse_templates_proto&&(0,dW.Qe)(r)||pw({prevParent:null,outputElements:e,inputSubtree:r,inputParentTree:t,keyPrefix:n,sharedOptions:a,sectionNameForTracking:r.sectionNameForTracking})}(e,a.tree,px,u),e},[u,a.tree]);return l.assetsPanelSearch.query?E:e.type===dE.I.RECENT?_:e.type===dE.I.LOCAL?h:e.type===dE.I.FILE?f:v}({assetType:y,containerSizingOptions:e,recentlyUsedItems:m,treeWithSubtrees:a,viewMode:t});return{assetType:y,libraryNameByFileKey:E,fileKeyToLibraryKey:g,onSetAssetType:_,scrollContent:h,validAssetTypeOptions:u}}({viewMode:n,containerSizingOptions:l}),[M,L]=(0,v.fp)(e8.Cl);(0,eC.h)(()=>{M&&(O({type:dE.I.FILE,fileKey:M}),L(null))});let D=(0,dt.LR)(),K=(0,o.d4)(e=>e.universalInsertModal.showing),F=r.useCallback(()=>{K&&D()},[D,K]),V=r.useCallback((e,t,n)=>{F(),c((0,le.to)({type:dM.m,data:{asset:e,searchSessionId:P??void 0,query:I??void 0,sectionPosition:t,sectionNameForTracking:n,assetTypeDropdownSelection:k?.type,containerWidth:l.containerWidth,onGetKeyboardNavigationItemById:C}}))},[k,l.containerWidth,c,F,C,P,I]),B=r.useMemo(()=>({onOpenFlyout:V,assetTypeDropdownSelection:k?.type}),[k,V]);(0,pU.d)({allElements:x});let G=n===ne.Bk.List,z=m.assetsPanelSearch,H=0===x.length,W=p?.type===pa.K.ASSETS_PANEL,Y=W&&p?.data?.component||null,$=(0,pV.K)(!0),X=r.useCallback(()=>{W||(0,ee.wr)()},[W]),[j,Q]=(0,re.Vc)("has-auto-expanded-component-libraries-for-nux",!1),J=(0,de.Ck)(),q=r.useRef(null);r.useEffect(()=>{let e=q.current;e&&0!==x.length&&J()&&!j&&e.expandAllComponentLibraries(308)>0&&Q(!0)},[j,J,x.length,Q]);let Z=r.useCallback(()=>{let e=!!m.assetsPanelSearch.query,t=0===x.length;return r.createElement("div",null,e&&t&&r.createElement(dc.Wq,null),!e&&t&&r.createElement(dc.od,null))},[m.assetsPanelSearch,x.length]),et=N||z.isLoading,en=(0,e1.jO)(),ea=S?.teamId?y[S.teamId]:null,er=!_&&h&&(!ea||!(0,dr.w5)(ea)&&(0,aD.canEditTeam)(ea.id,T))&&S?.canEdit&&en&&Object.keys(m.local.components).length>0&&(0,c6.Hz)(f?.id);return r.createElement(dR.U.Provider,{value:B},r.createElement(p$,{assetType:k,componentsEmpty:H,isList:G,isSearching:!!z.query,isComponentSidebarInitialLoading:N,libraryNameByFileKey:A,fileKeyToLibraryKey:w,onSetAssetType:O,onToggleViewMode:a,recordingKey:i,validAssetTypeOptions:R}),et?r.createElement("div",{className:"component_sidebar--loadingSpinnerContainerWithDropdown--9b8ZI"},r.createElement(c7.kt,null)):r.createElement("div",{className:"component_sidebar--assetPanelSection--mYuo2"},r.createElement(c5.O,{ref:q,scrollContent:x,recordingKey:"componentsListContainer",isList:G,getViewportHeight:e=>e-2*b,topOffset:pG,isTileSelected:e=>!!e.item.isLocal&&g&&(0,ds.sp)(E,g,e.item.node_id),onMouseUp:X,renderEmptyState:Z,width:l.containerWidth,className:"component_sidebar--scrollContainerFullHeight---DTUM component_sidebar--_scrollContainerBase--1rakD",initialScrollTop:e,onScroll:t,enableKeyboardNavigation:!0,shouldRefocusAfterKeyboardInsert:k.type===dE.I.RECENT,fileKey:S?.key,teamId:S?.teamId??void 0,orgId:S?.parentOrgId??void 0}),!!Y&&r.createElement(pa.h,{selectedView:u,dropdownShown:p,onJumpToLocalComponent:$,onOpenFlyout:V,usePortal:!0}),er&&r.createElement(pB.V,null)))}function p$({assetType:e,componentsEmpty:t,isList:n,isSearching:a,isComponentSidebarInitialLoading:o,libraryNameByFileKey:l,fileKeyToLibraryKey:i,onSetAssetType:s,onToggleViewMode:c,validAssetTypeOptions:d,recordingKey:p}){let m=pz.improved,{setKeyboardNavigationElement:u}=(0,tv.M3)({path:m.libraryModal.path,column:m.libraryModal.column}),{setKeyboardNavigationElement:E}=(0,tv.M3)({path:pz.improved.dropdown.path,column:pz.improved.dropdown.column}),{setKeyboardNavigationElement:g}=(0,tv.M3)({path:m.viewToggle.path,column:m.viewToggle.column});return r.createElement("div",null,r.createElement("div",{className:"component_sidebar--searchHeader--yTD7D component_sidebar--_header--nHN39"},r.createElement(dg,{searchOptions:{type:e,onSetAssetType:s},keyboardNavigationPath:m.search.path,keyboardNavigationColumn:m.search.column}),r.createElement(dy.b,{entrypoint:dd.r6.ASSETS_PANEL_BUTTON,onSetKeyboardNavigationElement:u,recordingKey:p})),o||t&&!a?null:r.createElement("div",{className:"component_sidebar--pageHeader--m9FWc component_sidebar--_header--nHN39"},r.createElement(dk,{assetType:e,libraryNameByFileKey:l,fileKeyToLibraryKey:i,onSetAssetType:s,onSetKeyboardNavigationElement:E,validAssetTypeOptions:d}),r.createElement(dx,{isList:n,onToggleViewMode:c,onSetKeyboardNavigationElement:g,recordingKey:p})))}var pX=n(743415),pj=n(443121),pQ=n(334877),pJ=n(745639);function pq({children:e}){return r.createElement("div",{className:"objects_panel_container--container--jBz9j"},e)}var pZ=n(513443),p0=n(653671),p1=n(359108),p2=n(735056),p4=n(332721),p8=n(163280);function p3({showTabs:e,activeTab:t,isComparingChanges:n,pageTabChevron:a,currentPageName:o,onCanvasSearch:l,onPageContextMenu:s,onTogglePages:c,recordingKey:p}){let m=(0,p1.U)(),u=(0,cW.dh)(),E=(0,n0.rf)(n0.Pt(p,"collapsedRow"),"contextmenu",(0,r.useCallback)(e=>{(0,ro.jo)(e),s({nodeId:u,clientX:e.clientX,clientY:e.clientY})},[s,u]));return r.createElement(p2.y,{withBorder:!0},e&&r.createElement(r.Fragment,null,r.createElement(p4._,{onClick:l}),r.createElement(nr.Bx,{className:t===i.xae.LAYERS?p8.yR:p8.Mf,onMouseDown:m.showLayersPanel,onContextMenu:ro.jo,"data-label":(0,d.t)("fullscreen.pages_panel.layers_tab"),recordingKey:n0.Pt(p,"tab","layers"),innerText:"Layers"},(0,d.tx)("fullscreen.pages_panel.layers_tab")),r.createElement(nr.Bx,{className:p8.dB,onMouseDown:()=>m.showPublish(),onContextMenu:ro.jo,recordingKey:n0.Pt(p,"tab","assets"),innerText:"Assets","data-onboarding-key":eb.Qr},r.createElement("div",{className:t===i.xae.ASSETS?p8.yR:p8.Mf,"data-label":(0,d.t)("fullscreen.pages_panel.assets_tab")},r.createElement("div",null,(0,d.tx)("fullscreen.pages_panel.assets_tab"))))),!e&&r.createElement("div",{className:eI()("ui2_tabs_row--viewOnlySearchRow--lXeEC",{"ui2_tabs_row--hidden--H29bc":n})},r.createElement(cL.Y,{onFocus:l})),r.createElement(nn.E,{className:eI()("ui2_tabs_row--toggleButton--3lJw1",{"ui2_tabs_row--viewOnly--crQc4":!e}),onClick:c,htmlAttributes:{onContextMenu:E},recordingKey:n0.Pt(p,"collapsedRow")},r.createElement("span",{className:"ui2_tabs_row--pageTitle--PPrKt ellipsis--ellipsis--Tjyfa","data-onboarding-key":"pages-panel-toggle"},o||""),r.createElement(nC.B,{className:"ui2_tabs_row--chevron--GSVx7",svg:a})))}var p5=n(693394),p7=n(350428),p6=n(180518),p9=n(412990),me=n(652649);function mt({isReadOnly:e,renamingGuid:t,isLayersOpen:n,onToggleLayers:a,currentPageGuid:o,width:l,startRenamingNode:i,stopRenamingNode:c,versionHistory:p,recordingKey:m,onSelectionUpdated:u}){let E=(0,U.q5)(),g=E?.thumbnailGuid||null,y=(0,z.Fk)(e=>{let t=e.getCurrentPage();return t&&(0,p7.HI)(t)})&&(0,s.kc)().aip_lpe_overflow;return r.createElement(r.Fragment,null,r.createElement(p6.B,null,r.createElement(p9.H,{dataOnboardingKey:cY.BZ},r.createElement(nn.E,{onClick:a,className:"ui3_objects_panel--toggleButton--A3BEZ",recordingKey:n0.Pt(m,"layersCollapsedRow")},r.createElement(me.g,{isExpanded:n}),(0,d.tx)("fullscreen.pages_panel.layers_tab")),y&&r.createElement(mn,null))),n&&r.createElement(pQ.X,{isReadOnly:e,currentPage:o,width:l,renamingGuid:t,startRenaming:i,stopRenaming:c,thumbnailGuid:g,versionHistory:p,onSelectionUpdated:u}))}function mn(){let e=(0,r.useMemo)(()=>[{displayText:(0,d.t)("fullscreen.pages_panel.rename_all_layers_menu_item"),callback:()=>{(0,p7.vm)(),(0,p7.Br)({source:i.uQ6.LAYERS_PANEL_OVERFLOW_MENU,trackingDataSource:"layers_panel_overflow_menu"})}}],[]);return r.createElement(p5.kB,{dropdownItems:e})}var ma=n(161312),mr=n(412371),mo=n(519688),ml=n(173521);let mi=new Map;var ms=n(783423),mc=n(560560);function md(){let e=(0,eK.cT)(),{pagesList:t,pageToNumChangesMap:n,isComparingChanges:a}=function(){let e=(0,eK.n0)(),t=(0,o.d4)(e=>!!(0,s.kc)().version_diffing&&e.mirror.appModel.activeCanvasEditModeType===i.m1T.COMPARE_CHANGES),n=(0,o.d4)(e=>e.versionHistory.compareId);return r.useMemo(()=>{if(!t||!n)return{pagesList:e,pageToNumChangesMap:mi,isComparingChanges:t};let a=(0,c1.ee)(e);return{pagesList:e,pageToNumChangesMap:a,isComparingChanges:t}},[t,n,e])}(),l=(0,mr.g)({pagesList:t}),c=(0,eK.GQ)();return t.length?r.createElement(mp,{recordingKey:"pagesPanel",isReadOnly:e,width:c,pagesList:t,isComparingChanges:a,pageToNumChanges:n,onPageContextMenu:l}):null}function mp({width:e,isReadOnly:t,pagesList:n,onPageContextMenu:a,isComparingChanges:l,pageToNumChanges:s,recordingKey:c}){let d=(0,eu.GS)(),p=(0,pX.M)(),m=(0,pr._j)(),u=(0,U.q5)(),E=(0,o.d4)(e=>t||!u?i.xae.LAYERS:e.leftPanel.activeTab),g=(0,o.d4)(e=>e.versionHistory),y=(0,cW.dh)(),_=(0,cW.nn)(),h=(0,v.md)(p0.l7),f=(0,p1.U)(),{toggleManageMemoryModal:b,closeManageMemoryModal:S}=(0,cX.P)({sidebarWidth:e}),T=(0,et.T)();(0,ml.U)();let{isLayersOpen:N,toggleLayersAction:I}=(0,eK.vr)(),{renamingNodeGuid:P,startRenamingNode:C,stopRenamingNode:k}=(0,eK.TU)(),A=(0,eK._4)(),{height:w,setHeight:O,isOpen:x,setIsOpen:R}=(0,mo.d)({defaultIsOpen:n.length>1||d}),M=E===i.xae.LAYERS,L=M&&(!!d||x),D=x&&M?mc.A:ms.A,K=i.AWq.getChunkChangeCount(),F=(0,o.Pj)(),V=(0,r.useCallback)(e=>{f.showLayersPanel(),(0,cH.ds)("pages_panel_open_toggle",u?.key,F.getState(),{isPagesOpen:e},{forwardToDatadog:!0}),R(e)},[u,f,R,F]),B=(0,r.useCallback)(()=>{V(!0)},[V]),G=(0,cG.F)(x),z=(0,r.useCallback)(()=>{V(!G.current)},[G,V]),H=(0,cB.$)(h);return(0,r.useEffect)(()=>{h&&H&&!t&&B()},[H,h,t,B]),r.createElement(pJ.A,{isFullHeight:!0},d?r.createElement(r.Fragment,null,r.createElement(cz.$,null),!t&&r.createElement(ma.I,{recordingKey:c,activeTab:E,onCanvasSearch:A})):r.createElement(r.Fragment,null,r.createElement(p3,{recordingKey:c,showTabs:!t,activeTab:E,pageTabChevron:D,isComparingChanges:l,currentPageName:_,onCanvasSearch:A,onTogglePages:E===i.xae.ASSETS?B:z,onPageContextMenu:a}),E===i.xae.LAYERS&&r.createElement(cz.$,null)),l&&M&&r.createElement(r.Fragment,null,g.compareId&&r.createElement(c4.ZI,{compareId:g.compareId,versions:g.versions}),K>0&&r.createElement(p2.y,{withBorder:!0},r.createElement(c2,null))),u&&r.createElement(c$.QU,{fileKey:u.key,toggleManageMemoryModal:b,closeManageMemoryModal:S}),L&&r.createElement(pZ.R,{isOpen:x,onToggle:z,height:w,onHeightChange:O,showHeader:!T,pages:n,isComparingChanges:l,pageToNumChanges:s,isReadOnly:t,onPageContextMenu:a,onCanvasSearch:A}),M&&r.createElement(pq,null,m&&N&&r.createElement(ed.p,null,r.createElement(cY.Ay,null)),d?r.createElement(mt,{isReadOnly:t,isLayersOpen:N,onToggleLayers:I,currentPageGuid:y,width:e,renamingGuid:P,startRenamingNode:C,stopRenamingNode:k,versionHistory:g,recordingKey:c}):r.createElement(pQ.X,{isReadOnly:t,currentPage:y,width:e,renamingGuid:P,startRenaming:C,stopRenaming:k,thumbnailGuid:u?.thumbnailGuid||null,versionHistory:g})),E===i.xae.ASSETS&&r.createElement(r.Fragment,null,p?r.createElement(pj.g,{width:e}):r.createElement(pW,{recordingKey:"componentsSidebar",containerSizingOptions:{containerWidth:e,maxSmallThumbSize:40,maxWideColWidth:300}})))}let mm=r.memo(function(){let e=(0,v.md)((0,t2.Xh)(void 0)),t=(0,U.q5)(),n=(0,eu.GS)(),a=(0,V.aV)();(0,eK.bi)();let o=(0,J.X0)(),l=!!t&&e,s=(0,eo.J2)(i.Ez5.uiState().showCanvasSearch);return r.useEffect(()=>{l&&(0,ex.YQ)({id:"Found Updates To Publish"})},[l]),r.createElement(cU.Q,{ignoreRulers:a},r.createElement(cK.s,null),r.createElement(cD.$,null,n&&r.createElement(cV.n,null),n&&r.createElement(cF.d,{shouldUseBottomBorder:!o}),s?r.createElement(cM.EA.Provider,{value:!0},r.createElement(cL.f,{showFilter:!0})):r.createElement(md,null)))});var mu=n(319008),mE=n(988889),mg=n(959369),my=n(359919);let m_=(0,r.memo)(function(e){return(0,nS.jsxs)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:[(0,nS.jsx)("mask",{id:"fpl-icon-24-mail-a",fill:"#fff",children:(0,nS.jsx)("path",{fillRule:"evenodd",d:"M5.88 7h12.24a.88.88 0 0 1 .88.88v.82l-7 3.733L5 8.7v-.82A.88.88 0 0 1 5.88 7M4 8.99v7.13A1.88 1.88 0 0 0 5.88 18h12.24A1.88 1.88 0 0 0 20 16.12V7.88A1.88 1.88 0 0 0 18.12 6H5.88A1.88 1.88 0 0 0 4 7.88zm15 .843v6.287a.88.88 0 0 1-.88.88H5.88a.88.88 0 0 1-.88-.88V9.833l6.765 3.608.235.126.235-.126z",clipRule:"evenodd"})}),(0,nS.jsx)("path",{fill:"var(--color-icon)",d:"m19 8.7.47.882L20 9.3v-.6zm-7 3.733-.47.883.47.25.47-.25zM5 8.7H4v.6l.53.282zm-1 .31h1v-.02zm0-.02 1 .02v-.02zm16 .02-1-.02v.02zm0-.02h-1v.02zm-1 .843h1V8.167l-1.47.784zm-14 0 .47-.882L4 8.167v1.666zm6.765 3.608-.47.882zm.235.126-.47.882.47.251.47-.251zm.235-.126.471.882zM18.12 6H5.88v2h12.24zM20 7.88A1.88 1.88 0 0 0 18.12 6v2a.12.12 0 0 1-.12-.12zm0 .82v-.82h-2v.82zm-7.53 4.616 7-3.734-.94-1.764-7 3.733zM4.53 9.582l7 3.734.94-1.765-7-3.733zM4 7.88v.82h2v-.82zM5.88 6A1.88 1.88 0 0 0 4 7.88h2a.12.12 0 0 1-.12.12zM5 8.99v.02l-2-.04v.06zm-2 .02v7.11h2V9.01zm0 7.11A2.88 2.88 0 0 0 5.88 19v-2a.88.88 0 0 1-.88-.88zM5.88 19h12.24v-2H5.88zm12.24 0A2.88 2.88 0 0 0 21 16.12h-2a.88.88 0 0 1-.88.88zM21 16.12V9.01h-2v7.11zm-2-7.11v-.02l2 .04v-.06zm2-.02V7.88h-2v1.11zm0-1.11A2.88 2.88 0 0 0 18.12 5v2a.88.88 0 0 1 .88.88zM18.12 5H5.88v2h12.24zM5.88 5A2.88 2.88 0 0 0 3 7.88h2A.88.88 0 0 1 5.88 7zM3 7.88v1.11h2V7.88zm17 8.24V9.833h-2v6.287zM18.12 18A1.88 1.88 0 0 0 20 16.12h-2a.12.12 0 0 1 .12-.12zM5.88 18h12.24v-2H5.88zM4 16.12A1.88 1.88 0 0 0 5.88 18v-2a.12.12 0 0 1 .12.12zm0-6.287v6.287h2V9.833zm8.235 2.726L5.471 8.95l-.941 1.765 6.764 3.608zm.236.125-.236-.125-.94 1.765.235.125zm-.706-.125-.236.125.942 1.765.235-.126zm6.764-3.608-6.764 3.608.941 1.765 6.765-3.608z",mask:"url(#fpl-icon-24-mail-a)"})]})});var mh=n(137035),mf=n(737947),mv=n(809840),mb=n(218997),mS=n(15839),mT=n(233286);function mN(){let e=(0,D.e)({overlay:$.Dqt,priority:H.N.DEFAULT_MODAL});(0,L.E)(e.uniqueId,"commentThreadMobileAnnouncementClicked",()=>{(0,eP.sx)("sidebar_announcement_mobile_app_download_prompt_modal_shown"),e.show({})});let t=(0,r.useCallback)(async()=>{(0,eP.sx)("sidebar_announcement_mobile_app_download_prompt_email_me_cta_clicked"),await tM.Ay.post("/api/send_mobile_download_email"),e.complete()},[e]);return r.createElement(mb.h,{isShowing:e.isShowing,modalType:mS.q3.FEATURE_UPDATE,closeButtonStyle:mS.M_.ON_DARK,element:()=>r.createElement(mI,{onEmailClick:t}),trackingContextName:"mobile_comment_announcement",onClickPrimaryCta:e.complete,onClose:e.complete,onManualDismiss:e.complete})}function mI(e){return r.createElement("div",{className:"modal_comment_sidebar_announcement--container--5oh-p"},r.createElement("div",{className:"modal_comment_sidebar_announcement--imageContainer--Vuo-V"},r.createElement("img",{alt:"Background",src:(0,s.ck)("e19f2f58bc09414847ad59ff9228e07032e8842c"),className:"modal_comment_sidebar_announcement--image--lyA61"}),r.createElement("div",{className:"modal_comment_sidebar_announcement--spacer--m02YT"}),r.createElement(mT.T,null)),r.createElement("div",{className:"modal_comment_sidebar_announcement--textContainer--btaTy"},r.createElement("div",{className:"modal_comment_sidebar_announcement--title--eiyLq"},r.createElement(mv.E,{fontSize:24,fontWeight:"semi-bold"},(0,d.t)("rcs.mobile_comment_announcement.title"))),r.createElement("div",{className:"modal_comment_sidebar_announcement--description--Y8AJE"},r.createElement(mv.E,{fontSize:14},(0,d.t)("rcs.mobile_comment_announcement.description")))),r.createElement("div",{className:"modal_comment_sidebar_announcement--buttonsContainer--UTcgc"},r.createElement(n3.$n,{variant:"secondary",onClick:e.onEmailClick,iconPrefix:r.createElement(m_,null)},(0,d.t)("rcs.mobile_comment_announcement.email_download_link")),r.createElement(n3.$n,{variant:"primary",onClick:()=>{(0,eP.sx)("sidebar_announcement_mobile_app_download_prompt_learn_more_cta_clicked"),mf.Ay.unsafeRedirect("https://help.figma.com/hc/articles/1500007537281-Guide-to-the-Figma-mobile-app#download","_blank")},iconPrefix:r.createElement(mh.b,null)},(0,d.t)("rcs.rcs_shared.learn_more"))))}var mP=n(618249),mC=n(866206),mk=n(355819),mA=n(83695),mw=n(344780),mO=n(820286),mx=n(503965);let mR=(0,i5.ex)("prototype_action_info",function(){return r.createElement("div",{className:T.cx.flex.itemsCenter.justifyCenter.$},r.createElement(nC.B,{className:"prototype_action_info_tooltip--prototypeDestinationInfoIcon--GeQWS",svg:mx.A}),r.createElement("span",{className:T.cx.flexGrow1.m6.$,style:{maxWidth:144}},(0,d.tx)("proto.prototype_panel.use_the_circular_node_to_connect_the_selected_object_to_another_frame_tooltip")))},()=>({unconstrainWidth:!0})),mM=(0,r.memo)(function(e){return(0,nS.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nS.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M11.5 6a.5.5 0 0 1 .5.5V11a1 1 0 0 0 1 1h4.5a.5.5 0 0 1 0 1H13a2 2 0 0 1-2-2V6.5a.5.5 0 0 1 .5-.5",clipRule:"evenodd"})})});var mL=n(240604),mD=n(444851),mK=n(647899);let mF=lU.c$,mV=lU.l6;function mU({action:e}){return r.createElement("div",{className:"prototype_action_dropdown--prototypeActionIcon--qChhY"},r.createElement(rh.U,{svg:(0,iK.Yb)(e)},(0,iK.av)(e)))}function mB(e){let t=`prototype-action-select-${e.recordingKey}`,n=e.dropdownShown&&e.dropdownShown.type===t,a=(0,aq.E7)(e.action),l=(0,iK.Yb)(a),i=(0,iK.av)(a),s=(0,eu.GS)(),c=(0,o.d4)(iG.ZM),d=new iD.js(s,c),p=new iD.Z6(s,c),m=n?d:p,u=!(0,o.d4)(e=>e.mirror.selectionProperties.isValidPrototypingSourceSelected??!0),E=r.useCallback(e=>e-24,[]),g=r.useCallback(e=>e+24,[]),[y,_]=r.useState(void 0),h=r.createElement(mD.Q,{setMaxWidth:_,options:mG(e),formatOption:e=>e&&e.props.value?m.format(e.props.value):"",getIcon:()=>r.createElement(mU,{action:"NAVIGATE_TO"})}),f=eI()({[e.className??""]:!0,"prototype_action_dropdown--select--b3Ssx":!s}),v=r.createElement(rh.U,{svg:l},i);return r.createElement(r.Fragment,null,r.createElement(mV,{disabled:u,id:t,dataTestId:"action-select",className:f,chevronClassName:"prototype_action_dropdown--prototypeActionChevron--ZL1Q4",inputClassName:"prototype_action_dropdown--prototypeActionInputWithSvg--Atfua",property:e.action,formatter:m,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,icon:v,iconClassName:"prototype_action_dropdown--selectActionSvg--XfhUx",recordingKey:n0.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,ak.nl)(),dropdownAlignment:E,dropdownWidth:s?y:g},mG(e)),s&&h)}function mG(e){let t=(0,l7.cJ)(),n=(0,eu.GS)(),a=r.createElement(mF,{key:"NONE",value:"NONE",icon:r.createElement(mU,{action:"NONE"}),recordingKey:n0.Pt(e,"clear-option"),disabled:!1}),o=r.createElement(mF,{key:"NAVIGATE_TO",value:"NAVIGATE_TO",icon:r.createElement(mU,{action:"NAVIGATE_TO"}),recordingKey:n0.Pt(e,"navigate-to-option"),disabled:!1}),l=r.createElement(mF,{key:"SWAP_STATE_TO",value:"SWAP_STATE_TO",icon:r.createElement(mU,{action:"SWAP_STATE_TO"}),recordingKey:n0.Pt(e,"swap-state-to-option"),disabled:!i.glU.isSelectionContainedInStateOrStateInstance()}),c=r.createElement(mF,{key:"GO_BACK",value:"GO_BACK",icon:r.createElement(mU,{action:"GO_BACK"}),recordingKey:n0.Pt(e,"back-option"),disabled:!1}),d=r.createElement(mF,{key:"SCROLL_TO",value:"SCROLL_TO",icon:r.createElement(mU,{action:"SCROLL_TO"}),recordingKey:n0.Pt(e,"scroll-to-option"),disabled:!1}),p=r.createElement(mF,{key:"OPEN_URL",value:"OPEN_URL",icon:r.createElement(mU,{action:"OPEN_URL"}),recordingKey:n0.Pt(e,"url-option"),disabled:!1}),m=r.createElement(mF,{key:"OPEN_OVERLAY",value:"OPEN_OVERLAY",icon:r.createElement(mU,{action:"OPEN_OVERLAY"}),recordingKey:n0.Pt(e,"open-overlay-option"),disabled:!1}),u=r.createElement(mF,{key:"SWAP_WITH",value:"SWAP_WITH",icon:r.createElement(mU,{action:"SWAP_WITH"}),recordingKey:n0.Pt(e,"swap-with-option"),disabled:!1}),E=r.createElement(mF,{key:"CLOSE_OVERLAY",value:"CLOSE_OVERLAY",icon:r.createElement(mU,{action:"CLOSE_OVERLAY"}),recordingKey:n0.Pt(e,"close-option"),disabled:!1}),g=r.createElement(mF,{key:"SET_VARIABLE",value:"SET_VARIABLE",icon:r.createElement(mU,{action:"SET_VARIABLE"}),recordingKey:n0.Pt(e,"set-variable"),disabled:!1}),y=(0,s.kc)().prototype_set_mode_action&&r.createElement(mF,{key:"SET_VARIABLE_MODE",value:"SET_VARIABLE_MODE",icon:r.createElement(mU,{action:"SET_VARIABLE_MODE"}),recordingKey:n0.Pt(e,"set-variable-mode"),disabled:!1}),_=!e.isNestedInConditional&&r.createElement(mF,{key:"CONDITIONAL",value:"CONDITIONAL",icon:r.createElement(mU,{action:"CONDITIONAL"}),recordingKey:n0.Pt(e,"conditional"),disabled:!1}),h=r.createElement(lU.sK,{key:"first-divider"}),f=r.createElement(lU.sK,{key:"second-divider"}),v=r.createElement(lU.sK,{key:"third-divider"}),{getConfig:b}=(0,mK.I7)("exp_prototyping_reorder_actions"),S=!!b().getValue("new_ordering",!1),T=(0,s.kc)().sts_interaction_interop&&t?[l,c,d,h,g,_]:n?S?[a,h,o,l,c,d,p,f,g,y,_,v,m,u,E]:[a,h,o,l,c,d,p,f,m,u,E,v,g,y,_]:[a,h,o,l,c,f,g,y,_,d,p,v,m,u,E];if(e.showVideoActions&&!t){let t=[r.createElement(lU.sK,{key:"fourth-divider"}),r.createElement(mF,{key:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",value:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS",icon:r.createElement(mU,{action:"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS"}),recordingKey:n0.Pt(e,"update-media-play-pause-options"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",value:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS",icon:r.createElement(mU,{action:"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS"}),recordingKey:n0.Pt(e,"update-media-mute-unmute-options"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_SKIP_TO",value:"UPDATE_MEDIA_SKIP_TO",icon:r.createElement(mU,{action:"UPDATE_MEDIA_SKIP_TO"}),recordingKey:n0.Pt(e,"update-media-skip_to"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_SKIP_BY_OPTIONS",value:"UPDATE_MEDIA_SKIP_BY_OPTIONS",icon:r.createElement(mU,{action:"UPDATE_MEDIA_SKIP_BY_OPTIONS"}),recordingKey:n0.Pt(e,"update-media-skip-by-options"),disabled:!1})];T=T.concat(t)}return T.filter(Boolean)}var mz=n(983405),mH=n(773833),mW=n(736656),mY=n(533573),m$=n(712685),mX=n(843709);let mj="prototype_action_verbose_title--actionNameInsertion--aF4kI",mQ="prototype_action_verbose_title--actionName--qWJL3",mJ="prototype_action_verbose_title--actionNameUI3--JAYsG",mq=()=>{let e=(0,o.d4)(e=>e.mirror.sceneGraph);return r.useMemo(()=>new iD.cP(e),[e])};function mZ({action:e,isNestedInConditional:t,isNarrowPanel:n,onClick:a}){let o=(0,i$.YT)()===i$.Oz.TWO_COL,l=r.useContext(mW.c),s=o&&l===mW.P.LEFT,c=t||n,p=(0,nR.u)((0,aq.hS)(e.targetVariable)&&e.targetVariable&&"id"in e.targetVariable?e.targetVariable?.id:void 0),m=(0,aq.hS)(e.targetVariable)&&e.targetVariable&&"nodeFieldAlias"in e.targetVariable?(0,mH.aA)(e.targetVariable.nodeFieldAlias.stablePathToNode,e.targetVariable.nodeFieldAlias.indexOrKey):void 0,u=p?.name??m?.name,E=mq(),g=new iD.Z6((0,eu.GS)()),y=(0,iD._X)(e),_=(0,aq.E7)(y),h=r.createElement(rh.U,{svg:(0,iK.Yb)(_)},(0,iK.av)(_)),f=e=>{if(!e.connectionType||(0,aq.gl)(e.connectionType))return null;let t=eI()({[mQ]:!0,[mJ]:o}),n=eI()({"prototype_action_verbose_title--actionDestination--JZ-gU":!0,"prototype_action_verbose_title--actionDestinationUI3--ZGxbq":o});switch(e.connectionType){case"NONE":case"SET_VARIABLE_MODE":case"OBJECT_ANIMATION":return null;case"INTERNAL_NODE":case"BACK":case"CLOSE":case"UPDATE_MEDIA_RUNTIME":{let a=e.transitionNodeID;if((0,aq.gl)(a))return r.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));if(void 0===a)return null;let o=l6.dI(a),l=E.format(o);return r.createElement("div",{className:n},l)}case"URL":{let a=e.connectionURL;if(!a)return null;if((0,aq.gl)(a))return r.createElement("div",{className:t},(0,d.t)("proto.variant_actions.mixed"));return r.createElement("div",{className:n},a)}case"SET_VARIABLE":if(!e.targetVariableData||(0,aq.gl)(e.targetVariableData))return null;return r.createElement("div",{className:"prototype_action_verbose_title--setVariablePreviewContainer--6omxy"},r.createElement(mA.y3,{targetVariableData:e.targetVariableData,onClick:S.lQ,showVariableThumbnails:!1,isNarrowPanel:c,isInConditional:!0}));case"CONDITIONAL":{if((0,aq.gl)(e)||(0,aq.gl)(e.conditionalActions)||!e.conditionalActions)return null;let t=e.conditionalActions.length>0?e.conditionalActions[0].condition:void 0;return r.createElement(mA.y3,{targetVariableData:t,onClick:S.lQ,isInConditional:!0,showVariableThumbnails:!1})}default:(0,a2.xb)(e.connectionType)}},v=eI()({[mX.Li]:c&&!o,[mX.O8]:!c&&!o,[mX.kE]:o}),b=eI()({"prototype_action_verbose_title--iconContainer--jqarD":!0,"prototype_action_verbose_title--iconContainerUI3--yBP0-":o});return r.createElement("div",{className:v,onClick:a,role:"button",tabIndex:0},r.createElement(mz.Y1,{horizontalAlignItems:"space-between",width:"fill-parent"},r.createElement("div",{className:b},h),(e=>{let t=_?g.format(_):"Undefined",n=eI()({[mQ]:!0,[mJ]:o});if((0,aq.gl)(e.connectionType)&&(t=(0,d.t)("fullscreen.mixed")),!e.connectionType||(0,aq.gl)(e.connectionType)||"NONE"===e.connectionType||"BACK"===e.connectionType||"CLOSE"===e.connectionType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t));var a=f(e);switch(e.connectionType){case"INTERNAL_NODE":if("SWAP_STATE"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_change_to")),a);if(a){if("OVERLAY"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:mj},(0,d.tx)("proto.action_overlay_title",{overlayFrameName:r.createElement("span",null,a)})));if("SWAP"===e.navigationType)return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_swap_overlay_title")),a)}return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t),a);case"UPDATE_MEDIA_RUNTIME":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t),a);case"URL":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},a?(0,d.t)("proto.action_url_title"):(0,d.t)("proto.action_open_link")),a);case"SET_VARIABLE":{let l=e.targetVariableData&&(0,aq.hS)(e.targetVariableData)&&e.targetVariableData.resolvedType===i.rXF.COLOR,c=eI()({"prototype_action_verbose_title--actionNameInsertionColor--isir- prototype_action_verbose_title--actionNameInsertion--aF4kI":!0,"prototype_action_verbose_title--actionNameInsertionColorUI3--Apj0i":o});if(u&&a)return r.createElement(r.Fragment,null,r.createElement("div",{className:l?c:mj},(0,d.tx)("proto.action_set_variable_title",{variableName:r.createElement("span",{className:"prototype_action_verbose_title--variableNameContainer--XeJX2"},r.createElement(m$.wG,{text:u,isDeleted:!!p&&(0,mY.eF)(p),disableHover:s})),variableValue:r.createElement("span",{className:"prototype_action_verbose_title--variableDestinationContainer--RXbKo prototype_action_verbose_title--variableNameContainer--XeJX2"},a)})));return r.createElement(r.Fragment,null,r.createElement("div",{className:n},t))}case"SET_VARIABLE_MODE":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},(0,d.t)("proto.action_set_variable_mode")));case"CONDITIONAL":return r.createElement(r.Fragment,null,r.createElement("div",{className:n},o?(0,d.t)("proto.if"):(0,d.t)("proto.action_conditional_title")),a);case"OBJECT_ANIMATION":return r.createElement(r.Fragment,null);default:(0,a2.xb)(e.connectionType)}})(e)))}var m0=n(396353),m1=n(789529),m2=n.n(m1),m4=n(636149),m8=n.n(m4),m3=n(675551),m5=n.n(m3),m7=n(184058),m6=n.n(m7),m9=n(564092),ue=n(896850);let ut="prototype_set_variable_mode_controls--dropdownRow--vl5z4",un="missing",ua=lU.l6,ur=lU.c$,uo=lU.l6,ul=lU.c$,ui={},us=(0,d1.fv)();function uc(){let e=(0,nR.h6)()||ui,t=(0,m9.iR)(),n=r.useMemo(()=>{let n=m5()(t,(e,t)=>({collectionID:e.node_id,collectionName:e.name,key:e.key,modeOptions:e.modes?.map(t=>({modeId:{guid:t.id,collectionKey:e.key},name:t.name,isCompatible:!0}))||[],explicitMode:null,inheritMode:null,fileKey:us(e),libraryKey:e.library_key}));return m2()({},e,n)},[t,e]),a=r.useMemo(()=>Object.entries(n).map(([e,t])=>({setKey:e,modeData:t,isLocal:void 0===t.fileKey})),[n]),l=r.useMemo(()=>Object.values(a).filter(e=>e.modeData?.modeOptions&&e.modeData?.modeOptions.length>1),[a]),s=r.useMemo(()=>m6()(l.map(e=>e.modeData.fileKey??ue.BH)),[l]),c=(0,nR.el)(s),[p,m]=r.useMemo(()=>{let{_local:e,_unknownFile:t,...n}=m8()(l,e=>e.isLocal?"_local":e.modeData.fileKey&&void 0===c[e.modeData.fileKey]?"_unknownFile":e.modeData.fileKey),a=Object.entries(n).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>[{fileKey:e,fileName:c[e]},...t]).flat(1);return t&&(a.push({fileKey:ue.BH,fileName:(0,d.t)("variables.mode_properties_panel.used_variables.subheading")}),a.push(...t)),[e??[],a]},[c,l]),u=(0,m9.d2)(),E=r.useCallback(e=>{let t=u[(0,a3.yG)(e)],n=l.find(t=>t.setKey===e);if(n)return(e=>{if(e)return void 0===t&&(t=e.modeData.modeOptions[0].modeId.guid),e.modeData.modeOptions.find(e=>e.modeId.guid!==t&&(t=e.modeId.guid,!0))?.modeId.guid})(n)},[u,l]),g=l.length>0?l[0]:void 0,y=g?.setKey,_=g?.modeData.collectionID,h=r.useMemo(()=>y&&E(y),[y,E]),f=(0,o.wA)();return{localVariableSets:p,allVariableSets:l,firstVariableSet:g,firstVariableSetID:_,firstVariableSetMode:h,getDefaultNewModeForVariableCollectionKey:E,reportAnalyticsEventWhenSelected:e=>{let t=i.mSn.getVariableSetInfoForSetModeAnalytics(e);f((0,l9.Zh)({name:"prototype.set_mode_select_variable_set",params:{...t}}))},subscribedVariableSetsWithSections:m}}function ud({targetVariableSetID:e,targetVariableModeID:t,deprecatedTargetVariableSetKey:n,updateSelectionProperties:a,recordingKey:o,actionIndexPath:l}){let{getDefaultNewModeForVariableCollectionKey:i,allVariableSets:s,reportAnalyticsEventWhenSelected:c}=uc(),{shouldShowAdvancedPrototypingPaywall:p,showAdvancedPrototypingVariablesModal:m}=(0,i$.zt)(),u=(0,eu.GS)();r.useEffect(()=>{if(!n||(0,aq.gl)(n))return;let e=s.find(e=>e.setKey===n);e?((0,tR.Lo)("SetVariableModeControls","updating variable set key to non-deprecated id value"),a({targetVariableSetKey:void 0,targetVariableSetID:e?.modeData.collectionID})):((0,tR.Lo)("SetVariableModeControls","attempted to update variable set key to non-deprecated id value, but could not find it in the list of variable sets, will just clear out the bad data."),a({targetVariableSetKey:void 0}))},[n,s,a]);let[E,g]=r.useMemo(()=>{let t=(0,aq.gl)(e)||void 0===e?e:function(e,t){let n=e.find(e=>e.modeData.collectionID===t);if(n)return n;let a=m0.gr.toRefIfSubscribed(t);if(a)return e.find(e=>e.setKey===a.key)}(s,e)||un,n=(()=>{if(!(0,aq.gl)(t)&&void 0!==t&&t!==un)return t})();return[t,n]},[e,s]),y=r.createElement(uu,{selectedVariableSet:E,onChange:e=>{p?m():(c(e.modeData.collectionID),a({targetVariableSetID:e.modeData.collectionID,targetVariableModeID:i(e.setKey)}))},actionIndexPath:l}),_=u?r.createElement(lB.cS,{input:y,label:(0,d.tx)("proto.set_variable_mode.collection_label")}):r.createElement(rm.fI,{recordingKey:n0.Pt(o,"selectTargetVariableSet")},y),h=r.createElement(uy,{selectedVariableSetKey:g&&g.setKey,selectedVariableModeID:t,onChange:e=>{p?m():a({targetVariableModeID:e})},actionIndexPath:l}),f=u?r.createElement(lB.cS,{input:h,label:(0,d.tx)("proto.set_variable_mode.mode_label")}):r.createElement(rm.fI,{recordingKey:n0.Pt(o,"selectTargetVariableMode")},h);return r.createElement("div",{className:u?void 0:T.cx.relative.$},_,g&&f)}let up={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===un?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_collection"):e.modeData.collectionName,isEqual:(e,t)=>void 0!==e&&void 0!==t&&e!==un&&t!==un&&(e.setKey===t.setKey||e.modeData.collectionID===t.modeData.collectionID)};function um(e,t){return"fileKey"in e?[t&&r.createElement(lU.sK,{key:e.fileKey+"divider"}),r.createElement(ur,{isHeader:!0,key:e.fileKey+"header",formattedValue:e.fileName})]:r.createElement(ur,{key:e.setKey,value:e})}function uu({selectedVariableSet:e,onChange:t,actionIndexPath:n}){let a=(0,o.wA)(),l=(0,rH.Um)(),i="set-variable-mode--select-variable-set-"+n,{localVariableSets:c,allVariableSets:p,subscribedVariableSetsWithSections:m}=uc();return r.createElement(ua,{id:i,className:ut,property:e,formatter:up,dispatch:a,dropdownShown:l?.type===i?l:null,onChange:e=>{(0,aq.gl)(e)||void 0===e||e===un||t(e)}},p.length>0?[c.length>0&&r.createElement(ur,{key:n0.Pt(i,"local_variables"),isHeader:!0,formattedValue:(0,s.kc)().ds_variable_props_unified_ui?(0,d.t)("variables.mode_properties_panel.assets_created_in_file.subheading"):(0,d.t)("variables.mode_properties_panel.local_variables.subheading")}),...c.map(e=>um(e,!1)),...m.map((e,t)=>um(e,c.length>0||t>0))]:[])}let uE={format:e=>void 0===e?(0,d.t)("proto.prototype_panel.edit_set_mode.none"):e===un?(0,d.t)("proto.prototype_panel.edit_set_mode.missing_mode"):e?.name??""};function ug(e){return r.createElement(ul,{key:e.modeId.guid,value:e})}function uy({selectedVariableSetKey:e,selectedVariableModeID:t,onChange:n,actionIndexPath:a}){let l=(0,o.wA)(),i=(0,rH.Um)(),s="set-variable-mode--select-variable-mode-"+a,{allVariableSets:c}=uc(),d=r.useMemo(()=>c.find(t=>t.setKey===e)?.modeData.modeOptions,[e,c]),p=r.useMemo(()=>(0,aq.gl)(t)||void 0===t?t:d?.find(e=>e.modeId.guid===t)||un,[t,d]);return r.createElement(uo,{id:s,className:ut,property:p,formatter:uE,dispatch:l,dropdownShown:i?.type===s?i:null,onChange:e=>{!e||(0,aq.gl)(e)||e===un||n(e.modeId.guid)}},d&&d?.map(ug))}var u_=n(910392),uh=n(909666),uf=n(442458);let uv=n6.TI;function ub({children:e}){return(0,eu.GS)()?r.createElement(lB.TN,null,e):r.createElement(rm.fI,{className:"overlay_panel--fplCheckboxRow--EYTAZ checkbox--_checkboxRow--oEhow"},e)}function uS({interactionType:e,recordingKey:t,actionIndexPath:n,nodeId:a}){let[l,s]=r.useState(!1),[c,p]=r.useState(new tf.Mi),m=(0,o.wA)(),u=(0,eu.GS)(),E="{ "+n.join(", ")+" }",{destinationOverlayBackgroundColor:g,destinationOverlayBackgroundType:y,destinationOverlayPositionType:_,destinationOverlayBackgroundInteraction:h}=(0,sD.R)(e=>({destinationOverlayBackgroundColor:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundColor,destinationOverlayBackgroundType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundType,destinationOverlayPositionType:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayPositionType,destinationOverlayBackgroundInteraction:e.mirror.selectionProperties.actionIndexPathToOverlaySettings?.[E]?.destinationOverlayBackgroundInteraction})),f=r.useRef(null),v=r.useRef(null),b=r.useCallback(()=>{s(!1)},[s]),S=r.useCallback(()=>{if(l)b();else{s(!0);let e=u?v.current:f.current;p((0,lF.cn)(e))}},[l,b,u]),T=r.useCallback(e=>{let t=e?"SOLID_COLOR":"NONE";a5.l7.user("overlay-background-type-edit-scope",()=>{i.X3B.setOverlayBackgroundType(l6.dI(a),t)}),m((0,l9._P)({name:"Overlay background visible changed",params:{backgroundType:t}}))},[m,a]),N=r.useCallback(e=>{let t=e?"CLOSE_ON_CLICK_OUTSIDE":"NONE";a5.l7.user("overlay-background-interaction-edit-scope",()=>{i.X3B.setOverlayBackgroundInteraction(l6.dI(a),t)}),m((0,l9._P)({name:"Overlay background interaction changed",params:{backgroundInteraction:t}}))},[m,a]),I=r.useCallback(()=>(0,aq._W)(g,{r:0,g:0,b:0,a:.25}),[g]),P=r.useCallback((e,t)=>{t!==iU.zk.NO&&a5.l7.user("overlay-background-color-edit-scope",()=>{i.X3B.setOverlayBackgroundColor(l6.dI(a),e)})},[a]),C=r.useCallback((e,t)=>{P(e,iU.zk.YES)},[P]),k=r.useCallback((e,t)=>{let n=I();P({r:n.r,g:n.g,b:n.b,a:e},t)},[I,P]),A=r.useCallback(e=>{a5.l7.user("overlay-position-type-edit-scope",()=>{i.X3B.setOverlayPositionType(l6.dI(a),e)}),m((0,l9._P)({name:"Overlay position changed",params:{position:e}}))},[m,a]),w=I(),O=I().a,x=(0,aq.E7)(_),R="CLOSE_ON_CLICK_OUTSIDE"===(0,aq.E7)(h),M="SOLID_COLOR"===(0,aq.E7)(y),L=r.createElement("div",{className:"overlay_panel--colorValueContainer--gJtb9 paint_panels--colorValueContainer--DGeSP raw_components--borderFocusWithin--BaipZ paint_panels--_baseColorValueContainer--t-UIV raw_components--base--T7G0z raw_components--singleRowHeight--dKM4t"},r.createElement(n4.J,{onClick:M?S:()=>{},color:w,opacity:O,recordingKey:n0.Pt(t,"chit"),className:"overlay_panel--chit--Zn66r paint_panels--chit--twQEy"}),r.createElement(ia.AN,{className:u?"overlay_panel--colorInputUI3--ozOrK paint_panels--colorInput--nSz13":"overlay_panel--colorInput--6yyym paint_panels--colorInput--nSz13",noLeftBorder:!0,formatter:uv,property:w,disabled:!M,onChange:C,recordingKey:n0.Pt(t,"colorInput"),noBorderOnFocus:!0}),r.createElement(lt.Pd,{className:"overlay_panel--opacity--vrrjV paint_panels--opacityInputContainer--oqlsk",value:O,onValueChange:k,dispatch:m,disabled:!M,noBorderOnFocus:!0,recordingKey:n0.Pt(t,"opacity")}));return r.createElement(rm.Zk,{className:u?"overlay_panel--overlayPanelUI3--GLqgD":"overlay_panel--overlayPanel--l-Hts"},!u&&r.createElement(rm.fI,null,r.createElement(rm.xw,{faded:!0,className:"overlay_panel--overlayPanelTitle--e9pjs"},(0,d.tx)("proto.overlay_settings"))),r.createElement(uA,{overlayPositionType:x,onOverlayPositionTypeChange:A,recordingKey:t}),!("ON_HOVER"===e||"ON_PRESS"===e)&&r.createElement(ub,null,r.createElement(lL.S,{label:r.createElement(lD.J,null,(0,d.tx)("proto.close_when_clicking_outside")),recordingKey:n0.Pt(t,"closeOnClickOutside"),onChange:N,checked:R})),r.createElement(ub,null,r.createElement(lL.S,{label:r.createElement(lD.J,null,u?(0,d.tx)("proto.overlay_panel.background"):(0,d.tx)("proto.add_background")),recordingKey:n0.Pt(t,"addBackgroundBehindOverlay"),onChange:T,checked:M})),M&&(u?r.createElement(lB.cS,{ref:v,label:(0,d.tx)("proto.overlay_panel.background"),input:L}):r.createElement(rm.fI,{ref:f}," ",L," ")),l&&r.createElement(lV.h3,{disabledVariableIds:new Set,initialPosition:c,color:w,boundVariable:null,onChange:P,onClose:b,recordingKey:n0.Pt(t,"colorPicker")}))}let uT=lU.l6,uN=lU.c$;class uI extends r.PureComponent{constructor(){super(...arguments),this.titleFormatter=new iD.Cr,this.renderOverlayPositionOption=(e,t)=>r.createElement(uN,{key:t,value:e,recordingKey:n0.Pt(this.props,e)})}render(){let e=["CENTER","TOP_LEFT","TOP_CENTER","TOP_RIGHT","BOTTOM_LEFT","BOTTOM_CENTER","BOTTOM_RIGHT"].map(this.renderOverlayPositionOption);return r.createElement(uT,{id:this.props.recordingKey??"overlay-position_select",className:this.props.className,chevronClassName:"overlay_panel--chevron--7RTA-",inputClassName:"overlay_panel--input--tGHHB",dropdownWidth:rS.DxS,property:this.props.property,formatter:this.titleFormatter,onChange:this.props.onChange,dispatch:this.props.dispatch,dropdownShown:this.props.dropdownShown,recordingKey:n0.Pt(this.props,"select")},e,r.createElement(lU.sK,null),this.renderOverlayPositionOption("MANUAL",10))}}uI.displayName="OverlayPositionDropdown";class uP extends ip.I{}class uC extends ip.Y{}class uk extends r.PureComponent{render(){return r.createElement(uP,{className:this.props.className,property:this.props.property,onChange:this.props.onChange,recordingKey:this.props.recordingKey},r.createElement(uC,{value:"CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_center"),svg:uh.A,recordingKey:n0.Pt(this.props,"center")}),r.createElement(uC,{value:"TOP_LEFT",tooltip:(0,d.t)("proto.tooltip_overlay_position_top_left"),svg:uf.A,recordingKey:n0.Pt(this.props,"top-left")}),r.createElement(uC,{value:"BOTTOM_CENTER",tooltip:(0,d.t)("proto.tooltip_overlay_position_bottom_center"),svg:u_.A,recordingKey:n0.Pt(this.props,"bottom-center")}))}}function uA({overlayPositionType:e,onOverlayPositionTypeChange:t,recordingKey:n}){let a=(0,eu.GS)(),l=(0,o.wA)(),i=(0,rH.Um)(),s=r.createElement(uI,{className:"overlay_panel--overlayPositionDropdown--ZxxSI",property:e,dispatch:l,dropdownShown:i,onChange:t,recordingKey:n0.Pt(n,"overlayPositionDropdown")}),c=r.createElement(uk,{property:e,onChange:t,recordingKey:n0.Pt(n,"overlayPositionControl"),className:"overlay_panel--overlayPositionControl--SWngJ"});return a?r.createElement(lB.cS,{label:(0,d.tx)("proto.overlay_panel.position"),input:s}):r.createElement(rm.fI,null,s,c)}var uw=n(171447),uO=n(301036),ux=n(964389),uR=n(112976),uM=n(728587);let uL=e=>`interaction-panel-create-action-${e}`;function uD(e){let t=uL(e.recordingKey);var{showing:n,toggle:a,hide:l}=(0,rH.BK)(t);let i=(0,r.useRef)(null),{recordingKey:s,addButtonPressed:c,presetInteractions:p}=e,{shouldShowAdvancedPrototypingPaywall:m,showAdvancedPrototypinglMultipleActionsModal:u}=(0,i$.zt)(),E=(0,r.useCallback)(()=>{!e.skipPaywall&&m?u():a()},[e.skipPaywall,m,u,a]),g=(0,i$.YT)()===i$.Oz.TWO_COL,y=(0,i$.hP)(),_=(0,eu.GS)(),h=(0,l7.cJ)(),f=(0,i$.He)({showVideoActions:y,isNestedInConditional:e.isNestedInConditional,isSites:h,isUI3:_,showPresetActions:!!e.presetInteractions}),v=(0,o.wA)(),b=(0,r.useCallback)(e=>{c((0,i$.Bs)(e)),l()},[c,l]),S=eI()({[mX.x1]:e.renderButton,[mX.xm]:!e.renderButton&&!g,[mX.U3]:!e.renderButton&&g}),T=[];f.forEach(e=>{(0,i$.vc)(e)?T.push(uR.w):e===i$.Xk&&p?.length?T.push(...p,uR.w):T.push(function({actionType:e,clickCb:t,recordingKey:n,isUI3:a}){let o=(0,iK.Yb)(e),l=(0,iK.av)(e),i=new iD.Z6(a),s=e?i.format(e):"Undefined";return{className:mX.BP,callback:()=>t(e),icon:r.createElement(rh.U,{className:mX.QE,svg:o},l),displayText:s,recordingKey:n0.Pt(n,"createActionOption",e)}}({clickCb:b,recordingKey:s,actionType:e,isUI3:_}))});let N=e.isNestedInConditional?(0,d.t)("proto.prototype_panel.add_nested_action"):(0,d.t)("proto.prototype_panel.add");return r.createElement(r.Fragment,null,r.createElement(ux.e6,{ref:i,recordingKey:n0.Pt(s,"createActionDropdown"),className:S,onClick:E,"aria-label":(0,d.t)("proto.prototype_panel.create_action_button"),htmlAttributes:{"data-tooltip":N,"data-tooltip-type":"text"}},e.renderButton?r.createElement(rh.U,{svg:rw.A},r.createElement(rZ.e,null)):(0,d.tx)("fullscreen.properties_panel.click_plus_to_add_new_action")),n&&i.current&&r.createElement(uM.j,{minWidth:130,lean:"center",parentRect:i.current.getBoundingClientRect(),hidePointWhenContentOffScreen:!0,showPoint:!0,items:T,dispatch:v,onSelectItem:e=>e.callback?.(),recordingKey:"actionDropdown"}))}let uK="prototype_conditional_controls--conditionalRowUI3--rQlu6",uF="prototype_conditional_controls--conditionIcon--Npk57";var uV=n(381809),uU=n(527967),uB=n(5068);function uG({onDeleteAction:e,updateMultipleDestinationNodes:t,updateSelectionProperties:n,updateCondition:a,updateActions:o,onAddAction:l,autoOpenVariablePicker:s,isSelected:c,handleMouseDownUI3:p,...m}){let u=m.conditionalActions,E=u?.actions?u?.actions:[],g=u?.condition?u?.condition:void 0,y=(0,i$.YT)()===i$.Oz.TWO_COL,_=y?uK:"prototype_conditional_controls--conditionalRowIf--25FqB prototype_conditional_controls--conditionalRow--u0PaS",h=r.createElement(mA.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:g,updateSelectionProperties:n,recordingKey:m.recordingKey,updateConditionInConditionalAction:a,showVariableThumbnails:!0,isNarrowPanel:!0}),f=r.createElement("div",{className:"prototype_conditional_controls--addButton--vlYLn"},r.createElement(uD,{addButtonPressed:l,recordingKey:n0.Pt(m.recordingKey,"addActionToIfButton"),renderButton:!0,isNestedInConditional:!0})),v=r.createElement(r.Fragment,null,y?r.createElement("span",{className:"prototype_conditional_controls--conditionIconUI3--zcwx0"},(0,d.tx)("proto.else")):r.createElement(nC.B,{className:uF,svg:uV.A}),!y&&E.length>0&&r.createElement("div",{className:"prototype_conditional_controls--addButtonForElse--ogBWu prototype_conditional_controls--addButton--vlYLn"},r.createElement(uD,{addButtonPressed:l,recordingKey:n0.Pt(m.recordingKey,"addActionToElseButton"),renderButton:!y,isNestedInConditional:!0}))),b=y?r.createElement(nn.E,{className:"prototype_conditional_controls--elseBlockRowUI3--VXjmO",onClick:p},v):r.createElement(rm.fI,{className:y?uK:"prototype_conditional_controls--conditionalRow--u0PaS"},v);return r.createElement(r.Fragment,null,m.ifStatement&&r.createElement("div",{className:_},!y&&r.createElement(d8.Y,{direction:"horizontal",spacing:4},r.createElement("span",{className:y?"prototype_conditional_controls--conditionalRowConditionUI3--M2mOx":"prototype_conditional_controls--conditionalRowCondition--kn-f7"},r.createElement(d8.Y,{direction:"horizontal",spacing:0},r.createElement(nC.B,{className:uF,svg:uU.A}),r.createElement(d8.Y,{direction:"horizontal",spacing:0},(0,aq.hS)(g)&&h),r.createElement(nC.B,{className:"prototype_conditional_controls--icon--JV1i0",svg:uB.default}))),!y&&E.length>0&&f)),!m.ifStatement&&b,E&&E.map((a,o)=>r.createElement(EP,{key:o,updateMultipleDestinationNodes:t.appendActionIndex(o),action:a,recordingKey:n0.Pt(m.recordingKey,"conditional-action-row",o),updateSelectionProperties:n.appendActionIndex(o),onDeleteAction:()=>e(o),interactionType:m.interactionType,actionIndexPath:[m.actionIndexPath[0],m.actionIndexPath[1],o],numActions:E.length,isNestedInConditional:!0,stateManagementVersion:m.stateManagementVersion,selectedInteractions:m.selectedInteractions,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onAddAction:l,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:s})),0===E.length&&r.createElement(EP,{key:0,updateMultipleDestinationNodes:t.appendActionIndex(0),action:m.emptyAction,recordingKey:n0.Pt(m.recordingKey,"conditional-action-row",0),updateSelectionProperties:n.appendActionIndex(0),onDeleteAction:()=>e(0),interactionType:m.interactionType,actionIndexPath:[m.actionIndexPath[0],m.actionIndexPath[1],0],numActions:E.length,isNestedInConditional:!0,stateManagementVersion:m.stateManagementVersion,selectedInteractions:m.selectedInteractions,onDrop:m.onDrop,onSelect:m.onSelect,onExpand:m.onExpand,onAddAction:l,selectedActionIndex:m.selectedActionIndex,expandedRows:m.expandedRows,autoOpenVariablePicker:s}))}function uz(e,t,n){return function(a){var r=[...t];r.length>e?r[e].condition=a:r.push({condition:0===e?a:void 0,actions:[]},{condition:1===e?a:void 0,actions:[]}),n({conditionalActions:r})}}function uH({onDrop:e,onSelect:t,onExpand:n,action:a,updateMultipleDestinationNodes:l,updateSelectionProperties:i,interactionType:s,recordingKey:c,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:u,selectedActionIndex:E,expandedRows:g,autoOpenVariablePicker:y,onNewActionAdded:_,handleMouseDownUI3:h}){let f=(0,o.wA)(),v=(0,V.p8)("currentPage"),b=(0,i$.YT)()===i$.Oz.TWO_COL,S=b?E.equals(u):void 0,{shouldShowAdvancedPrototypingPaywall:T,showAdvancedPrototypingConditionalActionsModal:N}=(0,i$.zt)(),I=(0,aq.hS)(a.conditionalActions)&&a.conditionalActions?a.conditionalActions:[],P=e=>function(t){var n=[...I];n.length>e?n[e].actions=[...t]:n.push({actions:t}),i({conditionalActions:n})},C=e=>function(t){var n=[...I],a=0;if(n.length>e){var r=n[e].actions;r?r.push(t):r=[t],a=r.length}else n.push({actions:0===e?[t]:[]},{actions:1===e?[t]:[]}),a=1;"SET_VARIABLE"===t.connectionType&&(y.current=!0),i({conditionalActions:n}),_&&_(new uO.Op([u[0],e,a-1])),f((0,l9._P)({name:"Prototype add action",params:{action:t.connectionType?t.connectionType:"NONE",source:"panel",page_id:v,actionInConditionalAction:!0}}))},k=e=>function(t){if(T)N();else{var n=[...I];let a=I[e],r=[];if(a&&a.actions)for(let e=0;e<a.actions.length;e++){let n=a.actions[e];e!==t?r.push(n):f((0,l9._P)({name:"Prototype delete action",params:{action:n.connectionType?n.connectionType:"NONE",source:"panel",page_id:v,actionInConditionalAction:!0}}))}n[e].actions=r,i({conditionalActions:n})}},A=I.length>0?I[0]:void 0,w=I.length>1?I[1]:void 0;return r.createElement("div",{style:b?{position:"relative"}:void 0},(0,aq.gl)(a.conditionalActions)&&r.createElement(mz.Y1,null,r.createElement(nn.E,{className:"prototype_conditional_controls--mixedConditionalText--6O32b",onClick:()=>{var e=[];e.push({},{}),i({conditionalActions:e})}},(0,d.t)("fullscreen.properties_panel.click_to_replace_mixed_content"))),(0,aq.hS)(a.conditionalActions)&&r.createElement(r.Fragment,null,r.createElement(uG,{key:0,conditionalActions:A,recordingKey:n0.Pt(c,"conditional-block",0),updateCondition:uz(0,I,i),updateActions:P(0),onAddAction:C(0),updateMultipleDestinationNodes:l.appendActionIndex(0),onDeleteAction:k(0),interactionType:s,updateSelectionProperties:i.appendActionIndex(0),ifStatement:!0,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:[u[0],0],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:E,autoOpenVariablePicker:y,expandedRows:g,emptyAction:{ifStatement:!0,action:a},isSelected:S,handleMouseDownUI3:h}),r.createElement(uG,{key:1,conditionalActions:w,recordingKey:n0.Pt(c,"conditional-block",1),updateCondition:uz(1,I,i),updateActions:P(1),onAddAction:C(1),updateMultipleDestinationNodes:l.appendActionIndex(1),onDeleteAction:k(1),interactionType:s,updateSelectionProperties:i.appendActionIndex(1),ifStatement:!1,stateManagementVersion:p,selectedInteractions:m,actionIndexPath:[u[0],1],onDrop:e,onSelect:t,onExpand:n,selectedActionIndex:E,autoOpenVariablePicker:y,expandedRows:g,emptyAction:{ifStatement:!1,action:a},isSelected:S,handleMouseDownUI3:h})))}function uW({updateSelectionProperties:e,conditionalActions:t,autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,...o}){let l=t.length>0?t[0]:void 0,s=l?.condition?l?.condition:void 0,c=eI()({"prototype_conditional_controls--standaloneIfConditional--GLFDU":!0,"prototype_conditional_controls--placeholderText--esG0u":!s});return r.createElement(r.Fragment,null,r.createElement(lB.cS,{input:null,label:(0,d.tx)("proto.condition")}),r.createElement(ow.Ad,{appendedClassName:"prototype_conditional_controls--conditionalActionRightPadding--xpK6Z",label:null,input:(0,aq.hS)(s)?r.createElement("div",{className:c},r.createElement(mA.KN,{resolvedType:i.rXF.BOOLEAN,targetVariableData:s,updateSelectionProperties:e.appendActionIndex(0),recordingKey:o.recordingKey,updateConditionInConditionalAction:uz(0,t,e),autoOpenExpressionBuilder:n,setAutoOpenExpressionBuilder:a,showVariableThumbnails:!0,isNarrowPanel:!0})):null}))}var uY=n(510879),u$=n(830002),uX=n(731262);let uj=lU.c$,uQ=lU.l6;function uJ(e){let t=r.useMemo(()=>new iD.cP(e.scene),[e.scene]),[n,a]=r.useState([]),[o,l]=r.useState([]),s=(0,l7.cJ)(),c=e.nodeId===aq.oV?aq.oV:l6.dI(e.nodeId),d=n;(0,aq.hS)(c)&&c!==l6.AD&&-1===d.indexOf(c)&&(d=d.concat([c]));let p=`prototype-destination-select-${e.recordingKey}`,m="SCROLL_TO"!==e.action?d.filter(e=>t.hasNameForNode(e)).map((t,n)=>r.createElement(uj,{key:`enabled-${t}`,value:t,recordingKey:n0.Pt(e,`viable-option-${n}`),disabled:!1})):((n,a)=>{let o=m8()(n.filter(e=>t.hasNameForNode(e)),t=>t===a&&(0,aq.hS)(a)?tH.Ql(e.scene,t)?.guid:e.scene.get(t)?.parentGuid),l=Object.keys(o);(0,tH.X4)(l,t.format.bind(t));let{tlfId:i,index:s}=(0,tH.H_)(e.scene,l);return i&&s&&(l.splice(s,1),l=[i,...l]),l.reduce((t,n,a)=>(0!==a&&t.push(r.createElement(lU.sK,{key:a})),t.push(r.createElement(uj,{key:`disabled-${n}`,value:n+" ",recordingKey:n0.Pt(e,`disabled-option-${n}`),disabled:!0})),o[n].forEach((n,a)=>{t.push(r.createElement(uj,{key:`enabled-${n+a}`,value:n,recordingKey:n0.Pt(e,`viable-option-${a}`),disabled:!1}))}),t),[])})(d,c),u=o.filter(e=>t.hasNameForNode(e)).map((t,n)=>r.createElement(uj,{key:`disabled-${t}`,value:t,recordingKey:n0.Pt(e,`disabled-option-${n}`),disabled:!0})),E=e.isUI3?r.Fragment:rm.fI;return r.createElement(E,null,r.createElement(uQ,{id:p,dataTestId:"destination-select",className:e.className,chevronClassName:"prototype_destination_dropdown--chevron--pmWtI",inputClassName:"prototype_destination_dropdown--input--rzglN",dropdownWidth:rS.DxS,property:c,formatter:t,onChange:e.onChange,dispatch:e.dispatch,dropdownShown:e.dropdownShown,recordingKey:n0.Pt(e,"select"),willShowDropdown:()=>{let t=i.baT.ALL;"SCROLL_TO"===e.action?t=i.baT.SCROLL_TO:"SWAP_STATE_TO"===e.action?t=i.baT.STATES:"NAVIGATE_TO"===e.action&&s&&(t=i.baT.RESPONSIVE_SETS);let{viableIds:n,disabledIds:r}=i.X3B.getTransitionDestinationsOnActiveCanvas(t);return a(n),l(r),Promise.resolve()},onOptionFocus:e=>{ee.Uc(e??"")},hideDropdownWhenContainerMoves:!(0,ak.nl)()},m||null,0!==o.length&&0!==d.length&&r.createElement(lU.sK,null),u))}let uq=r.memo(function(e){let t=(0,U.tS)(),n=(0,U._G)(),a=(0,o.d4)(uZ),l=(0,o.d4)(iV.qd),s=(0,o.d4)(iV.dK),c=(0,uY.D)(l,s),d=(0,o.d4)(u0),p=r.useMemo(()=>(0,uX.cP)(d,t,n,e.actionIndexPath),[d,t,n,e.actionIndexPath]),m=r.useMemo(()=>(0,uX.cP)(a,t,n),[a,t,n]),u=p||m;if(!u||u.mode!==i.iCO.STATE_OR_STATE_INSTANCE_SUBLAYER)return null;let{allStates:E,stateGroupModel:g,selectedStates:y,selectedStatesPropertyValues:_}=u,h=g.propertySortOrder||[],f=g.propertyValues;return f?r.createElement(u$.lS,{sortedProperties:h,stateGroupPropertyValues:f,selectedStatesPropertyValues:_,selectedStates:y,allStates:E,onSelectProperty:t=>{let n={};for(let e of Object.keys(t)){let a=t[e].symbol.node_id;for(let t of(n[e]=a,c[e]||[]))n[t]=a;for(let e of l)n[e]||(n[e]=a)}e.onChange(n)},recordingKey:e.recordingKey,hideErrorsPanel:!0,shouldIndent:!0,extended:!0}):null});function uZ(e){return e.mirror.selectionProperties.stateGroupSelectionInfo}function u0(e){return e.mirror.selectionProperties.prototypeDestinationStateGroupSelectionInfo}var u1=n(169231),u2=n(511787),u4=n(74416),u8=n(939143),u3=n(720531);let u5="prototype_set_variable_controls--dropdownAndIconContainer--6m3Tw",u7="prototype_set_variable_controls--icon---HzDt",u6="prototype_set_variable_controls--placeholderText--PBIqf";function u9({targetVariableData:e,targetVariable:t,updateSelectionProperties:n,autoOpenVariablePicker:a,...l}){let c=r.useRef(null),p=(0,o.wA)(),m=(0,eu.GS)(),u=(0,o.d4)(e=>e.variablePickerShown),E=(0,nR.tZ)((0,aq.hS)(t)&&"id"in t?t.id:void 0),g=(0,nR.u)((0,aq.hS)(t)&&"id"in t?t.id:void 0),[y,_]=r.useState("");(0,eC.h)(()=>{a&&!0===a.current&&(f(),a.current=!1)});let h=(0,nR.BQ)((0,aq.hS)(t)&&"id"in t?t.id:void 0)??(0,mH.m9)((0,aq.hS)(t)&&"nodeFieldAlias"in t?t.nodeFieldAlias:void 0);r.useEffect(()=>{void 0!==e&&h&&"MIXED"!==h&&(0,aq.hS)(e)&&e.resolvedType!==h.resolvedType&&!((0,mH.tz)(e.resolvedType)&&(0,mH.tz)(h.resolvedType))&&n({targetVariableData:void 0})},[h,n,e]);let f=()=>{let e=c.current.getBoundingClientRect();p((0,u1.C)({type:"variable-picker-set-variable-action",isShown:!0,resolvedType:i.rXF.STRING,initialPosition:new tf.Mi(e.left-20,e.top),key:l.recordingKey,onVariableSelected:N}))},v=r.useCallback(()=>{p((0,u1.B)())},[p]),[b,S]=r.useState(!1),N=r.useCallback(t=>{if(void 0!==t&&t.node_id){let a={targetVariable:{id:t.node_id}},r=i.CWU.getVariableResolvedValue(t.node_id,new Map);!e&&t.resolvedType===i.rXF.COLOR&&r&&(a.targetVariableData=r??void 0),n(a),p((0,l9.Zh)({name:"prototype.variable_selected",params:{collectionId:t.variableSetId,variableId:t.node_id,variableType:t.resolvedType}})),S(!0)}},[p,e,n]),I=r.useCallback(e=>{e.value.stablePath.map(e=>l6.sH(e))&&(n({targetVariable:{nodeFieldAlias:{stablePathToNode:e.value.stablePath,nodeField:"COMPONENT_PROP_ASSIGNMENTS",indexOrKey:e.value.explicitDefId}}}),S(!0))},[n]),P=r.useMemo(()=>({type:"LOCAL_VARIABLES",layout:"list"}),[]),C=r.useRef(null);r.useEffect(()=>{let e=i.Ez5.prototypingEditorState().colorPickerEyedropperVarData;return(0,eo.lu)(e,{onChangeImmediate(){let t=e.getCopy();t&&n({targetVariableData:t})}})},[n]);let k="nodeFieldAlias"in t?(0,mH.aA)(t.nodeFieldAlias.stablePathToNode,t.nodeFieldAlias.indexOrKey):void 0,A=k?(0,mH.Xx)(k.varValue.resolvedType):null,w=null;if((0,aq.gl)(t))w=null;else if(h?.resolvedType===i.rXF.COLOR)w=(0,aq.gl)(e)?r.createElement("div",{className:"prototype_set_variable_controls--targetVariableDataMixedContainer--H6uGu"},(0,d.t)("fullscreen.mixed")):r.createElement(r.Fragment,null,r.createElement(u3.gJ,{variableValue:e??h,onChange:e=>{n({targetVariableData:e})},recordingKey:n0.Pt(l.recordingKey,"variableValueInput"),setVariableAction:!0,innerContainerClassName:"prototype_set_variable_controls--variableColorInputContainer--NaOmp"}));else{let t=l.isNestedInConditional?"prototype_set_variable_controls--absoluteIconInConditional--BbEmW":"prototype_set_variable_controls--absoluteIcon--1XpBF",a=i.rXF.BOOLEAN;g?a=g.resolvedType:k&&(a=k.varValue.resolvedType===i.rXF.TEXT_DATA?i.rXF.STRING:k.varValue.resolvedType),w=r.createElement("div",{className:m?void 0:T.cx.ml12.$},r.createElement("div",{className:u5},r.createElement(mA.KN,{resolvedType:a,targetVariableData:e,autoOpenExpressionBuilder:b,setAutoOpenExpressionBuilder:S,updateSelectionProperties:n,recordingKey:l.recordingKey,isNarrowPanel:l.isNarrowPanel,showVariableThumbnails:!0}),!m&&r.createElement(nC.B,{className:eI()(u7,t),svg:uB.default})))}let O=eI()({"prototype_set_variable_controls--targetVariableDropdown--IZwoF":!m&&!l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownNarrow--WWi-t prototype_set_variable_controls--targetVariableDropdown--IZwoF":!m&&l.isNarrowPanel,"prototype_set_variable_controls--targetVariableDropdownUI3--Pz71q":m,[u6]:m&&!(E||k)}),x=(0,o.d4)(iG.ZM),R=(0,s.kc)().ds_variable_props_unified_ui&&x?(0,d.t)("proto.select_variable_unified"):m?(0,d.t)("proto.select_variable.short"):(0,d.t)("proto.select_variable"),M=r.createElement(nr.D8,{recordingKey:n0.Pt(l.recordingKey,"selectTargetVariable"),onClick:f},r.createElement("div",{className:m?void 0:(0,aq.hS)(t)?"prototype_set_variable_controls--targetVariableLabel--AFCqK":"prototype_set_variable_controls--targetVariableLabelInactive--zHWCC prototype_set_variable_controls--targetVariableLabel--AFCqK",ref:c},r.createElement(d8.Y,null,r.createElement("div",{className:O},r.createElement("div",{className:u5},(0,aq.gl)(t)?r.createElement("div",{className:eI()(T.cx.pt2.$,T.cx.pb2.$)},(0,d.t)("fullscreen.mixed")):E?r.createElement(m$.wG,{text:E,thumbnailValue:h,isDeleted:!!g&&(0,mY.eF)(g)}):k?r.createElement(m$.wG,{text:k.name,thumbnailValue:A,isDeleted:!1,colorTheme:m$.J2.COMPONENT}):r.createElement("div",{className:eI()(T.cx.pt2.$,T.cx.pb2.$,m?"prototype_set_variable_controls--placeholderTextColorUI3--Pc-4N":void 0)},R),!m&&r.createElement(nC.B,{className:u7,svg:uB.default})))))),L=m?r.createElement(lB.cS,{input:M,label:(0,s.kc)().ds_variable_props_unified_ui?(0,d.tx)("proto.target"):(0,d.tx)("proto.variable")}):M,D=eI()({"prototype_set_variable_controls--setVariableToContainerNarrow--HHbHQ prototype_set_variable_controls--setVariableToContainer--kxsCZ":!m&&l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainer--kxsCZ":!m&&!l.isNarrowPanel,"prototype_set_variable_controls--setVariableToContainerUI3--pGbDe":m,[u6]:m&&!e&&h?.resolvedType!==i.rXF.COLOR}),K=r.createElement("div",{className:D,"data-testid":"set-variable-container"},w),F=m?null!==w?r.createElement(lB.cS,{label:(0,d.tx)("proto.variable.value"),input:K}):null:K;return r.createElement("div",{className:m?void 0:T.cx.relative.$},L,u.isShown&&"variable-picker-set-variable-action"===u.type&&u.key===l.recordingKey?r.createElement(r.Fragment,null,r.createElement(lb.vx,{title:"",headerSize:"hidden",initialPosition:u.initialPosition,onClose:v,dragHeaderOnly:!1,initialWidth:216,canRenderBelowViewport:!0},r.createElement(u8.YK,{selectedItem:g,disabledVariableIds:new Set,currentView:P,pickerType:"set-variable",onVariableSelected:N,onClose:v,recordingKey:n0.Pt(l.recordingKey,"variablePickerForSelection"),searchQuery:y,onSearchInputChange:_,onComponentPropSelected:(0,s.kc)().ds_variable_props_proto?I:void 0,searchInputRef:C,renderSetControls:()=>r.createElement(u4.Z,{currentView:P,subscribedLibraries:[],setControlRightButtons:r.createElement(u2.f,{resolvedTypes:[i.rXF.BOOLEAN,i.rXF.STRING,i.rXF.FLOAT,i.rXF.COLOR]}),recordingKey:n0.Pt(l.recordingKey,"variablePickerForSelection")})})),r.createElement(u8.$3,{onClose:v})):null,F)}var Ee=n(896474),Et=n(394781);let En=(0,i5.ex)("prototype_state_management_info",function(){let e=r.createElement(E.N,{newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295",htmlAttributes:{rel:"noopener noreferrer",onMouseDown:e=>{e.stopPropagation(),e.preventDefault()}}},(0,d.tx)("proto.state_management.info_tooltip_learn_more")),t=r.createElement("span",null,r.createElement("strong",null,(0,d.tx)("proto.animation_panel.preserve_scroll_position")));return r.createElement("div",{className:"prototype_state_management_info_tooltip--stateManagementMoreInfo---gER1 tooltip--text--Ll1mS"},(0,d.tx)("proto.state_management.info_tooltip",{PreserveScrollPositionBold:t,LearnMoreLink:e}))}),Ea="prototype_state_management_panel--checkboxRow--2u02e checkbox--_checkboxRow--oEhow",Er="prototype_state_management_panel--expandCaret--uuDge";function Eo({transition:e,navigationType:t,recordingKey:n,showPreserveScrollPosition:a,showResetVideoState:l,showResetInteractiveComponentState:i,updateSelectionProperties:s,stateManagementVersion:c,selectedInteractions:p}){let m=(0,o.wA)(),u=(0,eu.GS)(),[E,g]=r.useState(!u),y=r.useContext(mW.c);if((0,i$.YT)()===i$.Oz.TWO_COL&&y===mW.P.LEFT)return null;let _=(0,i$.LH)(c),h=r.createElement(lL.S,{onChange:t=>{m((0,l9._P)({name:"Preserve Scroll Changed",params:{newValue:t}})),s({...function(e){if((0,aq.hS)(e.preserveScroll))return{transitionPreserveScroll:e.preserveScroll}}({...e,preserveScroll:t})})},checked:!0===e.preserveScroll,mixed:(0,aq.gl)(e.preserveScroll),recordingKey:n0.Pt(n,"preserve-scroll-check"),label:r.createElement(lD.J,null,(0,d.tx)("proto.animation_panel.preserve_scroll_position"))}),f=u?r.createElement(lB.TN,null,h):r.createElement(rm.fI,{className:Ea},h),v=r.createElement(lL.S,{onChange:t=>{m((0,l9._P)({name:"Reset Scroll Position Changed",params:{newValue:t,noodleUpgradedThisSession:Et.zZ.haveAnyInteractionsBeenUpgraded(p)}})),s({...function(e){if((0,aq.hS)(e.resetScrollPosition))return{transitionResetScrollPosition:e.resetScrollPosition}}({...e,resetScrollPosition:t})})},checked:!0===e.resetScrollPosition,mixed:(0,aq.gl)(e.resetScrollPosition),recordingKey:n0.Pt(n,"reset-scroll-position-check"),label:r.createElement(lD.J,null,(0,d.tx)("proto.animation_panel.reset_scroll_position"))}),b=r.createElement("div",{"data-tooltip-type":rf.Ib.SPECIAL,"data-tooltip":En,"data-tooltip-interactive":!0,"data-tooltip-show-immediately":!0,"data-tooltip-max-width":240,className:u?"prototype_state_management_panel--stateManagementPanelTooltipUI3--x5MQ3":void 0},r.createElement(Ee.In,{icon:"info-16"})),S=u?r.createElement(lB.TN,null,v," ",b):r.createElement(rm.fI,{className:Ea},v),T=r.createElement(lL.S,{onChange:t=>{m((0,l9._P)({name:"Reset Component State Changed",params:{newValue:t,noodleUpgradedThisSession:Et.zZ.haveAnyInteractionsBeenUpgraded(p)}})),s({...function(e){if((0,aq.hS)(e.resetInteractiveComponents))return{transitionResetInteractiveComponents:e.resetInteractiveComponents}}({...e,resetInteractiveComponents:t})})},checked:!0===e.resetInteractiveComponents,mixed:(0,aq.gl)(e.resetInteractiveComponents),recordingKey:n0.Pt(n,"reset-component-state-check"),label:r.createElement(lD.J,null,(0,d.tx)("proto.animation_panel.reset_component_state"))}),N=u?r.createElement(lB.TN,null,T):r.createElement(rm.fI,{className:Ea},T),I=r.createElement(lL.S,{onChange:t=>{m((0,l9._P)({name:"Reset Video Position Changed",params:{newValue:t}})),s({...function(e){if((0,aq.hS)(e.resetVideoPosition))return{transitionResetVideoPosition:e.resetVideoPosition}}({...e,resetVideoPosition:t})})},checked:!0===e.resetVideoPosition,mixed:(0,aq.gl)(e.resetVideoPosition),recordingKey:n0.Pt(n,"reset-video-position-check"),label:r.createElement(lD.J,null,(0,i$.LH)(c)?(0,d.tx)("proto.state_management.reset_video_state"):(0,d.tx)("proto.animation_panel.reset_video_state"))}),P=u?r.createElement(lB.TN,null,I):r.createElement(rm.fI,{className:Ea},I),C=r.createElement(rm.Zk,{className:`prototype_state_management_panel--stateManagementPanel--sYaaj ${(0,i$.kM)(c)&&"prototype_state_management_panel--stateManagementPanelWithVersion--AovOP"}`},!u&&r.createElement(rm.fI,null,r.createElement(rm.xw,{className:"prototype_state_management_panel--panelTitle--Nr4Eh",faded:!0},(0,d.tx)("proto.state_management")),!(0,i$.kM)(c)&&b),(0,i$.uU)(c)&&a&&f,l&&(0,i$.uU)(c)&&P,_&&S,_&&i&&N,_&&l&&P,(0,aq.gl)(c)&&r.createElement(d8.Y,{direction:"horizontal",padding:{horizontal:12,vertical:12}},r.createElement(rm.UZ,null,(0,d.tx)("proto.state_management.mixed_state_update")))),k=r.createElement(rh.U,{svg:E?rk.A:rA.A},E?r.createElement(rg.O,{className:Er}):r.createElement(rE.k,{className:Er})),A=r.createElement(nn.E,{key:"expand-caret",recordingKey:n0.Pt(n,"expand-caret"),onClick:()=>{g(!E)},actionOnPointerDown:!0,className:"prototype_state_management_panel--expandRow--RVDCp"},k,r.createElement("span",null,(0,d.tx)("proto.state")));return r.createElement(rt.k,{name:"prototype_state_management_panel"},u&&A,(E||!u)&&C)}let El=lU.c$,Ei=lU.l6,Es=l6.AD;class Ec extends iD.cP{format(e){return e===Es||null===e?(0,d.t)("proto.target_video_node_name_formatter.this_video"):super.format(e)}}function Ed(e){let{viableSameFrameVideoIds:t,disabledSameFrameVideoIds:n,scene:a,dropdownShown:l,targetVideoNodeID:i,isVideoSelected:s,onChange:c}=e,p=(0,o.wA)(),[m,u]=r.useState(()=>s?new Ec(a):new iD.cP(a));t.sort((e,t)=>{let n=m.format(e),a=m.format(t);return n.localeCompare(a)}),s&&t.unshift(Es);let E=t.length>0&&n.length>0,g=`prototype-target-video-select-${e.recordingKey}`,y=(0,eu.GS)(),_=r.createElement(Ei,{id:g,dataTestId:"target-video-select",className:"prototype_target_video_dropdown--targetVideoDropdown--6hKF-",chevronClassName:"prototype_target_video_dropdown--chevron--jgz53",inputClassName:"prototype_target_video_dropdown--input--infAK",property:(0,aq.gl)(i)?i:l6.dI(i),formatter:m,onChange:c,dispatch:p,dropdownShown:l,recordingKey:n0.Pt(e,"select"),onOptionFocus:e=>{ee.Uc(e??"")},dropdownAlignment:"left"},t.filter(e=>m.hasNameForNode(e)).map((t,n)=>r.createElement(El,{key:`enabled-${n}`,value:t,recordingKey:n0.Pt(e,`viable-option-${n}`),disabled:!1})),E&&r.createElement(lU.sK,null),n.filter(e=>m.hasNameForNode(e)).map((t,n)=>r.createElement(El,{key:`disabled-${n}`,value:t,recordingKey:n0.Pt(e,`viable-option-${n}`),disabled:!0})));return y?r.createElement(lB.cS,{input:_,label:(0,d.tx)("proto.video_dropdown.label")}):_}var Ep=n(946689);function Em({action:e,recordingKey:t,onURLChange:n,onOpenInNewTabChange:a}){let o=(0,eu.GS)(),l=r.createElement(Ep.ks,{className:o?"prototype_open_url_action_options--urlInputUI3--H-JfT":"prototype_open_url_action_options--urlInput--T-tGT",dataTestId:"url-input",placeholder:(0,d.t)("proto.interaction.example_com"),value:(0,aq.gl)(e.connectionURL)?(0,d.t)("fullscreen.mixed"):(0,aq._W)(e.connectionURL,""),onChange:n,recordingKey:n0.Pt(t,"urlTextInput"),autoFocus:!1}),i=r.createElement(lL.S,{label:r.createElement(lD.J,null,(0,d.tx)("proto.action_open_url_in_new_tab")),onChange:a,recordingKey:n0.Pt(t,"open-url-in-new-tab-check"),checked:void 0===e.openUrlInNewTab||!0===e.openUrlInNewTab});return r.createElement(r.Fragment,null,o?r.createElement(lB.cS,{label:(0,d.tx)("proto.open_url.text_input_label"),input:l}):l,o?r.createElement(lB.TN,null,i):r.createElement(rm.fI,{className:"prototype_open_url_action_options--checkboxRow--mu17T checkbox--_checkboxRow--oEhow"},i))}var Eu=n(588599);function EE({updateSelectionProperties:e,action:t,extraScrollOffset:n,showScrollToOptions:a,recordingKey:l}){let{smallNudgeAmount:i,bigNudgeAmount:s}=(0,aR.sT)(),c=(0,o.wA)(),p=(0,eu.GS)(),m=(t,n)=>(a,r)=>{t&&e({extraScrollOffset:{...t,[n]:a}},{shouldCommit:r})},u=(0,aq._W)(n,{x:0,y:0});if(!a||"SCROLL_TO"!==t)return null;let E=r.createElement(lt.gq,{className:p?void 0:mX.U,inputClassName:p?mX.oM:mX.hF,value:u.y,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:m(u,"y"),dispatch:c,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.y_offset"),tooltipForScreenReadersOnly:!1,recordingKey:n0.Pt(l,"extraScrollOffsetY")},p?r.createElement("span",{className:mX.QK},(0,d.tx)("proto.scroll_options.scroll_offset.y")):r.createElement(nC.B,{className:mX.QK,svg:Eu.A})),g=r.createElement(lt.gq,{className:p?void 0:mX.sC,inputClassName:p?mX.oM:mX.hF,value:u.x,wheelMultiplier:i,scrubMultiplier:i,smallNudgeAmount:i,bigNudgeAmount:s,onValueChange:m(u,"x"),dispatch:c,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.x_offset"),tooltipForScreenReadersOnly:!1,recordingKey:n0.Pt(l,"extraScrollOffsetX")},p?r.createElement("span",{className:mX.QK},(0,d.tx)("proto.scroll_options.scroll_offset.x")):r.createElement(nC.B,{className:mX.Kh,svg:Eu.A}));return p?r.createElement(lB.Cm,{label:(0,d.tx)("proto.scroll_options.offset"),leftInput:g,rightInput:E}):r.createElement(rm.fI,null,E,g)}let Eg=(0,r.memo)(function(e){return(0,nS.jsx)("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",...e,children:(0,nS.jsx)("path",{fill:"var(--color-icon)",fillRule:"evenodd",d:"M18 12a6 6 0 1 1-12 0 6 6 0 0 1 12 0m1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0m-6.5-3.5a.5.5 0 0 0-1 0V12a.5.5 0 0 0 .146.354l2 2a.5.5 0 0 0 .708-.708L12.5 11.793z",clipRule:"evenodd"})})}),Ey="prototype_video_action_options--chevron--mkNyv",E_="prototype_video_action_options--input--3-cEi",Eh=new iD.js,Ef=new iD.Z6;function Ev({action:e,onChange:t,updateSelectionProperties:n,dropdownShown:a,recordingKey:l}){let i=(0,eu.GS)(),s=(0,iD.Od)(e),c=(0,aq.E7)(e.mediaAction),p="UPDATE_MEDIA_RUNTIME"===(0,aq.E7)(e.connectionType),m="SKIP_TO"===c,u="SKIP_FORWARD"===c||"SKIP_BACKWARD"===c,E="PLAY"===c||"PAUSE"===c||"TOGGLE_PLAY_PAUSE"===c,g="MUTE"===c||"UNMUTE"===c||"TOGGLE_MUTE_UNMUTE"===c,y=(0,o.wA)(),_=(0,aR.RU)(),h=r.useCallback(e=>{n({mediaSkipToTime:e}),y((0,l9._P)({name:"Media skip to time changed",params:{value:e}}))},[y,n]),f=`prototype-media-action-select-${l}`,v="prototype_video_action_options--shortDropdown--NOXXv",b=a&&a.type===f?Eh:Ef,S=r.createElement(mV,{id:f,dataTestId:"media-play-pause-select",className:v,chevronClassName:Ey,inputClassName:E_,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:n0.Pt(l,"select")},r.createElement(mF,{key:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",value:"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE",recordingKey:n0.Pt(l,"toggle-play-pause-option"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_PLAY",value:"UPDATE_MEDIA_PLAY",recordingKey:n0.Pt(l,"play-option"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_PAUSE",value:"UPDATE_MEDIA_PAUSE",recordingKey:n0.Pt(l,"pause-option"),disabled:!1})),T=r.createElement(mV,{id:f,dataTestId:"media-mute-unmute-select",className:v,chevronClassName:Ey,inputClassName:E_,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:n0.Pt(l,"select")},r.createElement(mF,{key:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",value:"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE",recordingKey:n0.Pt(l,"toggle-mute-unmute-option"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_MUTE",value:"UPDATE_MEDIA_MUTE",recordingKey:n0.Pt(l,"mute-option"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_UNMUTE",value:"UPDATE_MEDIA_UNMUTE",recordingKey:n0.Pt(l,"unmute-option"),disabled:!1})),N=r.createElement(mV,{id:f,dataTestId:"media-skip-by-select",className:v,chevronClassName:Ey,inputClassName:E_,property:s,formatter:b,onChange:t,dispatch:y,dropdownShown:a,recordingKey:n0.Pt(l,"select"),dropdownWidth:160},r.createElement(mF,{key:"UPDATE_MEDIA_SKIP_FORWARD",value:"UPDATE_MEDIA_SKIP_FORWARD",recordingKey:n0.Pt(l,"skip-forward-option"),disabled:!1}),r.createElement(mF,{key:"UPDATE_MEDIA_SKIP_BACKWARD",value:"UPDATE_MEDIA_SKIP_BACKWARD",recordingKey:n0.Pt(l,"skip-backward-option"),disabled:!1})),I=r.createElement(lt.qd,{className:"prototype_video_action_options--timestampContainer---DdaI",inputClassName:"prototype_video_action_options--timestamp--luOrs",dataTestId:"mediaSkipToTime-input",dispatch:y,value:e.mediaSkipToTime||0,onValueChange:h,wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,displayFractions:!0,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.timestamp_to_set_to"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(l,"mediaSkipToTimeInput")},i?r.createElement(Eg,null):void 0),P="SKIP_BACKWARD"===c?(0,d.t)("proto.trigger.duration_to_jump_backward"):(0,d.t)("proto.trigger.duration_to_jump_forward"),C=r.createElement(lt.dE,{className:"prototype_video_action_options--timeAmountContainer--5kpHn",dataTestId:"mediaSkipByAmount-input",dispatch:y,value:e.mediaSkipByAmount||5,onValueChange:e=>{n({mediaSkipByAmount:e}),y((0,l9._P)({name:"Media skip by amount changed",params:{value:e}}))},wheelMultiplier:_/1e3,scrubMultiplier:_/1e3,max:3600,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":P,tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(l,"mediaSkipByAmountInput")});if(!p)return null;if(i){if(E)return r.createElement(lB.cS,{input:S,label:(0,d.tx)("proto.video_options.behavior")});if(g)return r.createElement(lB.cS,{input:T,label:(0,d.tx)("proto.video_options.behavior")});if(u)return r.createElement(r.Fragment,null,r.createElement(lB.cS,{input:N,label:(0,d.tx)("proto.video_options.direction")}),r.createElement(lB.cS,{input:C,label:(0,d.tx)("proto.video_options.offset")}));if(m)return r.createElement(lB.cS,{input:I,label:(0,d.tx)("proto.video_options.timestamp")})}return r.createElement(rm.fI,null,E&&S,g&&T,u&&N,u&&C,m&&I)}function Eb({action:e,recordingKey:t,interactionType:n,onActionChange:a,updateMultipleDestinationNodes:l,updateSelectionProperties:s,stateManagementVersion:c,autoOpenVariablePicker:p,autoOpenExpressionBuilder:m,setAutoOpenExpressionBuilder:u,...E}){let g=(0,o.wA)(),y=(0,rH.Um)(),{scene:_,selectionProperties:h}=(0,sD.R)(e=>({scene:e.mirror.sceneGraph,selectionProperties:e.mirror.selectionProperties})),f=(0,eu.GS)(),v=(0,i$.YT)(),b=v===i$.Oz.SINGLE_COL,S=v===i$.Oz.TWO_COL,N=r.useContext(mW.c),I=S&&N===mW.P.RIGHT,P="SET_VARIABLE"===(0,aq.E7)(e.connectionType),C="SET_VARIABLE_MODE"===(0,aq.E7)(e.connectionType),k="CONDITIONAL"===(0,aq.E7)(e.connectionType),A="INTERNAL_NODE"===(0,aq.E7)(e.connectionType),w="INTERNAL_NODE"===(0,aq.E7)(e.connectionType)&&"SWAP_STATE"===(0,aq.E7)(e.navigationType),O="URL"===(0,aq.E7)(e.connectionType),x=A||"BACK"===(0,aq.E7)(e.connectionType)||"CLOSE"===(0,aq.E7)(e.connectionType),R="UPDATE_MEDIA_RUNTIME"===(0,aq.E7)(e.connectionType),M=(0,iK.dq)(h),L=(0,tA.uQ)(),D=[],K=[];if(L){let{viableIds:e,disabledIds:t}=i.X3B.getVideoNodesOnSameTlfAsNode(L);D=e,K=t}let F=l6.dI((0,aq.E7)(e.transitionNodeID)),V=null!=F&&F!==l6.AD,U=A&&(!(0,aq.hS)(e.transitionNodeID)||V),B=(0,aq.E7)(e.navigationType),G=A&&"OVERLAY"===(0,aq.E7)(B),z=(0,i$.hU)(e.transitionType,e.easingType,e.easingFunction,e.transitionDuration,e.transitionShouldSmartAnimate,e.transitionPreserveScroll,e.transitionResetVideoPosition,e.openUrlInNewTab,e.transitionResetScrollPosition,e.transitionResetInteractiveComponents),H=x&&!G&&("INSTANT"===z.behavior||"DISSOLVE"===z.behavior),W=A&&"OVERLAY"===(0,aq.E7)(e.navigationType)&&V,Y=A&&(G||"SWAP"===(0,aq.E7)(B)),$=!R&&(0,i$.oc)(e),X=(0,i$.GB)(e),j=(0,i$.uU)(c)?H||$:(0,i$.Fp)(c,e.connectionType,e.navigationType),{selectedInteractions:Q}=(0,ij.Ay)(iB.J.NORMAL),J=Q.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>iL.d({nodeID:e.sourceNodeID,interactionID:e.id})),q=r.useCallback(e=>{let t=l6.sH(e);t&&s({transitionNodeID:t}),g((0,l9._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J),destinationTlfId:e}}))},[g,s,J]),Z=r.useCallback(e=>{l(e),g((0,l9._P)({name:"Variant based prototyping UI changed",params:{source:"panel"}})),g((0,l9._P)({name:"Prototype navigation destination changed",params:{source:"panel",connectorIds:JSON.stringify(J)}}))},[l,g,J]),ee=r.useCallback(e=>{s({connectionURL:e.target.value})},[s]),et=(0,iD.Od)(e),en=eI()({[mX.Ph]:!f,[mX.Ti]:E.isNestedInConditional&&!b&&!I}),ea=A&&!w,er=r.createElement(uJ,{className:mX.iR,dispatch:g,dropdownShown:y,onChange:q,nodeId:e.transitionNodeID||l6.Hr,scene:_,recordingKey:n0.Pt(t,"destinationDropdown"),action:et,isUI3:f}),eo=r.createElement(EE,{action:et,showScrollToOptions:"SCROLL_TO"===et,extraScrollOffset:e.extraScrollOffset,updateSelectionProperties:s,recordingKey:n0.Pt(t,"scrollOptionsPanel")}),el=r.createElement(uS,{interactionType:n,updateSelectionProperties:s,recordingKey:n0.Pt(t,"overlaySettings"),actionIndexPath:E.actionIndexPath,nodeId:e.transitionNodeID||l6.Hr});return r.createElement("div",{className:en},ea&&(f?r.createElement(r.Fragment,null,r.createElement(lB.cS,{label:Y?(0,d.tx)("proto.overlay"):(0,d.tx)("proto.destination"),input:er}),eo,W&&el):er),O&&r.createElement(Em,{action:e,recordingKey:t,onOpenInNewTabChange:e=>{s({openUrlInNewTab:e}),g((0,l9._P)({name:"Open Url In New Tab Changed",params:{value:e}}))},onURLChange:ee}),R&&r.createElement(Ed,{dropdownShown:y,scene:_,targetVideoNodeID:e.transitionNodeID||l6.Hr,recordingKey:n0.Pt(t,"targetVideoDropdown"),viableSameFrameVideoIds:D,disabledSameFrameVideoIds:K,isVideoSelected:M,onChange:q}),r.createElement(Ev,{dropdownShown:y,action:e,onChange:a,updateSelectionProperties:s,recordingKey:t}),!f&&eo,P&&r.createElement("div",{className:f?void 0:T.cx.ml4.$},r.createElement(u9,{className:mX.PB,dispatch:g,onChange:q,nodeId:e.transitionNodeID||l6.Hr,targetVariable:e.targetVariable||{id:""},targetVariableData:e.targetVariableData,updateSelectionProperties:s,recordingKey:n0.Pt(t,"setVariableControls"),action:et,isNestedInConditional:E.isNestedInConditional,isNarrowPanel:E.isNestedInConditional||E.isNarrowPanel,autoOpenVariablePicker:p})),C&&r.createElement("div",{className:f?void 0:T.cx.ml4.$},r.createElement(ud,{dispatch:g,targetVariableSetID:e.targetVariableSetID,targetVariableModeID:e.targetVariableModeID,deprecatedTargetVariableSetKey:e.targetVariableSetKey,updateSelectionProperties:s,recordingKey:n0.Pt(t,"setVariableControls"),actionIndexPath:E.actionIndexPath.join(",")})),k&&(I?r.createElement(uW,{recordingKey:n0.Pt(t,"conditionalActionSection","conditional-block",0),autoOpenExpressionBuilder:m,setAutoOpenExpressionBuilder:u,updateSelectionProperties:s,conditionalActions:(0,aq.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]}):r.createElement(uH,{updateSelectionProperties:s,recordingKey:n0.Pt(t,"conditionalActionSection"),action:e,updateMultipleDestinationNodes:l,interactionType:n,stateManagementVersion:c,selectedInteractions:E.selectedInteractions,actionIndexPath:E.actionIndexPath,onDrop:E.onDrop,onSelect:E.onSelect,onExpand:E.onExpand,onNewActionAdded:E.onNewActionAdded,selectedActionIndex:E.selectedActionIndex,expandedRows:E.expandedRows,autoOpenVariablePicker:p,handleMouseDownUI3:E.handleMouseDownUI3})),w&&r.createElement("div",{className:T.cx.ml0.$},r.createElement(uq,{onChange:Z,nodeId:e.transitionNodeID||l6.Hr,recordingKey:n0.Pt(t,"consumption"),actionIndexPath:E.actionIndexPath})),U&&r.createElement(r.Fragment,null,f&&r.createElement("div",{className:mX.x}),r.createElement(uw.X7,{transition:z,interactionType:n,navigationType:e.navigationType,recordingKey:n0.Pt(t,"animationPanel"),updateSelectionProperties:s,isNarrowPanel:E.isNestedInConditional||E.isNarrowPanel,stateManagementVersion:c})),W&&!f&&el,j&&r.createElement(r.Fragment,null,f&&r.createElement("div",{className:mX.x}),r.createElement(Eo,{connectionType:e.connectionType,transition:z,navigationType:e.navigationType,recordingKey:n0.Pt(t,"stateManagementPanel"),updateSelectionProperties:s,showPreserveScrollPosition:H,showResetVideoState:!!$,showResetInteractiveComponentState:!!X,stateManagementVersion:c,selectedInteractions:E.selectedInteractions})))}var ES=n(584999),ET=n(323110),EN=n(482725);let EI=Symbol("ACTION_ROW");function EP({updateMultipleDestinationNodes:e,updateSelectionProperties:t,onDeleteAction:n,stateManagementVersion:a,selectedInteractions:l,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,...p}){let m=(0,o.wA)(),{shouldShowAdvancedPrototypingPaywall:u,showAdvancedPrototypingVariablesModal:E,showAdvancedPrototypingConditionalActionsModal:g}=(0,i$.zt)(),y=(0,rH.Um)(),_=(0,i$.hP)(),{firstVariableSetMode:h,firstVariableSetID:f}=uc(),b=p.action,S=p.isNestedInConditional&&(0,uO.qQ)(p.action),T=!!b.connectionType&&"CONDITIONAL"===b.connectionType,N=(0,eu.GS)(),I=(0,i$.YT)(),P=I===i$.Oz.SINGLE_COL,C=I===i$.Oz.TWO_COL,k=r.useContext(mW.c),A=C&&k===mW.P.RIGHT,w=C&&k===mW.P.LEFT,O=!((0,aq.gl)(p.action)||["CLOSE","NONE"].includes(b.connectionType))&&!N;var x=p.selectedActionIndex.equals(p.actionIndexPath);let R=1===p.selectedActionIndex.path.length&&p.isNestedInConditional&&p.actionIndexPath[0]===p.selectedActionIndex.path[0];var M=void 0===p.expandedRows||void 0!==p.expandedRows.find(e=>e.equals(p.actionIndexPath));N&&(M=!!P||!w||T);let L=r.useCallback(()=>{(O||P)&&p.onExpand(p.actionIndexPath)},[O,P,p]),[D,K]=r.useState(!1);r.useEffect(()=>{if(T){let e=setTimeout(()=>{K(!0)},0);return()=>clearTimeout(e)}K(!0)},[T]);let F=T&&!M,V=T&&M,U=r.useRef(null),[B,G]=(0,v.fp)(i$.hV),{position:z,dragItem:H}=(0,mO.h4)(()=>({type:EI,element:U,item:p.action,dropPositionThreshold:V?.2:F?1/3:.5,getDeepestTargetOnly:!0,canDrag:!!w||!M,onDrop(e){p.onDrop(e),G(!0)}})),W=r.useMemo(()=>{let e=U.current;if(!e||!z||A)return;if(H&&"CONDITIONAL"===H.connectionType&&p.isNestedInConditional||(0,uO.qQ)(H)){G(!1);return}let t=S?mO.Nz.BEFORE:z;var n=void 0;let a=e.offsetParent?.firstElementChild?.scrollTop??0;return t===mO.Nz.BEFORE?n=e.offsetTop-a:t===mO.Nz.AFTER&&(n=e.offsetTop+e.offsetHeight-a),G(!0),n},[z,A,H,p.isNestedInConditional,S,G]),Y=z&&T&&!M&&z===mO.Nz.INSIDE&&"CONDITIONAL"!==H.connectionType,$=n0.rf(p.recordingKey,"mousedown",e=>{M||(x=!0,p.onSelect(p.actionIndexPath,!0))}),X=n0.rf(p.recordingKey,"mousedown",e=>{x=!1,p.onSelect(p.actionIndexPath,!1)}),j=n0.rf(p.recordingKey,"click",e=>{p.onSelect(p.actionIndexPath,!0)}),Q=n0.rf(p.recordingKey,"mousedown",e=>{(0,uO.qQ)(p.action)||p.onSelect(p.actionIndexPath,!0)}),J=e=>{var n=!0,a=!1;switch(e){case"NONE":t({connectionType:"NONE"});break;case"NAVIGATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"NAVIGATE"});break;case"OPEN_OVERLAY":t({connectionType:"INTERNAL_NODE",navigationType:"OVERLAY"});break;case"SCROLL_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SCROLL_TO"});break;case"SWAP_WITH":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP"});break;case"SWAP_STATE_TO":t({connectionType:"INTERNAL_NODE",navigationType:"SWAP_STATE"});break;case"GO_BACK":t({connectionType:"BACK"});break;case"CLOSE_OVERLAY":t({connectionType:"CLOSE"});break;case"OPEN_URL":t({connectionType:"URL"});break;case"SET_VARIABLE":u?(n=!1,E()):(t({connectionType:"SET_VARIABLE"}),i.current=!0);break;case"SET_VARIABLE_MODE":u?(n=!1,E()):t({connectionType:"SET_VARIABLE_MODE",targetVariableSetID:f,targetVariableModeID:h});break;case"UPDATE_MEDIA_PLAY":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PLAY"});break;case"UPDATE_MEDIA_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"PAUSE"});break;case"UPDATE_MEDIA_PLAY_PAUSE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_PLAY_PAUSE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_PLAY_PAUSE"});break;case"UPDATE_MEDIA_MUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"MUTE"});break;case"UPDATE_MEDIA_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"UNMUTE"});break;case"UPDATE_MEDIA_MUTE_UNMUTE_OPTIONS":case"UPDATE_MEDIA_TOGGLE_MUTE_UNMUTE":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"TOGGLE_MUTE_UNMUTE"});break;case"UPDATE_MEDIA_SKIP_BY_OPTIONS":case"UPDATE_MEDIA_SKIP_FORWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_FORWARD"});break;case"UPDATE_MEDIA_SKIP_BACKWARD":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_BACKWARD"});break;case"UPDATE_MEDIA_SKIP_TO":t({connectionType:"UPDATE_MEDIA_RUNTIME",mediaAction:"SKIP_TO"});break;case"CONDITIONAL":a=!0,u?(n=!1,g()):(t({connectionType:"CONDITIONAL"}),N&&c&&c(!0))}if(N||M||L(),C&&p.onExpand(p.actionIndexPath,a),n){let t=l.filter(e=>!!e.sourceNodeID&&!!e.id).map(e=>iL.d({nodeID:e.sourceNodeID,interactionID:e.id}));m((0,l9._P)({name:"Prototype action changed",params:{action:e,source:"panel",connectorIds:JSON.stringify(t)}}))}},q=p.isNestedInConditional?mX.It:mX.ft,Z=eI()({[mX.wu]:!w,[mX.zX]:w&&B}),ee=r.createElement(rh.U,{svg:ET.A},r.createElement(mM,{className:mX._2}));if(S&&p.onAddAction)return r.createElement("div",{className:w?mX.LW:void 0},W&&r.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),w&&p.isNestedInConditional&&ee,r.createElement("div",{className:Z,ref:U},r.createElement(uD,{addButtonPressed:p.onAddAction,recordingKey:n0.Pt(p.recordingKey,"addAction"),isNestedInConditional:!0})));let et=(0,iD._X)(b),en="NONE"!==et,ea=(M||!en)&&!w,er=p.numActions>1,eo=(p.numActions>1||p.isNestedInConditional)&&!w,el=eI()({[mX.$l]:!0,[mX.KY]:w&&!p.isNestedInConditional,[mX.Iw]:w&&!p.isNestedInConditional&&B,[mX.DM]:w&&p.isNestedInConditional,[mX.vs]:w&&p.isNestedInConditional&&B,[mX.M9]:w&&p.isNestedInConditional&&R&&B,[mX.I_]:w&&T&&!x&&B,[mX.Cu]:x&&!N,[mX.PE]:x&&w&&!p.isNestedInConditional,[mX.Ze]:Y,[mX.Op]:p.isNestedInConditional&&!N}),ei=eI()({[mX.rn]:!0,[mX.Gu]:w,[mX.Ti]:p.isNestedInConditional&&!N&&!A,[mX.Yo]:p.isNestedInConditional&&N&&!A}),es=r.createElement(nC.B,{key:"expand-caret",className:mX.GE,svg:M?rk.A:rA.A,recordingKey:n0.Pt(p.recordingKey,"expandCaret"),onClick:L}),ec=r.createElement(mZ,{action:b,isNestedInConditional:p.isNestedInConditional,isNarrowPanel:p.isNarrowPanel&&er,onClick:N?j:void 0}),ed=r.createElement(mB,{className:"NONE"===et||N?void 0:ES.fH,dispatch:m,dropdownShown:y,onChange:J,action:et,recordingKey:n0.Pt(p.recordingKey,"actionDropdown"),showVideoActions:_,isNestedInConditional:p.isNestedInConditional}),ep=r.createElement(rm.K0,{className:N?mX.gG:mX.hH,onClick:n,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"aria-label":(0,d.t)("proto.prototype_panel.delete"),recordingKey:n0.Pt(p.recordingKey,"actionDeleteButton")},r.createElement(rh.U,{svg:EN.A},r.createElement(iR.O,null))),em=r.createElement(rm.fI,{className:ei,onDoubleClick:L},O&&es,ea?r.createElement("span",{className:mX.P2},ed):ec,eo&&ep),eE=ea?ed:ec,eg=r.createElement(mL.S.div,{className:ei,onDoubleClick:L},O&&es,eo?r.createElement(ow.DE,{appendedClassName:mX.Jw,label:null,input:eE,icon:ep}):r.createElement(ow.Ad,{appendedClassName:mX.Jw,label:null,input:eE})),ey=(0,d.tx)("proto.action"),e_=r.createElement(mL.S.div,{className:ei},P||A?r.createElement(lB.cS,{label:ey,input:eE}):eE),eh=N?e_:eg,ef=eI()({[mX.Oe]:!0,[mX.h2]:x,[mX.Ob]:T});return r.createElement(mL.S.div,{className:el,ref:U,role:"button",tabIndex:0,onMouseDown:N?void 0:$,onMouseUp:N?void 0:X},void 0!==W&&r.createElement("hr",{className:q,style:{transform:`translateY(${W}px)`}}),w?r.createElement(mL.S.div,{className:ef,role:"button",tabIndex:0,onMouseDown:N?Q:void 0},p.isNestedInConditional&&ee,eh):N?eh:em,M&&D&&r.createElement(Eb,{updateMultipleDestinationNodes:e,action:b,onActionChange:J,recordingKey:p.recordingKey,updateSelectionProperties:t,interactionType:p.interactionType,stateManagementVersion:a,selectedInteractions:l,isNestedInConditional:p.isNestedInConditional,isNarrowPanel:p.isNarrowPanel,actionIndexPath:p.actionIndexPath,onDrop:p.onDrop,onSelect:p.onSelect,onExpand:p.onExpand,onNewActionAdded:p.onNewActionAdded,selectedActionIndex:p.selectedActionIndex,expandedRows:p.expandedRows,autoOpenVariablePicker:i,autoOpenExpressionBuilder:s,setAutoOpenExpressionBuilder:c,handleMouseDownUI3:Q}))}var EC=n(427113),Ek=n(682331);function EA({onChange:e,value:t,shouldFocusKeyCaptureField:n,setShouldFocusKeyCaptureField:a}){let o;let l=(0,iX._i)(t?.keyCodes),i=t=>e({keyCodes:t,triggerDevice:"KEYBOARD"}),[s,c]=r.useState(!1),p=r.useRef(null);r.useEffect(()=>{(!t||!t.keyCodes||0===t.keyCodes.length)&&n&&p.current&&(a(!1),p.current.focus(),c(!0))},[a,n,t]),r.useEffect(()=>{if(!s)return()=>{};let t=new Ek.L,n=t.onPress(t=>{e({keyCodes:[t.buttons[0]],triggerDevice:t.controllerType}),requestAnimationFrame(()=>{document.activeElement instanceof HTMLElement&&document.activeElement.blur()})});return t.start(),()=>{n.release(),t.end()}},[e,s]);let m=null,u=(0,iX.E8)(t),E=(0,eu.GS)();return s?o=r.createElement(Ew,null,E?(0,d.tx)("proto.keyCapture.press_key_lowercase"):(0,d.tx)("proto.keyCapture.press_key")):t?.triggerDevice==="KEYBOARD"&&l?m=(0,iX.U8)(l):u?m=u:o=r.createElement(Ew,null,E?(0,d.tx)("proto.keyCapture.click_to_set_key"):(0,d.tx)("proto.keyCapture.click_to_select")),r.createElement(rm.rp,{ref:p,className:"prototype_key_capture_field--root--bD21s","data-tooltip-type":rf.Ib.TEXT,"data-tooltip":m&&m.length>10?m:null,onFocus:()=>c(!0),onBlur:()=>c(!1),onKeyDown:e=>{e.preventDefault(),e.stopPropagation();let t=e.which||e.keyCode;!iX.RI.has(t)&&iX.pu[t]&&(t===l?.keyCode&&e.repeat?i((0,iX.wb)({keyCode:t,metaKey:e.metaKey||l.metaKey,shiftKey:e.shiftKey||l.shiftKey,ctrlKey:e.ctrlKey||l.ctrlKey,altKey:e.altKey||l.altKey})):i((0,iX.wb)({...e,keyCode:t})),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},recordingKey:"keycapture"},m??o)}function Ew({children:e}){return r.createElement("span",{className:"prototype_key_capture_field--placeholder--gWUKF"},e)}let EO=lU.l6,Ex=lU.c$,ER=new iD.VG,EM=new iD.EX,EL=new iD.JV,ED=new iD.Eq;function EK(e){let t=(0,o.wA)(),n=(0,rH.Um)(),a=(0,eu.GS)(),l=(0,l7.cJ)(),{showVideoV2Triggers:s}=(0,sD.R)(e=>({allStatesInSelection:e.mirror.selectionProperties.stateGroupSelectionInfo?.mode===i.iCO.STATE,allTopLevelFramesInSelection:!!e.mirror.selectionProperties.allTopLevelFramesInSelection,showVideoV2Triggers:(0,iK.dq)(e.mirror.selectionProperties)})),c=(0,v.md)(iF.NE),d=(t,n)=>{let o=r.createElement("div",{className:"transition_interaction_dropdown--prototypeInteractionIcon---njby"},(0,iK.e7)(t));return r.createElement(Ex,{key:n,value:t,icon:a?o:void 0,recordingKey:n0.Pt(e,t),disabled:!function(t){if("NONE"===t)return!0;let n=!!e.interactionsOnSelectedNodes&&e.interactionsOnSelectedNodes.every(t=>e.interactionsOnSelectedNodes&&l6.aI(t.sourceNodeID,e.interactionsOnSelectedNodes[0].sourceNodeID))&&!(0,aq.hS)(e.property),a=(function(){if(e.interactionsOnSelectedNodes)return new Set(e.interactionsOnSelectedNodes.map(e=>e?.event?.interactionType).filter(e=>void 0!==e))})()?.has(t)&&(0,aq.hS)(e.property)&&e.property!==t;return(!n&&!a||!!["ON_KEY_DOWN","DRAG","ON_VOICE","ON_MEDIA_HIT"].includes(t))&&("AFTER_TIMEOUT"===t?!e.interactionContainsOpenLinkAction:"ON_MEDIA_HIT"===t||"ON_MEDIA_END"===t?s:(!e.interactionContainsOpenLinkAction||"ON_CLICK"===t||"MOUSE_UP"===t)&&(!e.interactionContainsUpdateMediaRuntime||"ON_HOVER"!==t&&"ON_PRESS"!==t&&"DRAG"!==t)&&(!e.interactionOnlyContainsBack||"ON_HOVER"!==t&&"ON_PRESS"!==t))}(t)})},p=(l?[]:["NONE"]).map(d),m=["ON_CLICK",...l?[]:["DRAG"],"ON_HOVER","ON_PRESS","ON_KEY_DOWN"].map(d),u=["MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].map(d),E=(l?[]:["ON_MEDIA_HIT","ON_MEDIA_END"]).map(d),g=["AFTER_TIMEOUT"].map(d),y=c?"ON_MEDIA_HIT"!==e.property?EM:ED:"ON_MEDIA_HIT"!==e.property?ER:EL,_=r.useCallback(e=>e-24,[]),h=(0,aq.E7)(e.property);return r.createElement(EO,{id:"interaction-type-select",className:e.className,chevronClassName:"transition_interaction_dropdown--chevron--pyzhq",dataTestId:"interaction-select",property:e.property,formatter:y,icon:a&&h?(0,iK.e7)(h):void 0,onChange:e.onChange,dispatch:t,dropdownShown:n,recordingKey:n0.Pt(e,"select"),hideDropdownWhenContainerMoves:!(0,ak.nl)(),dropdownAlignment:_,dropdownWidth:160},p,!l&&r.createElement(lU.sK,null),m,r.createElement(lU.sK,null),u,!l&&r.createElement(lU.sK,null),g,!l&&s&&[r.createElement(lU.sK,{key:""}),...E])}let EF={keyCodes:[],triggerDevice:"KEYBOARD"};function EV(e,t,n,a){return n?r.createElement(lB.cS,{label:e,input:t,appendedClassName:a?void 0:mX.dU}):r.createElement(rm.fI,null,t)}function EU(e){let{detailPropsMultipleActions:t,interactionsOnSelectedNodesAndComponents:n,updateSelectionProperties:a}=(0,ij.Ay)(e.category),{interactionType:l="NONE",transitionTimeout:i=.8,mediaHitTime:s=0,interactionMaintained:c=!1,interactionDuration:p=.3,keyTrigger:m=EF}=t.interactionEvent,u=(e,t)=>{if(e.connectionType===t)return e;if("CONDITIONAL"===e.connectionType)for(let n of(0,aq.hS)(e.conditionalActions)&&e.conditionalActions?e.conditionalActions:[]){let e=n.actions?n.actions.find(e=>e.connectionType===t):void 0;if(void 0!==e)return e}return null},E=void 0!==t.interactionActions.find(e=>u(e,"URL")),g=void 0!==t.interactionActions.find(e=>u(e,"UPDATE_MEDIA_RUNTIME")),y=1===t.interactionActions.length&&"BACK"===t.interactionActions[0].connectionType,_=void 0!==t.interactionActions.find(e=>u(e,"CONDITIONAL"));return function(e){let t=(0,o.wA)(),n=e.updateSelectionProperties,a=(0,aR.RU)(),[l,i]=r.useState(!1),s=(0,eu.GS)(),c=(0,i$.YT)(),p=c===i$.Oz.SINGLE_COL,m=c===i$.Oz.TWO_COL,u=!0===(0,aq.E7)(e.maintained),E=(0,aq.E7)(e.keyTrigger),g="ON_KEY_DOWN"===(0,aq.E7)(e.interactionType),y="AFTER_TIMEOUT"===(0,aq.E7)(e.interactionType),_="ON_MEDIA_HIT"===(0,aq.E7)(e.interactionType),h=["MOUSE_IN","MOUSE_OUT","MOUSE_ENTER","MOUSE_LEAVE","MOUSE_DOWN","MOUSE_UP"].indexOf((0,aq.E7)(e.interactionType)||"")>-1,f=r.createElement(EK,{className:mX.sQ,property:e.interactionType,onChange:a=>{mw.sn.start("interaction_details_changed"),n({interactionType:a}),t((0,l9._P)({name:"Prototype Interaction Type Changed",params:{newType:a,oldType:(0,aq._W)(e.interactionType,"MIXED")}})),"ON_KEY_DOWN"===a&&i(!0)},interactionContainsOpenLinkAction:e.interactionContainsOpenLinkAction,interactionContainsUpdateMediaRuntime:e.interactionContainsUpdateMediaRuntime,interactionOnlyContainsBack:e.interactionOnlyContainsBack,recordingKey:n0.Pt(e,"interactionDropdown"),interactionsOnSelectedNodes:e.interactionsOnSelectedNodes}),v=s?p?r.createElement(lB.cS,{label:(0,d.tx)("proto.trigger"),input:f}):r.createElement("div",{className:mX.BX},f):r.createElement(rm.fI,{className:eI()(mX.SG,mX.QT)},f,r.createElement("div",{className:mX.LY},e.headerButtons)),b=r.createElement(r.Fragment,null,y&&EV((0,d.tx)("proto.delay"),r.createElement(lt.W4,{className:s?mX.Lp:mX.Zp,inputClassName:s?mX.Gl:void 0,dataTestId:"timeout-input",dispatch:t,value:e.timeout,onValueChange:e=>{n({transitionTimeout:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:20,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(e,"timeoutInput")},s?r.createElement(EC.A,null):void 0),s,p),g&&EV((0,d.tx)("proto.key"),r.createElement(EA,{onChange:e=>{n({keyTrigger:e})},value:E,shouldFocusKeyCaptureField:l,setShouldFocusKeyCaptureField:i}),s,p),_&&EV((0,d.tx)("proto.time"),r.createElement(lt.qd,{displayFractions:!0,className:mX.Ym,inputClassName:mX.vE,dataTestId:"mediaHitTime-input",dispatch:t,value:e.mediaHitTime,onValueChange:e=>{n({mediaHitTime:e})},wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,max:3600,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.video_hit_time"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(e,"mediaHitTimeInput")},s?r.createElement(Eg,null):void 0),s,p),h&&EV((0,d.tx)("proto.delay"),r.createElement(lt.W4,{className:s?mX.Lp:mX.aq,inputClassName:s?mX.Gl:mX.p0,dataTestId:"duration-input",dispatch:t,value:u?e.interactionDuration:void 0,onValueChange:e=>{n(e&&e>0?{interactionMaintained:!0,interactionDuration:e}:{interactionMaintained:!1})},min:0,allowEmpty:!0,placeholder:(0,d.t)("proto.trigger.add_delay_placeholder"),wheelMultiplier:a/1e3,scrubMultiplier:a/1e3,"data-tooltip-type":rf.Ib.TEXT,"data-tooltip":(0,d.t)("proto.trigger.after_delay_timeout"),tooltipForScreenReadersOnly:!0,recordingKey:n0.Pt(e,"delayInput")},s?r.createElement(EC.A,null):void 0),s,p));return s?r.createElement("div",{className:m?mX.eU:void 0},v,b):r.createElement("div",{className:mX.cF},v,b)}({...e,updateSelectionProperties:a,interactionType:l,interactionContainsOpenLinkAction:E,interactionContainsUpdateMediaRuntime:g,interactionOnlyContainsBack:y,interactionContainsConditionalAction:_,timeout:i,maintained:c,interactionDuration:p,mediaHitTime:s,keyTrigger:m,interactionsOnSelectedNodes:n,recordingKey:n0.Pt(e.recordingKey,i$.Qe)})}let EB="prototype_interaction_edit_modal--contentContainer--bo2b4",EG="prototype_interaction_edit_modal--ui3TwoColContentContainer--x9vrG",Ez="prototype_interaction_edit_modal--ui3SingleColContentContainer--uF-ir",EH="prototype_interaction_edit_modal--dividerHorizontal--3wvnB",EW="prototype_interaction_edit_modal--ui3InteractionsPanelContentRight--bVfG8";function EY(e){let{selectedInteractions:t,makeUpdateSelectionPropertiesForActionIndex:n,makeUpdateMultipleDestinationNodesForActionIndex:a,differentLengthActions:o,mergedActions:l}=(0,ij.Ay)(e.category),i="NONE"!==(0,aq.E7)(e.interactionType),s=void 0!==l.find(e=>"CONDITIONAL"===e.connectionType),{selectedActionIndex:c,onSelect:p}=e,m=(0,eu.GS)(),u=(0,i$.YT)(),E=u===i$.Oz.SINGLE_COL,g=u===i$.Oz.TWO_COL,{expandedRows:y,setExpandedRows:_,deleteButtonPressed:h,newActionIndexPath:f,resetNewActionIndexPath:v}=e;r.useEffect(()=>{f&&!f?.equals([])&&(m?p(f.path,!0):(_([...y,f]),p([],!1)),v())},[y,_,f,v,p,m]);let b=r.useCallback(e=>{y.find(t=>t.equals(e))?_(y.filter(t=>!t.equals(e))):_([...y,new uO.Op(e)])},[y,_]),S=r.useCallback(n=>{var a=n.dropItem;if((0,aq.gl)(a)||(0,uO.qQ)(n.dragItem))return;let r=e.interactionsOnSelectedNodes;if(!r||!t)return;for(var o=0;o<t?.length;o++){let e=t[o];if(e&&e.actions){let r=e.actions,l=(0,uO.Vp)(r,c,y,a,n.position);if(l.newSelectedActionIndex&&g&&p(l.newSelectedActionIndex.path,!0),l.newActions&&(t[o].actions=l.newActions,m||p([],!1)),l.newExpandedRows){if(g){let e=[];l.newActions?.forEach((t,n)=>{"CONDITIONAL"===t.connectionType&&e.push(new uO.Op([n]))}),_(e)}else _(l.newExpandedRows)}}}let l=r.map(e=>t.find(t=>t.id===e.id)??e);n2.Y5.updateSelectionProperties({prototypeInteractions:l})},[y,_,e.interactionsOnSelectedNodes,c,t,p,m,g]),T=eI()({"prototype_interaction_edit_modal--panelUI3--WK3CN":m,"prototype_interaction_edit_modal--panelUI3TwoColumn--V5gi4":g});return r.createElement(mO.hh,null,r.createElement(rm.Zk,{className:T},e.shouldHideTitle?null:r.createElement(rm.fI,null,r.createElement(rm.U8,{title:(0,d.t)("proto.interaction.interaction"),dataTooltipContentKey:mR,dataTooltipTimeoutDelay:50})),r.createElement("div",null,(i||m)&&r.createElement(r.Fragment,null,E&&r.createElement(r.Fragment,null,r.createElement(EU,{category:e.category,recordingKey:i$.dJ,headerButtons:r.createElement(r.Fragment,null)}),r.createElement("div",{className:"prototype_interaction_edit_modal--dividerHorizontalUI3--HMCeE"})),o&&r.createElement(d8.Y,{direction:"horizontal",padding:{horizontal:16,vertical:12}},r.createElement(rm.UZ,null,(0,d.tx)("fullscreen.properties_panel.click_plus_to_replace_mixed_content"))),!o&&r.createElement(r.Fragment,null,l?.map((o,i)=>r.createElement(EP,{key:i,updateMultipleDestinationNodes:a(i),action:o,recordingKey:n0.Pt(e.recordingKey,i$.eG,i),updateSelectionProperties:n(i),onDeleteAction:()=>h(i),interactionType:e.interactionType,actionIndexPath:[i],numActions:l.length,isNestedInConditional:!1,isNarrowPanel:!s,stateManagementVersion:e.stateManagementVersion,selectedInteractions:t,onDrop:S,onSelect:e.onSelect,onExpand:b,selectedActionIndex:c,autoOpenVariablePicker:e.autoOpenVariablePicker,expandedRows:y,onNewActionAdded:e.onNewActionAdded,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder})))))))}function E$({transition:e,recordingKey:t,updateSelectionProperties:n,stateManagementVersion:a,selectedInteractions:l}){let i=(0,o.wA)(),s=(0,eu.GS)(),c=(0,i$.YT)()===i$.Oz.SINGLE_COL,m=()=>{for(let t of(eP.az.trackDefinedEvent("prototype.state_management_noodle_upgraded",{num_interactions:l.length,preserve_scroll_position_value:!!e.preserveScroll}),l))(0,i$.uU)(t.stateManagementVersion)&&t.id&&t.sourceNodeID&&Et.zZ.recordInteractionUpgraded(t.id,t.sourceNodeID);n({...(0,aq.hS)(e.preserveScroll)&&(0,aq.hS)(a)?{transitionResetScrollPosition:!e.preserveScroll}:{},stateManagementVersion:1}),i(p.F.enqueue({type:"state-management-updated",message:(0,d.t)("proto.state_management.visual_bell_updated_message"),button:{text:(0,d.t)("proto.state_management.visual_bell_update_all"),action:()=>{n2.Y5.triggerActionInUserEditScope("update-interactions-state-management-on-page"),i(p.F.enqueue({type:"state-management-updated-all",message:(0,d.t)("proto.state_management.visual_bell_update_all_message")}))}}}))},u=()=>{eP.az.trackDefinedEvent("prototype.state_management_noodle_reverted",{num_interactions:l.length}),n({stateManagementVersion:0})},g=1===a?r.createElement(n3.$n,{variant:"link",recordingKey:n0.Pt(t,"revert-state-management-version"),onClick:u,htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):r.createElement(n3.$n,{variant:"secondary",recordingKey:n0.Pt(t,"update-state-management-version"),onClick:m},(0,d.tx)("proto.state_management.update_controls")),y=c?n3.IK:n3.$n,_=1===a?r.createElement(y,{variant:"secondary",onClick:u,recordingKey:n0.Pt(t,"revert-state-management-version"),htmlAttributes:{"data-testid":"revert-state-management-button"}},(0,d.tx)("proto.state_management.revert_controls")):r.createElement(y,{variant:"primary",onClick:m,recordingKey:n0.Pt(t,"update-state-management-version")},(0,d.tx)("proto.state_management.update_controls")),h=1===a?(0,d.tx)("proto.state_management.new_controls"):(0,d.tx)("proto.state_management.old_controls"),f=r.createElement(E.N,{trusted:!0,newTab:!0,href:"https://help.figma.com/hc/articles/14397859494295"},s?(0,d.tx)("proto.state_management.controls_help_link_new"):(0,d.tx)("proto.state_management.controls_help_link")),v=r.createElement("div",{className:"prototype_state_management_version_panel--versionControls--siAOf"},r.createElement(rm.JU,{className:"prototype_state_management_version_panel--label--vvYMX"},h,f),r.createElement("div",{className:"prototype_state_management_version_panel--buttonContainer--rJZ-y"},g)),b=r.createElement("div",{className:"prototype_state_management_version_panel--containerUI3--V5tpG"},r.createElement(lD.J,null,h),r.createElement(lD.J,null,f),_),S=r.createElement("div",{className:"prototype_state_management_version_panel--containerUI3TwoCol--AAp8u"},r.createElement("span",{className:"prototype_state_management_version_panel--labelWrapperUI3--37g5A"},r.createElement(lD.J,null,h)),r.createElement("span",{className:"prototype_state_management_version_panel--helpLinkWrapperUI3--BttuC"},f),_);return r.createElement(rt.k,{name:"prototype_state_management_version_panel"},r.createElement(rm.Zk,{className:s?"prototype_state_management_version_panel--panelUI3--8-Db5":void 0},s?c?b:S:v))}let EX="created_noodle";function Ej(e){let{shouldHideTitle:t=!1,category:n,newActionIndexPath:a}=e,o=(0,i$.YT)()===i$.Oz.TWO_COL,{detailProps:l,detailPropsMultipleActions:i,interactionsOnSelectedNodesAndComponents:s,updateSelectionProperties:c,selectedInteractions:d}=(0,ij.Ay)(e.category);(0,eC.h)(()=>{if(void 0!==mw.sn.get(EX)){let e=mw.sn.stop(EX);(0,eP.sx)(EX,{elapsedMs:e,numConnectors:d.length},{forwardToDatadog:!0})}});let{showPanel:p,transition:m}=(0,i$.n6)(l,i,d),{interactionType:u="NONE",interactionMaintained:E=!1,interactionDuration:g=.3,keyTrigger:y=EF,transitionTimeout:_=.8,mediaHitTime:h=0}=i.interactionEvent,f=(0,i$.iC)(d),v=r.createElement(EY,{interactionType:u,timeout:_,mediaHitTime:h,maintained:E,interactionDuration:g,keyTrigger:y,recordingKey:n0.Pt(e,i$.Qe),shouldHideTitle:t,interactionsOnSelectedNodes:s,category:n,stateManagementVersion:f,autoOpenVariablePicker:e.autoOpenVariablePicker,newActionIndexPath:a,resetNewActionIndexPath:e.resetNewActionIndexPath,onNewActionAdded:e.onNewActionAdded,onSelect:e.onSelect,selectedActionIndex:e.selectedActionIndex,expandedRows:e.expandedRows,setExpandedRows:e.setExpandedRows,deleteButtonPressed:e.deleteButtonPressed,autoOpenExpressionBuilder:e.autoOpenExpressionBuilder,setAutoOpenExpressionBuilder:e.setAutoOpenExpressionBuilder});return r.createElement("div",null,v,!o&&p&&r.createElement(E$,{transition:m,recordingKey:n0.Pt(e,"stateManagementVersionPanel"),updateSelectionProperties:c,stateManagementVersion:f,selectedInteractions:d}))}var EQ=n(360803),EJ=n(102165);function Eq(e,t,n){let[a,r,o]=e.path,l=t[a].conditionalActions;if((0,aq.hS)(l)){let e=l?.[r].actions?.length??0;if(o>=e){if(0===e){n([a],!0);return}n([a,r,o-1],!0);return}}}function EZ(e,t,n){let a=e.path[0]>=t.length,r=0===e.path.length;if(a){n([t.length-1],!0);return}if(r){n([0],!0);return}}var E0=n(277687);let E1=()=>{i.glU.setSelectedInteractions([]),(0,s.kc)().prototype_ai_magic_link_show_suggestion_toast&&n2.Y5.showMagicLinkSuggestedVisualBell("create_node_transition"),n2.Y5.deselectProperty()},E2=(0,nf.jz)("197px"),E4=(0,nf.c8)("50%");function E8(e){var t;return e&&a?.height<369?a=t={...a,height:369}:a??={width:440,height:e?369:320,leftWidthPct:45}}let E3=r.memo(function(){let e=(0,o.d4)(E9),t=(0,ij.HS)(),{selectedInteractions:n}=(0,ij.Ay)(t),a=n.length>0,[l,i]=r.useState(!1),s=n0.v_(i$.dJ,"keydown",t=>"Shift"!==t.key?n0.aH:(i(!0),e&&a)?void 0:n0.aH),c=n0.v_(i$.dJ,"keyup",t=>"Shift"!==t.key?n0.aH:(i(!1),e&&a)?void 0:n0.aH);if(r.useEffect(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",c),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",c)}),[s,c]),!e||!a)return null;let d=n.some(e=>e.actions?.some(e=>"CONDITIONAL"===e.connectionType));return r.createElement(E5,{category:t,containsConditional:d,pressingShiftKey:l,initialX:e.initialX,initialY:e.initialY,shouldPin:e.shouldPin,setPressingShiftKey:i})}),E5=r.memo(function({category:e,containsConditional:t,pressingShiftKey:n,initialX:l,initialY:s,shouldPin:c,setPressingShiftKey:p}){let m=(0,o.wA)(),[u,E]=r.useState(!1),[,g]=(0,v.fp)(EJ.x),y=(0,r.useRef)(null),[_,h]=r.useState(!1),f=c||u,b=(0,eu.GS)(),S=(0,i$.YT)(),T=S===i$.Oz.SINGLE_COL,N=S===i$.Oz.TWO_COL,[I,P]=r.useState(new uO.Op(b?[0]:[])),{selectedInteractions:C,differentLengthActions:k,interactionsOnSelectedNodesAndComponents:A,mergedActions:w,detailProps:O,detailPropsMultipleActions:x,updateSelectionProperties:R}=(0,ij.Ay)(e);var M=I.path.length>0?I:new uO.Op([0]);let L=M.isConditional(),D=(e,t)=>M=new uO.Op(e);b&&M.path[0]>=w.length&&!L?EZ(I,w,D):b&&L&&Eq(I,w,D);let K=r.useCallback((e,t)=>{t?P(new uO.Op(e)):P(new uO.Op([]))},[]);r.useEffect(()=>{if((0,mC.vA)(w.length>0,"the interactions panel should always have actions if rendered"),!b)return;let e=I.isConditional();if(e){if(e){Eq(I,w,K);return}}else{EZ(I,w,K);return}},[w,I,b,K]);let{shouldShowAdvancedPrototypingPaywall:F,showAdvancedPrototypinglMultipleActionsModal:B}=(0,i$.zt)(),{showPanel:G,transition:z}=(0,i$.n6)(O,x,C),H=(0,i$.iC)(C);var W=[];N?w.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&W.push(new uO.Op([t]))}):w.length<4&&w.forEach((e,t)=>{W.push(new uO.Op([t]))});let[Y,$]=r.useState(W),X=r.useRef(null),j=n&&!f&&!_,Q=(0,nf.jz)(i9.prototypeInteractionModalWidth),J=(0,nf.jz)(i9.prototypeInteractionModalExpandedWidth),q=E8(G).width,Z=t?J:Q;N&&(Z=q);let[ee,et]=r.useState(c),en=(0,cZ._X)({subscribeToUpdates_expensive:!c}),ea=r.useCallback(()=>{u||(m((0,l9._P)({name:"prototype_interaction_details_modal_dragged"})),E(!0))},[m,u,E]),er=r.useMemo(()=>{let e=new tf.Mi(l,s);if(c)return N?new tf.Mi(e.x-(q-Q),e.y):t?new tf.Mi(e.x-(J-Q),e.y):e;{let t=(0,cZ.$g)(en,e);return new tf.Mi(t.x-Z/2,t.y+30)}},[Z,l,s,t,c,en,N,J,Q,q]);r.useEffect(()=>{if(!n)return;let e=e=>{!e.shiftKey&&n&&p(!1)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[n,p]),r.useEffect(()=>{g(j)},[g,j]),r.useEffect(()=>{et(c)},[c]),r.useEffect(()=>()=>{m((0,l9._P)({name:"prototype_interaction_details_modal_closed"}))},[m]);let eo=r.useRef(null),[el,ei]=r.useState(!1);r.useEffect(()=>{el&&(ei(!1),eo.current?.scrollToBottom())},[el,ei,eo]);let[es,ec]=r.useState(new uO.Op([])),ed=(0,U.q5)(),ep=r.useCallback((e,t)=>{let n=e.event.clipboardData||window.clipboardData;switch(t){case rc.zy.COPY:case rc.zy.CUT:{let a=JSON.parse(JSON.stringify(C)),r=(0,EQ.l)(a),o=cy.fG(ed?.key||null,{prototypeInteractions:r});if(cy.C4(n,o,""),t===rc.zy.CUT){let e=[];for(let t of C){let{sourceNodeID:n,id:a}=t;n&&a&&e.push(iL.d({nodeID:n,interactionID:a}))}a5.l7.user("delete-prototype-interactions",()=>i.glU.deleteInteractions(e)),n2.Y5.deselectProperty()}e.accept()}}},[ed?.key,C]),em=r.useRef(!1),[eE,eg]=r.useState(!1),{firstVariableSetMode:ey,firstVariableSetID:e_}=uc(),eh=(0,V.p8)("currentPage"),ef=r.useCallback((e,t,n,a)=>{m((0,l9._P)({name:"Prototype delete action",params:{action:e,source:"panel",connector_id:t,page_id:n,actionInConditionalAction:a}}))},[m]),ev=r.useCallback(e=>{if(A&&C){var t=!1,n=!1;if(F)B();else{for(let o=0;o<C?.length;o++){let l=C[o],i=[];if(l&&l.actions){var a=0,r=[];for(let o=0;o<l.actions.length;o++){let s=l.actions[o];if(o!==e)void 0!==Y.find(e=>e.equals([o]))&&r.push(new uO.Op([a])),i.push(s),a++;else{let e=l.id?l.id:l6.Hr;ef(s.connectionType?s.connectionType:"NONE",(0,l6.dI)(e),eh),o===l.actions.length-1&&(t=!0),2===l.actions.length&&(n=!0)}$(r)}C[o].actions=i}}let o=A.map(e=>C.find(t=>t.id===e.id)??e);n2.Y5.updateSelectionProperties({prototypeInteractions:o}),n&&b&&$([new uO.Op([0])]),t&&N&&P(new uO.Op([e-1]))}}},[A,C,F,B,Y,eh,ef,N,b]),eb=r.useCallback(e=>{if(!A||!C||!e.path.length||void 0===e.path[0])return;let[t,n,a]=e.path,r=e.isConditional();if(F)B();else if(r){let e=!1,r=!1,o=C.map(o=>{let l=o.actions;if(!l)return o;let i=l.map((l,i)=>{if(i!==t||"CONDITIONAL"!==l.connectionType)return l;let s=l.conditionalActions;if(!s)return l;let c=s.map((t,l)=>{if(l!==n)return t;let i=t.actions;if(!i)return t;let s=i[a];s&&ef(s.connectionType?s.connectionType:"NONE",(0,l6.dI)(o.id??l6.Hr),eh,!0);let c=i.filter((e,t)=>t!==a);return e=a===i.length-1,r=0===c.length,{...t,actions:c}});return{...l,conditionalActions:c}});return{...o,actions:i}}),l=A.map(e=>o.find(t=>t.id===e.id)??e);n2.Y5.updateSelectionProperties({prototypeInteractions:l}),r?P(new uO.Op([t])):!r&&e&&P(new uO.Op([t,n,a-1]))}else ev(t);document.activeElement?.blur()},[A,C,F,B,ev,eh,ef]),eT=r.createElement(mk.P,{className:N?"prototype_interaction_edit_modal--ui3TwoColScrollContainer--IWuQ4":EB,useBottomPinning:!N,ref:eo,allowScrollAndZoomOver:!0,"data-not-draggable":!0},r.createElement(Ej,{shouldHideTitle:!0,recordingKey:N?n0.Pt("leftCol",i$.dJ):i$.dJ,category:e,autoOpenVariablePicker:em,newActionIndexPath:es,resetNewActionIndexPath:()=>{ec(new uO.Op([]))},onNewActionAdded:e=>{ec(e)},selectedActionIndex:I,onSelect:K,expandedRows:Y,setExpandedRows:$,deleteButtonPressed:ev,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:eg})),eN=1===C.length,eP=C[0],eC=eP.actions&&eP.actions.length<2,ek=eP.actions&&1===eP.actions.length&&eP.actions[0],eA=!ek||"NONE"===ek.connectionType,ew=eN&&eC&&eA;var eO=l6.Hr;let ex=r.createElement(uD,{skipPaywall:ew,addButtonPressed:e=>{if(!C)return;if(("CONDITIONAL"===e.connectionType||"SET_VARIABLE"===e.connectionType||"SET_VARIABLE_MODE"===e.connectionType)&&F){B();return}"SET_VARIABLE_MODE"===e.connectionType&&(e.targetVariableSetID=e_,e.targetVariableModeID=ey),"SET_VARIABLE"===e.connectionType&&em&&(em.current=!0),b&&"CONDITIONAL"===e.connectionType&&eg(!0);let t=!1;var n=null,a=b&&!k&&!ew&&C[0].actions&&1===C[0].actions.length;if(k||ew)for(var r=0;r<C.length;r++){let t=C[r];t.actions=[e];let n=t.id,a=t.sourceNodeID;(0,i$.uU)(t.stateManagementVersion)&&n&&a&&Et.zZ.recordInteractionUpgraded(n,a),t.stateManagementVersion=1}else for(var r=0;r<C.length;r++){let a=C[r];if(a.actions){if((0,i$.uU)(a.stateManagementVersion)&&(a.id&&a.sourceNodeID&&Et.zZ.recordInteractionUpgraded(a.id,a.sourceNodeID),a.actions?.forEach(e=>{e.transitionResetScrollPosition=!e.transitionPreserveScroll})),N){if(I.isConditional()){let n=I.path[0],r=I.path[1],o=I.path[2],l=a.actions?.[n],i=l.conditionalActions?.[r].actions?.length??0;n===a.actions.length-1&&o===i-1&&(t=!0),l.conditionalActions?.[r].actions?.splice(o+1,0,e)}else{let n=I.path[0]+1;n===a.actions.length&&(t=!0),a.actions?.splice(n,0,e)}}else a.actions?.push(e);eO=a.id?a.id:l6.Hr}else a.actions=[e],eO=a.id?a.id:l6.Hr;if(a.stateManagementVersion=1,N){let e=[...I.path];e[e.length-1]+=1,n=new uO.Op([...e])}else n=new uO.Op([a.actions.length-1])}let o=A.map(e=>C.find(t=>t.id===e.id)??e);if(n2.Y5.updateSelectionProperties({prototypeInteractions:o}),a||N){var l=[];o[0].actions?.forEach((e,t)=>{"CONDITIONAL"===e.connectionType&&l.push(new uO.Op([t]))}),$(l)}ei&&(!N||t)&&ei(!0),ec&&ec(n),m((0,l9._P)({name:"Prototype add action",params:{action:e.connectionType?e.connectionType:"NONE",source:"panel",connector_id:(0,l6.dI)(eO),page_id:eh}}))},renderButton:!0,recordingKey:i$.dJ,isNestedInConditional:N&&I.isConditional()}),eR=C.some(e=>void 0!==e.actions&&e.actions?.length>1),eM=!I.isConditional()&&!eR,eL=r.createElement(eS.K,{onClick:()=>eb(I),"aria-label":(0,d.t)("proto.prototype_panel.delete"),disabled:eM,recordingKey:n0.Pt(i$.dJ,"actionDeleteButton"),htmlAttributes:{"data-tooltip":(0,d.t)("proto.prototype_panel.delete"),"data-tooltip-type":rf.Ib.TEXT}},r.createElement(rh.U,{svg:EN.A},r.createElement(iR.O,null))),eD=r.createElement("div",{className:"prototype_interaction_edit_modal--ui3FooterContainer--oYsXM"},ex," ",eL),eK=r.createElement(mW.c.Provider,{value:mW.P.LEFT},r.createElement("div",{className:N?"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeftResizable--16pLu":"prototype_interaction_edit_modal--ui3InteractionsPanelContentLeft--UYWSG",ref:X,style:N?{width:`${E8(G).leftWidthPct}%`}:void 0},r.createElement(EU,{category:e,recordingKey:i$.dJ,headerButtons:r.createElement(r.Fragment,null)}),r.createElement("div",{className:EH}),eT,r.createElement("div",{className:EH}),r.createElement(r.Fragment,null,eD))),eF=w.length>0?r.createElement(mW.c.Provider,{value:mW.P.RIGHT},r.createElement(mk.P,{allowScrollAndZoomOver:!0,"data-not-draggable":!0,className:N?"prototype_interaction_edit_modal--ui3ScrollContainerRight--LJr-n":void 0},r.createElement(E7,{selectedActionIndex:M,handleExpandUI3:(e,t)=>{!t&&w.length>1?$(Y.filter(t=>!t.equals(e))):Y.find(t=>t.equals(e))||$([...Y,new uO.Op(e)])},autoOpenVariablePicker:em,autoOpenExpressionBuilder:eE,setAutoOpenExpressionBuilder:eg}))):null,eV=r.useRef(E2),[,eU]=(0,mP.i)({disabled:!N,onDragStart(){X.current&&(eV.current=X.current.getBoundingClientRect().width)},onDrag(e){if(X.current&&eV.current){let t=E8(G),n=eV.current+e.delta.x,r=n/t.width*100;n<E2?r=E2/t.width*100:r>E4&&(r=E4),X.current.style.width=`${r}%`,a={...t,leftWidthPct:r}}}}),eB=N?r.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColPanelContainer--e8MK8"},r.createElement("div",{className:"prototype_interaction_edit_modal--ui3TwoColInnerContainer--ZvJj2"},eK,r.createElement("div",{className:"prototype_interaction_edit_modal--dividerVertical--Noi1C"},r.createElement("div",{...eU({className:"prototype_interaction_edit_modal--verticalResizeHandle--xkc8V"})})),eF),G&&r.createElement(E$,{transition:z,recordingKey:n0.Pt(i$.dJ,"stateManagementVersionPanel"),updateSelectionProperties:R,stateManagementVersion:H,selectedInteractions:C})):eT;return r.createElement(mA.ht.Provider,{value:r.useMemo(()=>({autoCloseOnScroll:!f}),[f])},r.createElement(rd.vL,{name:"Prototype Draggable modal",className:"prototype_interaction_edit_modal--prototypeDraggableModal--njJ6A",handleClipboard:ep},r.createElement(lb.vx,{ref:y,dataTestId:"in-context-prototype-interaction-edit-modal",title:t=>r.createElement("div",{className:"prototype_interaction_edit_modal--onboardingRow--UlvE0"},r.createElement(E6,{category:e,recordingKey:i$.dJ,createActionTrigger:ex,closeButton:t})),containerClassName:eI()({[EB]:!N,[EG]:N,[Ez]:T,"prototype_interaction_edit_modal--abovePropertiesPanel--hFejC":ee,"prototype_interaction_edit_modal--belowPropertiesPanel--f1Jfl":!ee,"prototype_interaction_edit_modal--modalExpandedWidth--IDl6k":t&&!b,"prototype_interaction_edit_modal--modalWidth--cCH7B":!t&&!b,"prototype_interaction_edit_modal--hideModal--RSp-R":j}),contentContainerClassName:eI()({[EB]:!N,[EG]:N,[Ez]:T}),headerClassName:"prototype_interaction_edit_modal--multilineInteractionDetailsHeader--OE8Wr",allowWheelPassthrough:!0,initialPosition:er,headerSize:"small",onClose:E1,recordingKey:"interactionDetailsModal",arrowPosition:c?void 0:lb.F_.TOP,arrowRelativeX:c?void 0:Z/2,onDragStart:()=>{et(!0),ea()},canRenderBelowViewport:!0,allowAutoExpanding:!0,dragHeaderOnly:!0,onFocus:()=>h(!0),allowResizeHeight:N,allowResizeWidth:N,fullFrame:N,minWidth:N?440:void 0,minHeight:N?G?369:320:void 0,maxWidth:N?800:void 0,maxHeight:N?800:void 0,initialHeight:N?E8(G).height-lb.uF:void 0,initialWidth:N?E8(G).width:void 0,onResize:N?e=>{a={...E8(G),height:e.height,width:e.width}}:void 0},b?eB:eT)))});function E7({selectedActionIndex:e,autoOpenVariablePicker:t,handleExpandUI3:n,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o}){let l=(0,ij.HS)(),{selectedInteractions:i,mergedActions:s,makeUpdateSelectionPropertiesForActionIndex:c,makeUpdateMultipleDestinationNodesForActionIndex:d,detailPropsMultipleActions:p}=(0,ij.Ay)(l),m=e.path[0],u=d(m),E=c(m),g=(0,i$.iC)(i),y=p.interactionEvent.interactionType??"NONE";if(e.isConditional()){let n=e.path[1],l=e.path[2],c=s[m],d=((0,aq.hS)(c.conditionalActions)&&c.conditionalActions?c.conditionalActions:[])[n],p=d?.actions?.[l];return p?r.createElement("div",{className:EW},r.createElement(EP,{key:l,updateMultipleDestinationNodes:u.appendActionIndex(n).appendActionIndex(l),action:p,recordingKey:n0.Pt(i$.dJ,i$.Qe,i$.eG,m),updateSelectionProperties:E.appendActionIndex(n).appendActionIndex(l),onDeleteAction:S.lQ,interactionType:y,actionIndexPath:e.path,numActions:s.length,isNestedInConditional:!0,stateManagementVersion:g,selectedInteractions:i,onDrop:S.lQ,onSelect:S.lQ,onExpand:S.lQ,selectedActionIndex:e,expandedRows:[e],autoOpenVariablePicker:t,autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o,isNarrowPanel:!0})):null}return r.createElement("div",{className:EW},r.createElement(EP,{key:m,updateMultipleDestinationNodes:u,action:s[m],recordingKey:n0.Pt(i$.dJ,i$.Qe,i$.eG,m),updateSelectionProperties:E,onDeleteAction:S.lQ,interactionType:y,actionIndexPath:[m],numActions:s.length,isNestedInConditional:!1,stateManagementVersion:g,selectedInteractions:i,onDrop:S.lQ,onSelect:S.lQ,onExpand:n,selectedActionIndex:e,autoOpenVariablePicker:t,expandedRows:[e],autoOpenExpressionBuilder:a,setAutoOpenExpressionBuilder:o,isNarrowPanel:!0}))}function E6({category:e,recordingKey:t,closeButton:n,createActionTrigger:a}){let l=(0,o.wA)(),{selectedInteractions:c}=(0,ij.Ay)(e),p=(0,i$.YT)(),m=p===i$.Oz.TWO_COL,u=p===i$.Oz.SINGLE_COL,E=(()=>{if(1!==c.length)return 0;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id};return i.X3B.getMatchingInteractions(iL.d(t)).length})(),g=(0,s.kc)().prototype_hide_matching_noodles&&1===c.length&&E>1&&r.createElement(eS.K,{actionOnPointerDown:!0,onClick:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(iL.d(t));i.glU.selectInteractionsAndSourceNodes(n);let a=(0,d.t)("proto.interaction_details.visual_bell.selected_n_matching_interactions",{total_num_interactions:n.length});n2.Y5.showVisualBellWithUndo("selected-matching-noodles",a,!1),l((0,l9._P)({name:"prototype_select_matching_interactions",params:{num_connectors:n.length}}))},"aria-label":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:E}),htmlAttributes:{tabIndex:-1,onMouseEnter:()=>{if(1!==c.length)return;let e=c[0],t={nodeID:e.sourceNodeID,interactionID:e.id},n=i.X3B.getMatchingInteractions(iL.d(t));i.glU.hoverInteractions(n)},onMouseLeave:()=>i.glU.hoverInteractions([]),"data-tooltip":(0,d.t)("proto.interaction_details.select_n_matching_interactions",{total_num_interactions:E}),"data-tooltip-type":rf.Ib.TEXT}},r.createElement(rh.U,{svg:E0.A},r.createElement(nI.A,null))),y=r.createElement(EU,{category:e,recordingKey:t,headerButtons:r.createElement(r.Fragment,null,g,a,n)}),_=r.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeader--Ka7aM"},(0,d.tx)("proto.interaction_details.header"),r.createElement("div",{className:"prototype_interaction_edit_modal--ui3ExpandedModalHeaderButtons--UqykU"},g,n)),h=r.createElement(r.Fragment,null,(0,d.tx)("proto.interaction_details.header"),r.createElement("div",{className:"prototype_interaction_edit_modal--ui3CollapsedModalHeaderButtons--7yPuD"},g,a,n));return m?_:u?h:y}let E9=e=>e.pickerShown?.id===tb.o$?e.pickerShown:null;var ge=n(803609),gt=n(229831),gn=n(889185),ga=n(304657),gr=n(625693),go=n(347240),gl=n(509734),gi=n(82963),gs=n(606319),gc=n(433861),gd=n(593392);let gp="offscreen_indicators--indicatorGraphicBlue---nYr-",gm="offscreen_indicators--indicatorGraphicPurple--FAz-M",gu=(0,nf.jz)(rS.J4v),gE=(0,nf.jz)(rS.v5y),gg=(0,nf.jz)(rS.M$q),gy=(0,nf.jz)(rS.y9S);function g_(){let e=[],t=(0,sK.kl)("selectionRegions"),n=(0,aq.E7)(t);n&&(e=n);let a=(0,o.d4)(e=>e.mirror.appModel.hoveredNode);if(a&&(0,s.kc)().ce_offscreen_indicators_for_hovered_nodes){let t=(0,tn.UN)().get(a);if(t){let n=t.absoluteBoundingBox;e=[...e,{bounds:{height:n.h,width:n.w,x:n.x,y:n.y},regionType:t.isPrimaryInstance||t.isInstanceSublayer||t.isComponentish||t.isSymbolSublayer?iU.fV.SYMBOLS_ONLY:iU.fV.MIXED_OR_NO_SYMBOLS}]}}let l=!!e&&e.length>=1,i=(0,cZ._X)({subscribeToUpdates_expensive:l});return i&&e?r.createElement(gh,{viewportInfo:i,regions:e}):null}function gh({viewportInfo:e,regions:t}){let n=(0,r.useContext)(gc.kw),a=(0,r.useMemo)(()=>n.getCommentsWrapperOffset(e),[n,e]),l=a.x,i=a.y,s={transform:`translate(${l}px, ${i}px)`},c=(0,eu.GS)(),d=(0,aO.b)(),p=c&&!d,m=(0,o.d4)(e=>e.mirror?.appModel.showUi),u=(0,aR.dP)()+(p?gg:gu),E=(0,aR.qw)()+u+(p?gg:gE),g=(0,eK.Ye)(),{isPropertiesPanelCollapsed:y}=(0,aG.iT)(),_=(p&&m&&!g?u:0)-3.5,h=(p&&m&&!y?E:0)-7,f=(0,eo.J2)((0,aR.UK)().renderRulers)&&m?gy:0,v={x:_+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f},b={x:_+f,y:-3.5+f,width:e.width-h-f,height:e.height- -7-f};return r.createElement(r.Fragment,null,r.createElement(gd.p,null,r.createElement("div",{"aria-hidden":!0,"data-forward-events-to-fullscreen":!0,className:"offscreen_indicators--overlay--pNOlw",style:s},!!t?.length&&r.createElement("div",null,t.map((t,n)=>{let a=(0,cZ.Z0)(e,{x:t.bounds.x,y:t.bounds.y}),o=(0,cZ.Z0)(e,{x:t.bounds.x+t.bounds.width,y:t.bounds.y+t.bounds.height}),l={x:a.x,y:a.y,width:o.x-a.x,height:o.y-a.y};return l.x<v.x+v.width&&l.x+l.width>v.x&&l.y+l.height>v.y&&l.y<v.y+v.height?null:r.createElement(gf,{key:n,viewportBounds:b,viewportInfo:e,indicatorViewportBounds:l,selectionBoundsScaledWidth:function(e,t){let n=Math.max(e.x,t.x);return Math.max(Math.min(e.x+e.width,t.x+t.width)-n,10)}(l,b),selectionBoundsScaledHeight:function(e,t){let n=Math.max(e.y,t.y);return Math.max(Math.min(e.y+e.height,t.y+t.height)-n,10)}(l,b),selectionRegionType:t.regionType})})))))}function gf({viewportBounds:e,viewportInfo:t,indicatorViewportBounds:n,selectionBoundsScaledWidth:a,selectionBoundsScaledHeight:l,selectionRegionType:i}){let s=function(e,t){let n=0-t.x,a=0+e.width-t.x,r=0-t.y,o=0+e.height-t.y,l=Math.abs(n)<a?n:a,i=Math.abs(r)<o?r:o,s=n<0!=a<0,c=r<0!=o<0;return s&&c?Math.abs(l)<Math.abs(i)?{x:t.x+l,y:t.y}:{x:t.x,y:t.y+i}:!s&&c?{x:t.x+l,y:t.y}:s&&!c?{x:t.x,y:t.y+i}:{x:t.x+l,y:t.y+i}}(t,{x:n.x+n.width/2,y:n.y+n.height/2});s.x-=a/2,s.y-=l/2;let c=(0,o.d4)(e=>e.mirror?.appModel.showUi),d=(0,eo.J2)((0,aR.UK)().renderRulers)&&c?gy:0,p=(0,eu.GS)(),m=(0,aO.b)(),u=p&&!m,E=u?gg:gu,g=u?gg:gE,y=(0,aR.dP)()+E,_=(0,aR.qw)()+g,h=(0,eK.Ye)(),{isPropertiesPanelCollapsed:f}=(0,aG.iT)(),v=1+(c&&u&&!h?y+1:0)+d,b=Math.max(v,t.width-1-a-(c&&u&&!f?_+1:0)),S=1+d,T=Math.max(S,t.height-1-l-1),N=tf.Mi.bound(s,{min:{x:v,y:S},max:{x:b,y:T}}),I=n.y+n.height<e.y,P=n.y>e.y+e.height,C=n.x+n.width<e.x,k=n.x>e.x+e.width;N.x+=t.x,N.y+=t.y;let A=Math.min(t.width-2-(c&&u?_+y:0),a),w=Math.min(t.height-2,l);return r.createElement("div",{className:"offscreen_indicators--indicator---T9xk",style:{transform:`translate3D(${N.x}px, ${N.y}px, 0)`}},(I||P)&&r.createElement("div",{style:{position:"absolute",height:1.5,width:A,marginTop:P?w-1.5:0},className:eI()({[gp]:i===iU.fV.MIXED_OR_NO_SYMBOLS,[gm]:i===iU.fV.SYMBOLS_ONLY})}),(C||k)&&r.createElement("div",{style:{position:"absolute",left:0,height:w,width:1.5,marginLeft:k?A-1.5:0},className:eI()({[gp]:i===iU.fV.MIXED_OR_NO_SYMBOLS,[gm]:i===iU.fV.SYMBOLS_ONLY})}))}var gv=n(109176);let gb=r.memo(({shouldShowDragAndDropBorder:e})=>{let t=(0,V.p8)("isReadOnly"),n=(0,o.d4)(e=>e.progressBarState),a=(0,V.p8)("loadingEmbeds"),u=(0,eo.ut)(i.Ez5?.uiState().showCanvasSearch,!1),E=(0,el.Lk)(),g=(0,r.useRef)(null),y=(0,o.d4)(e=>e.userFlags),_=!!(0,s.kc)().internal_only_debug_tools||!!y.has_cursor_bot_onboarding_v2,h=(0,o.d4)(e=>e.openFile),f=h?h.key:"",v=(0,o.d4)(e=>e.universalInsertModal),b=(0,o.wA)();(0,q.Gb)(f),(0,er.W)(),function(){let e=(0,o9.VW)(),t=(0,a7.ZC)(e?.guid),n=(0,V.p8)("activeUserAction"),a=(0,iq.LC)();r.useEffect(()=>{(e?.guid!==t&&t||![i.QOV.DEFAULT,i.QOV.CLICKING_TO_CHANGE_SELECTION].includes(n))&&(0,i2.KY)({actionToClear:iZ.JT.FIND_INSPIRATION})},[e,n,t,a])}();let S=(0,en.BI)(),T=(0,J.l7)(),{fpl_accessible_areas_for_design:N,fpl_a11y_accessible_areas_fullscreen_shortcuts:I}=(0,s.kc)(),P=r.createElement(es.e,{condition:!!(I&&N),wrapper:e=>r.createElement(ei.m,{role:"region","aria-label":(0,d.t)("fullscreen_actions.left_sidebar_label")},e)},T?r.createElement(c.tH,{boundaryKey:"DevModeLeftPanel",fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING,sentryTags:{area:l.eBU.DEVELOPER_TOOLS}},r.createElement(m.O,null)):r.createElement(mm,null));return r.createElement(aC,null,r.createElement(Z.ED,null),r.createElement(cc.sk,null,n.mode!==i.Oin.OFF&&r.createElement("div",{className:gv._q}),r.createElement(nE.pO,{initialFilterState:{currentPage:!1}},a.map(e=>r.createElement(aN._,{key:`loading-embed-${e}`,nodeId:e})),r.createElement(cd.qn,null),r.createElement(gi.u,null),u&&r.createElement(my.n,null),(0,s.kc)().ce_al_experiments_on&&r.createElement(my.n,null),r.createElement(aT.GR,null),r.createElement(aT.bu,null),r.createElement(gt.J,null),r.createElement(cd.XI,{commentsDetailContainerRef:g}),r.createElement(g_,null),(0,s.kc)().cursor_bot&&_&&r.createElement(mE.S,null),r.createElement(cO,null),r.createElement(ab.J,null),r.createElement(mu.Nz,null),r.createElement("div",{ref:g}),!(0,et.T)()&&P,!t&&r.createElement(E3,null),r.createElement(aS.G,null,T?null:r.createElement(r.Fragment,null,r.createElement(gS,null),!!S?.shouldOptimizeForIpadApp&&r.createElement(go.K,null),!!S?.shouldOptimizeForIpadApp&&r.createElement(gl.t,null))),e&&r.createElement(mu.X5,null),(0,s.kc)().aip_flower_garden&&r.createElement(ay,null)),r.createElement(ec.A,{isFigjamEditor:!1,isDesignEditor:!0,isSlidesEditor:!1,openFile:h}),r.createElement(ge.l,{defaultViewTabsAvailable:!0,defaultViewAssetsTabVisible:!0}),v.showing&&r.createElement(c.tH,{boundaryKey:"FdBrowseResourceModal",onError:()=>{b(p.F.enqueue({message:"Unable to open inserts menu",type:"react-error"}))},fallback:c.H4.NONE_I_KNOW_WHAT_IM_DOING},r.createElement(ga.k,null))),E&&r.createElement(mg.K,{className:gv.PA},r.createElement(gr.s,null)))}),gS=r.memo(function(){let e=(0,o.d4)(e=>e.mirror.appModel),t=(0,V.ax)(),{topLevelMode:n}=e,a=(0,V.dH)();return(0,ea.z)({topLevelMode:i.lyf.PREVIEW,eventName:"Preview Mode Selection Changed",teamFilesOnly:!0}),r.useEffect(()=>{t&&n===i.lyf.PREVIEW&&a!==i.NLJ.COMMENTS&&(0,ee.NT)(i.FAf.INSPECT)},[t,n,a]),r.createElement(r.Fragment,null,r.createElement(cs,null),r.createElement(gT,null))}),gT=r.memo(function(){return r.createElement(r.Fragment,null,r.createElement(ed.p,null,r.createElement(ep.L,null)),r.createElement(ed.p,{featureFlag:"starting_points_modal"},r.createElement(eJ,null)),r.createElement(ed.p,null,r.createElement(Q,null)),r.createElement(ed.p,null,r.createElement(gn.e,null)),r.createElement(ed.p,null,r.createElement(td,null)),r.createElement(ed.p,null,r.createElement(ty,null)),r.createElement(ed.p,{featureFlag:"mobile_prompt_sidebar_modal"},r.createElement(mN,null)),r.createElement(ed.p,null,r.createElement(u.S,null)),r.createElement(ed.p,null,r.createElement(nu,null)),r.createElement(ed.p,{featureFlag:"cmty_visual_assets_nux"},r.createElement(tt,null)))});function gN(){let[e,t]=(0,r.useState)(!1);return r.createElement(aI.c,{loadedCommentsProvider:!1},r.createElement(gs.v,{setShouldShowDragAndDropBorder:t,isDragTarget:!1},r.createElement(gb,{shouldShowDragAndDropBorder:e})))}},511787:(e,t,n)=>{"use strict";n.d(t,{f:()=>g});var a=n(411855),r=n(153234),o=n(572206),l=n(268537),i=n(163023),s=n(318812),c=n(298543),d=n(184837),p=n(820396),m=n(1715),u=n(590685),E=n(501191);function g({resolvedTypes:e,recordingKey:t}){let{showing:n,toggle:l,hide:p}=(0,s.BK)("expression-builder-create-variable"),m=a.useRef(null),g=r.rf(r.Pt(t,"createVariableDropdown"),"click",a.useCallback(()=>{1===e.length?v(e[0]):l()},[e,l])),[_,h]=a.useState(!1),f=a.useRef(null),v=e=>{let t=m.current?.getBoundingClientRect();t&&(f.current={initialPosition:new o.Mi(t.left,t.top),resolvedType:e},h(!0))},b=()=>{h(!1)};return a.createElement(a.Fragment,null,a.createElement("button",{ref:m,className:u.ZS,onClick:g},a.createElement(i.B,{svg:E.A})),_&&(_&&f.current?a.createElement(d.U,{initialPosition:f.current.initialPosition,initialWidth:d.i,resolvedType:f.current.resolvedType,onCreateVariable:b,onClose:b}):null),n&&m.current&&a.createElement(c.Cf,{arrowOffsetFromRectLeft:14,leanPadding:0,lean:"right",targetRect:m.current.getBoundingClientRect()},e.map(e=>a.createElement(y,{key:e,resolvedType:e,onClose:p,showCreationModal:v,recordingKey:t}))))}function y({resolvedType:e,onClose:t,showCreationModal:n,recordingKey:o}){let i=(0,m.F)(e),s=r.rf(r.Pt(o,"createVariableOption",i.name),"click",a.useCallback(()=>{n(e),t()},[t,e,n]));return a.createElement(l.c$,{className:u.Fs,onClick:s},a.createElement(p.i,{type:e,showTooltip:!1}),i.name)}},626502:(e,t,n)=>{var a=n(341692),r=0/0;e.exports=function(e,t){var n=null==e?0:e.length;return n?a(e,t)/n:r}},774886:(e,t,n)=>{var a=n(626502),r=n(109169);e.exports=function(e){return a(e,r)}}}]);

//# debugId=6ef19c49-20b3-5918-bd85-deea7910e8f1

//# sourceMappingURL=https://admin.figma.com/admin/webpack-artifacts/7513af340a241be1aea73dfb7fd9166b32b4e8a2/fullscreen_design-0338227958555573.min.js.map